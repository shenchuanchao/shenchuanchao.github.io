<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>码农观测站</title>
  
  <subtitle>编程学习与技术分享，前端后端全栈成长之路</subtitle>
  <link href="https://www.codeobservatory.cn/atom.xml" rel="self"/>
  
  <link href="https://www.codeobservatory.cn/"/>
  <updated>2025-10-08T09:45:12.101Z</updated>
  <id>https://www.codeobservatory.cn/</id>
  
  <author>
    <name>码农刚子</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>.NET开发中3秒判断该用 IEnumerable 还是 IQueryable</title>
    <link href="https://www.codeobservatory.cn/archives/eb830df6.html"/>
    <id>https://www.codeobservatory.cn/archives/eb830df6.html</id>
    <published>2025-10-08T09:36:06.000Z</published>
    <updated>2025-10-08T09:45:12.101Z</updated>
    
    <content type="html"><![CDATA[<p>在.NET开发中，IEnumerable和IQueryable是处理数据集合时最常用的两个接口。很多开发者对它们的选择感到困惑，但其实只需要掌握几个关键点就能快速做出正确决策。</p><h2 id="核心区别：执行位置"><a href="#核心区别：执行位置" class="headerlink" title="核心区别：执行位置"></a>核心区别：执行位置</h2><p>IEnumerable：在内存中执行查询操作<br>IQueryable：在数据源端执行查询操作</p><h3 id="选择-IEnumerable-当："><a href="#选择-IEnumerable-当：" class="headerlink" title="选择 IEnumerable 当："></a>选择 IEnumerable 当：</h3><p>1、数据已在内存中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 数据来自内存集合</span><br><span class="line">List&lt;User&gt; users = GetUsersFromMemory();</span><br><span class="line">var result = users.Where(u =&gt; u.Age &gt; 18); // 使用 IEnumerable</span><br></pre></td></tr></table></figure><p>2、需要立即执行查询</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var users = dbContext.Users.ToList() // 立即执行</span><br><span class="line">                   .Where(u =&gt; u.Age &gt; 18); // 在内存中过滤</span><br></pre></td></tr></table></figure><p>3、使用LINQ to Objects功能</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 使用.NET方法而非SQL可翻译的方法</span><br><span class="line">var result = users.Where(u =&gt; u.Name.Contains(&quot;John&quot;))</span><br><span class="line">                  .AsEnumerable() // 切换到内存操作</span><br><span class="line">                  .Select(u =&gt; new &#123; u.Name, Initial = u.Name[0] &#125;);</span><br></pre></td></tr></table></figure><h3 id="选择-IQueryable-当："><a href="#选择-IQueryable-当：" class="headerlink" title="选择 IQueryable 当："></a>选择 IQueryable 当：</h3><p>1、需要数据库端过滤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 查询被转换为SQL并在数据库执行</span><br><span class="line">var result = dbContext.Users</span><br><span class="line">                     .Where(u =&gt; u.Age &gt; 18) // 生成 SQL: WHERE Age &gt; 18</span><br><span class="line">                     .OrderBy(u =&gt; u.Name);</span><br></pre></td></tr></table></figure><p>2、需要分页或聚合操作</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 只在数据库获取需要的记录</span><br><span class="line">var pagedResult = dbContext.Users</span><br><span class="line">                          .Where(u =&gt; u.IsActive)</span><br><span class="line">                          .Skip(20).Take(10) // 生成分页SQL</span><br><span class="line">                          .ToList();</span><br></pre></td></tr></table></figure><p>3、构建动态查询</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">IQueryable&lt;User&gt; query = dbContext.Users;</span><br><span class="line"></span><br><span class="line">if (!string.IsNullOrEmpty(searchName))</span><br><span class="line">    query = query.Where(u =&gt; u.Name.Contains(searchName));</span><br><span class="line"></span><br><span class="line">if (minAge.HasValue)</span><br><span class="line">    query = query.Where(u =&gt; u.Age &gt;= minAge.Value);</span><br><span class="line"></span><br><span class="line">var finalResult = query.ToList(); // 单一SQL查询</span><br></pre></td></tr></table></figure><h2 id="性能提示💡"><a href="#性能提示💡" class="headerlink" title="性能提示💡"></a>性能提示💡</h2><p>错误用法：❌</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 这将加载整个表到内存！</span><br><span class="line">var users = dbContext.Users.ToList()</span><br><span class="line">                  .Where(u =&gt; u.Age &gt; 18); </span><br></pre></td></tr></table></figure><p>正确用法：✅</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 只在数据库查询需要的记录</span><br><span class="line">var users = dbContext.Users</span><br><span class="line">                    .Where(u =&gt; u.Age &gt; 18)</span><br><span class="line">                    .ToList();</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>记住这个简单的规则：**IQueryable用于推迟查询执行到数据源端，IEnumerable用于内存中的操作。**根据你的数据源位置和查询需求，遵循上述指南就能在3秒内做出正确选择，从而优化应用程序性能。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;在.NET开发中，IEnumerable和IQueryable是处理数据集合时最常用的两个接口。很多开发者对它们的选择感到困惑，但其实只需要掌握几个关键点就能快速做出正确决策。&lt;/p&gt;
&lt;h2 id=&quot;核心区别：执行位置&quot;&gt;&lt;a href=&quot;#核心区别：执行位置&quot; clas</summary>
      
    
    
    
    
    <category term="IEnumerable" scheme="https://www.codeobservatory.cn/tags/IEnumerable/"/>
    
    <category term="IQueryable" scheme="https://www.codeobservatory.cn/tags/IQueryable/"/>
    
  </entry>
  
  <entry>
    <title>asp.net web开发框架_Web前端开发必不可少的9个开源框架</title>
    <link href="https://www.codeobservatory.cn/archives/2355d2b3.html"/>
    <id>https://www.codeobservatory.cn/archives/2355d2b3.html</id>
    <published>2025-07-22T06:02:21.000Z</published>
    <updated>2025-07-22T06:12:20.743Z</updated>
    
    <content type="html"><![CDATA[<p>大多数人想到Web开发时，通常会想到HTML或JavaScript，往往忽略了CSS，根据Wikipedia的说法，CSS既是网页中最重要也是最常被遗忘的部分之一，尽管它是万维网的三大基础技术之一。 今天就和大家分享9个流行的、强大的前端开源框架，帮助你轻松构建漂亮的网站前端。 </p><h2 id="1、Bootstrap"><a href="#1、Bootstrap" class="headerlink" title="1、Bootstrap"></a>1、Bootstrap</h2><p>Bootstrap无疑是最流行的CSS框架，它是最早的Web前端框架，由Twitter开发。 Bootstrap还提供了许多示例来帮助你入门。</p><p><img src="https://images.codeobservatory.cn/hexo/202507/22/e93d00f5e4881e7618.png" alt="asp.net web开发框架_Web前端开发必不可少的9个开源框架"></p><p>使用Bootstrap，你可以将不同的组件和布局组合在一起，从而创建有趣的页面设计。它还提供了大量详细的文档。目前在Github上已经有1100多个贡献者，19000多个提交。(Github地址： <a href="https://github.com/twbs/bootstrap">https://github.com/twbs/bootstrap</a> ) </p><h2 id="2、PatternFly"><a href="#2、PatternFly" class="headerlink" title="2、PatternFly"></a>2、PatternFly</h2><p>PatternFly是Red Hat的开源CSS框架，和Bootstrap不同的是，Bootstrap是为那些想要创建漂亮网站的人而设计的，而PatternFly主要专注于企业应用程序开发人员，提供诸如条形图、图表、导航之类的组件，实际上Red Hat就是使用它创建了OpenShift。</p><p><img src="https://images.codeobservatory.cn/hexo/202507/22/75264446ad1b31c019.png" alt="asp.net web开发框架_Web前端开发必不可少的9个开源框架"></p><p>除了静态HTML，PatternFly还支持ReactJS框架，这是Facebook开发的流行JavaScript框架。PatternFly具有许多适用于企业级应用程序的高级组件，如条形图，图表，模式和布局。 PatternFly在GitHub上一共有1,050多个提交和44个贡献者。(Github地址： <a href="https://github.com/patternfly/patternfly">https://github.com/patternfly/patternfly</a> ) </p><h2 id="3、Material-Components-for-the-web"><a href="#3、Material-Components-for-the-web" class="headerlink" title="3、Material Components for the web"></a>3、Material Components for the web</h2><p>Material Components for the web(MDC Web)，是谷歌专为Web设计的全新前端框架。MDC Web可帮助开发人员执行Material Design，组件由谷歌的核心工程师团队和UX设计人员开发。这些组件可以建立可靠的开发工作流程，以构建美观且功能强大的Web项目。</p><p><img src="https://images.codeobservatory.cn/hexo/202507/22/5589b3170563d4c20.png" alt="asp.net web开发框架_Web前端开发必不可少的9个开源框架"></p><p>MDC Web在Github上共有5700多个提交和349个贡献者。(Github地址： <a href="https://github.com/material-components/material-components-web">https://github.com/material-components/material-components-web</a> ) </p><h2 id="4、Pure"><a href="#4、Pure" class="headerlink" title="4、Pure"></a>4、Pure</h2><p>Bootstrap，Patternfly和MDC Web是功能非常强大的CSS框架，但它们可能非常繁琐和复杂。如果你想要一个轻量级的CSS框架，可以尝试Pure.css，它本身更接近于CSS编程，但又可以帮助你构建一个不错的网页。Pure是具有最小占用空间的轻量级CSS框架，它由Yahoo开发，根据BSD许可是开源的。</p><p><img src="https://images.codeobservatory.cn/hexo/202507/22/8a923a9e3878164521.png" alt="asp.net web开发框架_Web前端开发必不可少的9个开源框架"></p><p>Pure在Github上共有565多个提交和59个贡献者。(Github地址： <a href="https://github.com/pure-css/pure">https://github.com/pure-css/pure</a> ) </p><h2 id="5、Foundation"><a href="#5、Foundation" class="headerlink" title="5、Foundation"></a>5、Foundation</h2><p>Foundation声称是世界上最先进的响应式前端框架。它提供了用于构建专业网站的高级功能和教程。许多公司，组织都使用该框架，并且该框架具有大量可用的文档。</p><p><img src="https://images.codeobservatory.cn/hexo/202507/22/8b5ee34e0dc1be6d22.png" alt="asp.net web开发框架_Web前端开发必不可少的9个开源框架"></p><p>Foundation在Github上有将近17000个提交和1000个贡献者。(Github地址： <a href="https://github.com/foundation/foundation-sites">https://github.com/foundation/foundation-sites</a> ) </p><h2 id="6、Bulma"><a href="#6、Bulma" class="headerlink" title="6、Bulma"></a>6、Bulma</h2><p>Bulma是一个基于Flexbox的开源框架，可根据MIT许可证开源。Bulma是一个非常轻量级的框架，因为它只需要一个CSS文件。Bulma拥有简洁明了的文档，可轻松选择你想要的主题。它还具有许多Web组件，你可以在设计中使用它们。</p><p><img src="https://images.codeobservatory.cn/hexo/202507/22/d8d75962cd3279ae23.png" alt="asp.net web开发框架_Web前端开发必不可少的9个开源框架"></p><p>Bulma在Github上有1400多个提交和300个贡献者。(Github地址： <a href="https://github.com/jgthms/bulma">https://github.com/jgthms/bulma</a> ) </p><h2 id="7、Skeleton"><a href="#7、Skeleton" class="headerlink" title="7、Skeleton"></a>7、Skeleton</h2><p>如果说还有什么框架比Pure更加轻量级，那一定是Skeleton。Skeleton库只有大约400行，并且该框架仅提供一些基本的CSS框架组件。尽管如此，Skeleton还是提供了详细的文档来帮助你快速上手。</p><p><img src="https://images.codeobservatory.cn/hexo/202507/22/648d1c33e2c02e1c24.png" alt="asp.net web开发框架_Web前端开发必不可少的9个开源框架"></p><p>Skeleton在Github上共有167个提交和22个贡献者，但它不是最活跃的项目，它最新一次的更新是在2014年。(Github地址： <a href="https://github.com/dhg/Skeleton">https://github.com/dhg/Skeleton</a> ) </p><h2 id="8、Materialize"><a href="#8、Materialize" class="headerlink" title="8、Materialize"></a>8、Materialize</h2><p>Materialize 是一个基于 Material Design风格的一个现代化的响应式前端框架，解决了最繁重的工作，结合你的自定义组件，为你提供默认的样式。Materialize的文档页面非常全面，并且很容易遵循。其组件页面包括按钮，卡片，导航等。</p><p><img src="https://images.codeobservatory.cn/hexo/202507/22/4ff052824198b2ad25.png" alt="asp.net web开发框架_Web前端开发必不可少的9个开源框架"></p><p>Materialize在Github上共有3800多个提交和250个贡献者。(Github地址： <a href="https://github.com/Dogfalo/materialize">https://github.com/Dogfalo/materialize</a> ) </p><h2 id="9、Bootflat"><a href="#9、Bootflat" class="headerlink" title="9、Bootflat"></a>9、Bootflat</h2><p>Bootflat是从Twitter的Bootstrap派生的开源CSS框架。与Bootstrap相比，Bootflat更简单，并且更加轻量级。Bootflat的文档似乎几乎受到了IKEA的启发，大部分都是图像，没有太多的文字。</p><p><img src="https://images.codeobservatory.cn/hexo/202507/22/789d8bf43ed0d6d326.png" alt="asp.net web开发框架_Web前端开发必不可少的9个开源框架"></p><p>Bootflat是在MIT许可证下开源的，在Github上有159个提交和8个贡献者。(Github地址： <a href="https://github.com/bootflat/bootflat.github.io">https://github.com/bootflat/bootflat.github.io</a> )</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;大多数人想到Web开发时，通常会想到HTML或JavaScript，往往忽略了CSS，根据Wikipedia的说法，CSS既是网页中最重要也是最常被遗忘的部分之一，尽管它是万维网的三大基础技术之一。 今天就和大家分享9个流行的、强大的前端开源框架，帮助你轻松构建漂亮的网站前</summary>
      
    
    
    
    <category term="前端开发" scheme="https://www.codeobservatory.cn/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="asp.net" scheme="https://www.codeobservatory.cn/tags/asp-net/"/>
    
    <category term="web开发" scheme="https://www.codeobservatory.cn/tags/web%E5%BC%80%E5%8F%91/"/>
    
    <category term="开发框架" scheme="https://www.codeobservatory.cn/tags/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6/"/>
    
    <category term="开源框架" scheme="https://www.codeobservatory.cn/tags/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/"/>
    
  </entry>
  
  <entry>
    <title>javascript中怎么找父级标签和子级标签</title>
    <link href="https://www.codeobservatory.cn/archives/fe9c6897.html"/>
    <id>https://www.codeobservatory.cn/archives/fe9c6897.html</id>
    <published>2025-07-22T05:53:43.000Z</published>
    <updated>2025-07-22T06:01:29.394Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、JS中查找父标签的方法："><a href="#一、JS中查找父标签的方法：" class="headerlink" title="一、JS中查找父标签的方法："></a>一、JS中查找父标签的方法：</h2><p>1、利用parentNode属性，语法“子元素对象.parentNode”；</p><p>2、借助Jquery中的parent()或parents()方法，语法“子元素对象.parent()”或“子元素对象.parents()”。</p><p><img src="https://images.codeobservatory.cn/hexo/202507/22/d68cae22a57819b517.jpg" alt="javascript中怎么找父级标签和子级标签"></p><p>找父元素节点的方法有：</p><p>1、原生方法–parentNode属性</p><p>parentNode 属性可返回某节点的父节点。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">元素.<span class="property">parentNode</span> <span class="comment">//返回元素的第一个父节点</span></span><br></pre></td></tr></table></figure><p>2、Jquery方法(记得导包)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">元素.<span class="title function_">parent</span>() 返回元素的第一个父节点</span><br><span class="line">元素.<span class="title function_">parents</span>() 返回一个包含元素所有父节点的数组</span><br></pre></td></tr></table></figure><p>下面有个例子:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">&quot;a&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;jquery-2.1.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//原生的方法</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;a&#x27;</span>).<span class="property">parentNode</span> <span class="comment">//得到&lt;span&gt;节点</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//也可以这么玩</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;a&#x27;</span>).<span class="property">parentNode</span>.<span class="property">parentNode</span> <span class="comment">//得到&lt;div&gt;节点</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//Jquery的方法  记得导包哦</span></span></span><br><span class="line"><span class="language-javascript">    $(<span class="string">&#x27;#a&#x27;</span>).<span class="title function_">parent</span>();<span class="comment">//得到&lt;span&gt;节点</span></span></span><br><span class="line"><span class="language-javascript">    $(<span class="string">&#x27;#a&#x27;</span>).<span class="title function_">parent</span>().<span class="title function_">parent</span>();<span class="comment">//得到&lt;div&gt;节点</span></span></span><br><span class="line"><span class="language-javascript">    $(<span class="string">&#x27;#a&#x27;</span>).<span class="title function_">parents</span>();<span class="comment">//得到所有父级节点   &lt;span&gt; ,&lt;div&gt; ,&lt;body&gt; ,&lt;html&gt;</span></span></span><br><span class="line"><span class="language-javascript">    $(<span class="string">&#x27;#a&#x27;</span>).<span class="title function_">parents</span>(<span class="string">&#x27;body&#x27;</span>);<span class="comment">//得到&lt;body&gt;节点</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="二、找子元素节点的方法有："><a href="#二、找子元素节点的方法有：" class="headerlink" title="二、找子元素节点的方法有："></a>二、找子元素节点的方法有：</h2><p>1、原生方法–childNodes属性</p><p>childNodes 属性可返回某节点的子节点。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">元素.<span class="property">childNodes</span> <span class="comment">//返回元素的第一个子节点</span></span><br></pre></td></tr></table></figure><p>2、Jquery方法(记得导包)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">元素.<span class="title function_">child</span>() 返回元素的第一个子节点</span><br><span class="line">元素.<span class="title function_">children</span>() 返回一个包含元素所有父节点的数组</span><br></pre></td></tr></table></figure><p>下面有个例子:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;jquery-2.1.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//原生的方法</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;id&#x27;</span>).<span class="property">childNodes</span>   <span class="comment">//得到&lt;span&gt;节点</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//也可以这么玩</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;id&#x27;</span>).<span class="property">childNodes</span>.<span class="property">childNodes</span> <span class="comment">//得到&lt;a&gt;节点</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//Jquery的方法  同样记得导包哦</span></span></span><br><span class="line"><span class="language-javascript">    $(<span class="string">&#x27;#div&#x27;</span>).<span class="title function_">child</span>();<span class="comment">//得到&lt;span&gt;节点</span></span></span><br><span class="line"><span class="language-javascript">    $(<span class="string">&#x27;#div&#x27;</span>).<span class="title function_">child</span>().<span class="title function_">child</span>();<span class="comment">//得到&lt;a&gt;节点</span></span></span><br><span class="line"><span class="language-javascript">    $(<span class="string">&#x27;#div&#x27;</span>).<span class="title function_">children</span>();<span class="comment">//得到所有父级节点   &lt;span&gt; ,&lt;a&gt;</span></span></span><br><span class="line"><span class="language-javascript">    $(<span class="string">&#x27;#div&#x27;</span>).<span class="title function_">children</span>(<span class="string">&#x27;a&#x27;</span>);<span class="comment">//得到&lt;a&gt;节点</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>以上是javascript中怎么找父级标签和子级标签全部内容，希望文章能够帮你解决javascript中怎么找父级标签和子级标签所遇到的程序开发问题。</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;一、JS中查找父标签的方法：&quot;&gt;&lt;a href=&quot;#一、JS中查找父标签的方法：&quot; class=&quot;headerlink&quot; title=&quot;一、JS中查找父标签的方法：&quot;&gt;&lt;/a&gt;一、JS中查找父标签的方法：&lt;/h2&gt;&lt;p&gt;1、利用parentNode属性，语法“子元</summary>
      
    
    
    
    <category term="前端开发" scheme="https://www.codeobservatory.cn/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="HTML" scheme="https://www.codeobservatory.cn/tags/HTML/"/>
    
    <category term="JavaScript" scheme="https://www.codeobservatory.cn/tags/JavaScript/"/>
    
    <category term="标签" scheme="https://www.codeobservatory.cn/tags/%E6%A0%87%E7%AD%BE/"/>
    
  </entry>
  
  <entry>
    <title>c# .net PayPal支付配置验证(附代码)</title>
    <link href="https://www.codeobservatory.cn/archives/fb8e2ad0.html"/>
    <id>https://www.codeobservatory.cn/archives/fb8e2ad0.html</id>
    <published>2025-07-22T05:36:17.000Z</published>
    <updated>2025-07-22T05:51:31.707Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、添加web窗体接收通知"><a href="#一、添加web窗体接收通知" class="headerlink" title="一、添加web窗体接收通知"></a>一、添加web窗体接收通知</h2><p>用于接收第三方支付回调通知，请求链接例如：<a href="https://codeobservatory.cn/Paypal/PaypalNotifyPage.aspx">https://codeobservatory.cn/Paypal/PaypalNotifyPage.aspx</a></p><p><img src="https://images.codeobservatory.cn/hexo/202507/22/657759fc65631e8f10.png" alt="c# .net PayPal支付配置验证"></p><h2 id="二、使用步骤"><a href="#二、使用步骤" class="headerlink" title="二、使用步骤"></a>二、使用步骤</h2><h3 id="1-引入bll"><a href="#1-引入bll" class="headerlink" title="1.引入bll"></a>1.引入bll</h3><p>代码如下：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Newtonsoft.Json.Linq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> PayPal.Api; </span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System; </span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Net; </span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Web;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Web.UI;</span><br></pre></td></tr></table></figure><h3 id="2-config配置文件"><a href="#2-config配置文件" class="headerlink" title="2.config配置文件"></a>2.config配置文件</h3><p>代码如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">paypal</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- 将模式替换为“ security-test-sandbox”以测试您的服务器是否支持TLSv1.2。 有关更多信息，请遵循README说明。--&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">&quot;connectionTimeout&quot;</span> <span class="attr">value</span>=<span class="string">&quot;360000&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">&quot;requestRetries&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- 测试 --&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">&quot;mode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;sandbox&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">&quot;clientId&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ASx_gEpY2EynTh_SfDGIWzo7fSVJlrb8YDxr_X1YLz_SXU5Q5eTwC9_0r3d0rTrhyKPEe2lgwlAzb2Tc&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">&quot;clientSecret&quot;</span> <span class="attr">value</span>=<span class="string">&quot;EGKDuKiVXK0TX3996cuHBba8UmEA29q9W3yoCfB_TAHS5KypxfirBvHrqUc-8u7CPy-lzFY4VaWF6L04&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- 正式 --&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!--&lt;add name=&quot;mode&quot; value=&quot;live&quot; /&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      &lt;add name=&quot;clientId&quot; value=&quot;&quot; /&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      &lt;add name=&quot;clientSecret&quot; value=&quot;&quot; /&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line"></span><br><span class="line"> <span class="tag">&lt;/<span class="name">paypal</span>&gt;</span></span><br></pre></td></tr></table></figure><ol><li>该处用于获取config 和accessToken的值。</li><li>clientId和clientSecret获取方式：</li></ol><ul><li>a、登录： PayPal Developer</li><li>b、选择Sandbox，创建app</li></ul><p><img src="https://images.codeobservatory.cn/hexo/202507/22/e2c72597654bcf3e11.png" alt="c# .net PayPal支付配置验证"></p><ul><li>c、点击进去就能看到 clientId和clientSecret 值</li></ul><p><img src="https://images.codeobservatory.cn/hexo/202507/22/c5bd3ba9c620e71412.png" alt="c# .net PayPal支付配置验证"></p><h3 id="3、代码"><a href="#3、代码" class="headerlink" title="3、代码"></a>3、代码</h3><p>代码如下：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Page page &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">PaypalService</span>(<span class="params">Page page</span>)</span></span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">this</span>.page = page;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">PaypalPayNotify</span>()</span></span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">string</span> strRequest = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line"></span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line">                page.Response.Write(<span class="string">&quot;200 OK&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="keyword">var</span> param = page.Request.BinaryRead(page.Request.ContentLength);</span><br><span class="line"></span><br><span class="line">                strRequest = Encoding.ASCII.GetString(param);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (VerificationResponse(page.Request, strRequest).Equals(<span class="string">&quot;SUCCESS&quot;</span>))</span><br><span class="line"></span><br><span class="line">                &#123;</span><br><span class="line"></span><br><span class="line">                    WriteLog(<span class="string">&quot;执行业务操作VERIFIED&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    JObject obj = JObject.Parse(strRequest);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    <span class="built_in">string</span> AmountTotal = obj[<span class="string">&quot;resource&quot;</span>][<span class="string">&quot;amount&quot;</span>][<span class="string">&quot;value&quot;</span>].ToString();<span class="comment">//金额</span></span><br><span class="line"></span><br><span class="line">                    <span class="built_in">string</span> OrderNumber = obj[<span class="string">&quot;resource&quot;</span>][<span class="string">&quot;invoice_id&quot;</span>].ToString();<span class="comment">//订单号</span></span><br><span class="line"></span><br><span class="line">                    <span class="built_in">string</span> PayID = obj[<span class="string">&quot;resource&quot;</span>][<span class="string">&quot;id&quot;</span>].ToString();<span class="comment">//Paypal支付订单号</span></span><br><span class="line"></span><br><span class="line">                    <span class="built_in">string</span> PaymentStatus = obj[<span class="string">&quot;resource&quot;</span>][<span class="string">&quot;status&quot;</span>].ToString();<span class="comment">//交易状态</span></span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (PaymentStatus == <span class="string">&quot;COMPLETED&quot;</span>)</span><br><span class="line"></span><br><span class="line">                    &#123;</span><br><span class="line"></span><br><span class="line">                        <span class="comment">//更新业务</span></span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">                    &#123;</span><br><span class="line"></span><br><span class="line">                       <span class="comment">//打印日志输出错误</span></span><br><span class="line"></span><br><span class="line">                       <span class="comment">// &quot; Paypal更新支付出错，交易状态不正确！PaymentStatus：&quot; + PaymentStatus</span></span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">catch</span> (Exception ex)</span><br><span class="line"></span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//捕获异常，打印日志输出错误</span></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            page.Response.End();</span><br><span class="line"></span><br><span class="line">            page.Response.Close();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> Webhooks回调响应验证</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;ipnRequest&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;strRequest&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">VerificationResponse</span>(<span class="params">HttpRequest ipnRequest, <span class="built_in">string</span> strRequest</span>)</span></span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line"></span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//处理HttpWebRequest访问https有安全证书的问题（ 请求被中止: 未能创建 SSL/TLS 安全通道。）</span></span><br><span class="line"></span><br><span class="line">                ServicePointManager.ServerCertificateValidationCallback += (s, cert, chain, sslPolicyErrors) =&gt; <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">                ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls12 | SecurityProtocolType.Tls11 | SecurityProtocolType.Tls;</span><br><span class="line"></span><br><span class="line">                System.Net.ServicePointManager.Expect100Continue = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">                </span><br><span class="line"></span><br><span class="line">                <span class="keyword">var</span> url = <span class="string">&quot;https://api-m.sandbox.paypal.com/v1/notifications/verify-webhook-signature&quot;</span>;<span class="comment">//沙盒webhook回调通知</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="built_in">string</span> transmissionId = ipnRequest.Headers[<span class="string">&quot;PAYPAL-TRANSMISSION-ID&quot;</span>];</span><br><span class="line"></span><br><span class="line">                <span class="built_in">string</span> transmissionTime = ipnRequest.Headers[<span class="string">&quot;PAYPAL-TRANSMISSION-TIME&quot;</span>];</span><br><span class="line"></span><br><span class="line">                <span class="built_in">string</span> certUrl = ipnRequest.Headers[<span class="string">&quot;PAYPAL-CERT-URL&quot;</span>];</span><br><span class="line"></span><br><span class="line">                <span class="built_in">string</span> signatureAlgorithm = ipnRequest.Headers[<span class="string">&quot;PAYPAL-AUTH-ALGO&quot;</span>];</span><br><span class="line"></span><br><span class="line">                <span class="built_in">string</span> transmissionSig = ipnRequest.Headers[<span class="string">&quot;PAYPAL-TRANSMISSION-SIG&quot;</span>];</span><br><span class="line"></span><br><span class="line">                <span class="keyword">var</span> webhookId = <span class="string">&quot;9XY05847MO097611P&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="keyword">var</span> dataStr = <span class="string">&quot;&#123;\&quot;transmission_id\&quot;:\&quot;&quot;</span> + transmissionId + <span class="string">&quot;\&quot;,\&quot;transmission_time\&quot;:\&quot;&quot;</span> + transmissionTime + <span class="string">&quot;\&quot;,\&quot;cert_url\&quot;:\&quot;&quot;</span> + certUrl + <span class="string">&quot;\&quot;,\&quot;auth_algo\&quot;:\&quot;&quot;</span> + signatureAlgorithm + <span class="string">&quot;\&quot;&quot;</span> +</span><br><span class="line"></span><br><span class="line">                        <span class="string">&quot;,\&quot;transmission_sig\&quot;:\&quot;&quot;</span> + transmissionSig + <span class="string">&quot;\&quot;,\&quot;webhook_id\&quot;:\&quot;&quot;</span> + webhookId + <span class="string">&quot;\&quot;,\&quot;webhook_event\&quot;:&quot;</span> + strRequest + <span class="string">&quot;&#125;&quot;</span>;</span><br><span class="line"></span><br><span class="line">               </span><br><span class="line"></span><br><span class="line">                <span class="keyword">var</span> config = ConfigManager.Instance.GetProperties();<span class="comment">//读取配置文件</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">var</span> accessToken = <span class="keyword">new</span> OAuthTokenCredential(config).GetAccessToken();</span><br><span class="line"></span><br><span class="line">                HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);</span><br><span class="line"></span><br><span class="line">                request.Method = <span class="string">&quot;POST&quot;</span>;</span><br><span class="line"></span><br><span class="line">                request.ContentType = <span class="string">&quot;application/json&quot;</span>;</span><br><span class="line"></span><br><span class="line">                request.Headers.Add(<span class="string">&quot;Authorization&quot;</span>, accessToken);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="comment">//将有效负载附加到验证请求</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">var</span> streamOut = <span class="keyword">new</span> StreamWriter(request.GetRequestStream(), Encoding.ASCII);</span><br><span class="line"></span><br><span class="line">                streamOut.Write(dataStr);</span><br><span class="line"></span><br><span class="line">                streamOut.Close();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                HttpWebResponse response = (HttpWebResponse)request.GetResponse();</span><br><span class="line"></span><br><span class="line">                Stream myResponseStream = response.GetResponseStream();</span><br><span class="line"></span><br><span class="line">                StreamReader myStreamReader = <span class="keyword">new</span> StreamReader(myResponseStream);</span><br><span class="line"></span><br><span class="line">                <span class="built_in">string</span> retString = myStreamReader.ReadToEnd();</span><br><span class="line"></span><br><span class="line">                myStreamReader.Close();</span><br><span class="line"></span><br><span class="line">                myResponseStream.Close();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                JObject obj = JObject.Parse(retString);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">var</span> VerificationStatus = obj[<span class="string">&quot;verification_status&quot;</span>].ToString();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> VerificationStatus;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">catch</span> (Exception exception)</span><br><span class="line"></span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//捕获异常，打印日志输出错误</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>1、该处用于支付Webhooks回调验证。</p><p>2、官方文档： 如何使用网络钩子模拟器；验证 webhook 签名api：&#x2F;v1&#x2F;notifications&#x2F;verify-webhook-signature；</p><p>3、添加网络钩子步骤：</p><p>a、点击打开新建的app，添加Webhooks</p><p><img src="https://images.codeobservatory.cn/hexo/202507/22/94a35fa8153607bd13.png" alt="c# .net PayPal支付配置验证"><br><img src="https://images.codeobservatory.cn/hexo/202507/22/f24cf25d4682048314.png" alt="c# .net PayPal支付配置验证"><br><img src="https://images.codeobservatory.cn/hexo/202507/22/2e10d6ce241a8a3615.png" alt="c# .net PayPal支付配置验证"></p><p>b、保存后就可以获取到WebhookId了</p><p>4、也可以模拟Webhooks回调请求</p><p><img src="https://images.codeobservatory.cn/hexo/202507/22/ebf4a4db365fc85e16.png" alt="c# .net PayPal支付配置验证"></p><p>本文到这就结束了，希望对您有所帮助。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;一、添加web窗体接收通知&quot;&gt;&lt;a href=&quot;#一、添加web窗体接收通知&quot; class=&quot;headerlink&quot; title=&quot;一、添加web窗体接收通知&quot;&gt;&lt;/a&gt;一、添加web窗体接收通知&lt;/h2&gt;&lt;p&gt;用于接收第三方支付回调通知，请求链接例如：&lt;a hr</summary>
      
    
    
    
    <category term="技术分享" scheme="https://www.codeobservatory.cn/categories/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/"/>
    
    
    <category term="C#" scheme="https://www.codeobservatory.cn/tags/C/"/>
    
    <category term=".net" scheme="https://www.codeobservatory.cn/tags/net/"/>
    
    <category term="PayPal" scheme="https://www.codeobservatory.cn/tags/PayPal/"/>
    
    <category term="在线支付" scheme="https://www.codeobservatory.cn/tags/%E5%9C%A8%E7%BA%BF%E6%94%AF%E4%BB%98/"/>
    
  </entry>
  
  <entry>
    <title>Asp.Net 404页面设置，设置错误页面自动跳转</title>
    <link href="https://www.codeobservatory.cn/archives/7198a9db.html"/>
    <id>https://www.codeobservatory.cn/archives/7198a9db.html</id>
    <published>2025-07-22T03:53:18.000Z</published>
    <updated>2025-07-22T05:37:47.701Z</updated>
    
    <content type="html"><![CDATA[<h2 id="什么是404错误"><a href="#什么是404错误" class="headerlink" title="什么是404错误"></a>什么是404错误</h2><p>HTTP 404 错误意味着链接指向的网页不存在，即原始网页的URL失效，这种情况经常会发生，很难避免，比如说：网页URL生成规则改变、网页文件更名或移动位置、导入链接拼写错误等，导致原来的URL地址无法访问;当Web 服务器接到类似请求时，会返回一个404 状态码，告诉浏览器要请求的资源并不存在。但是，Web服务器默认的404错误页面，无论Apache还是IIS，均十分简陋、呆板且对用户不友好，无法给用户提供必要的信息以获取更多线索，无疑这会造成用户的流失。</p><h2 id="404页面的作用"><a href="#404页面的作用" class="headerlink" title="404页面的作用"></a>404页面的作用</h2><p>搜索引擎通过HTTP状态码来识别网页的状态。当搜索引擎获得了一个错误链接时，网站应该返回404状态码，告诉搜索引擎放弃对该链接的索引。而如果返回200或302状态码，搜索引擎就会为该链接建立索引，这导致大量不同的链接指向了相同的网页内容。结果是，搜索引擎对该网站的信任度大幅降低。</p><h2 id="如何检查自定义404页面能够返回“404”状态码"><a href="#如何检查自定义404页面能够返回“404”状态码" class="headerlink" title="如何检查自定义404页面能够返回“404”状态码"></a>如何检查自定义404页面能够返回“404”状态码</h2><p>在自定义404错误页面设置完毕后，一定要检查一下其是不是能够正确地返回“404”状态码。检查的方法也相当简单，输入一个网站内不存在网页的url，查看一下HTTP Header的返回情况，确信其返回的是“404”状态码。</p><h2 id="404页面的正确做法"><a href="#404页面的正确做法" class="headerlink" title="404页面的正确做法"></a>404页面的正确做法</h2><p>1、Apache服务器404页面的设置方法</p><p>在<code>.htaccess</code> 文件中加入代码：<code>ErrorDocument 404 /Error.html</code></p><p>建立一个简单的html404页面命名 Error.html</p><p>把 Error.html放置在网站根目录即可。</p><p>2、IIS&#x2F;ASP.net下设置404错误页面</p><p>首先，修改应用程序根目录的设置，打开 “<code>web.config</code>” 文件编辑，在其中加入如下内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">system.web</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">customErrors</span> <span class="attr">mode</span>=<span class="string">”On”</span> <span class="attr">defaultRedirect</span>=<span class="string">”error.asp”</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">error</span> <span class="attr">statusCode</span>=<span class="string">”404″</span> <span class="attr">redirect</span>=<span class="string">”notfound.asp”</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">customErrors</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">system.web</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><p>此例中“error.asp”为系统默认的404页面，“notfound.asp”为自定义的404页面，使用时请修改相应文件名。</p><p>然后，在自定义的404页面“notfound.asp”中加入：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">Response.Status = “<span class="number">404</span> Not Found”</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>这样，便可以保证IIS能够正确地返回“404”状态码</p><blockquote><p>友情提醒</p></blockquote><p>1、一定不要将404错误直接转向到网站首页，这将可能导致你的网站首页不被收录;</p><p>2、&#x2F;Error.html 前面请不要带主域名(错误的写法：codeobservatory.cn&#x2F;error.html，正确的写法：&#x2F;error.html)，否者返回的状态码是302或200状态码。</p><p>从网上搜索asp.net网站如何自定义404错误页面时，大多数文章都是告诉你在web.config中，找到system.web，配置以下内容即可。</p><p>代码如下:</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;customErrors mode=<span class="string">&quot;On&quot;</span> error statusCode=<span class="string">&quot;404&quot;</span> redirect=<span class="string">&quot;/404.htm&quot;</span> &gt;</span><br><span class="line">&lt;/customErrors&gt;</span><br></pre></td></tr></table></figure><p>实际上这样做之后，根本就得不到404未找到网页的网页头信息，得到的是302临时重定向的网页头信息。大家可以用 Check Headers Tool 工具查看 HTTP Status Codes就知道了。</p><blockquote><p>那么如何正确配置asp.net网站的自定义404错误网页呢？</p></blockquote><p>首先制作一个404.aspx页面，然后在web.config文件下的customeErrors中如下配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">customErrors redirectMode=&quot;ResponseRewrite&quot;</span><br><span class="line">error statusCode=&quot;404&quot; redirect=&quot;~/404.aspx&quot;/</span><br><span class="line">/customErrors</span><br></pre></td></tr></table></figure><p><strong><code>RedirectMode</code>有两种属性</strong>。</p><ul><li>ResponseRedirect是指将用户重定向到该错误页面，并且原始 URL 更改为该错误页面的 URL。</li><li>ResponseRewrite是指将用户定向到错误页面，并且不更改浏览器中的原始 URL。</li></ul><p>然后再在404.aspx.cs文件中，为Page_Load事件中加入以下代码：</p><p>代码如下:</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">Page_Load</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">Response.Status = <span class="string">&quot;404 Not Found&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>经过这样设置之后，HTTP Status Code 才会是 404 Not Found。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;什么是404错误&quot;&gt;&lt;a href=&quot;#什么是404错误&quot; class=&quot;headerlink&quot; title=&quot;什么是404错误&quot;&gt;&lt;/a&gt;什么是404错误&lt;/h2&gt;&lt;p&gt;HTTP 404 错误意味着链接指向的网页不存在，即原始网页的URL失效，这种情况经常会发生</summary>
      
    
    
    
    <category term="技术分享" scheme="https://www.codeobservatory.cn/categories/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/"/>
    
    
    <category term=".net" scheme="https://www.codeobservatory.cn/tags/net/"/>
    
    <category term="404页面" scheme="https://www.codeobservatory.cn/tags/404%E9%A1%B5%E9%9D%A2/"/>
    
  </entry>
  
  <entry>
    <title>C#解析、拼接json字符串</title>
    <link href="https://www.codeobservatory.cn/archives/e4c33417.html"/>
    <id>https://www.codeobservatory.cn/archives/e4c33417.html</id>
    <published>2025-07-04T09:38:12.000Z</published>
    <updated>2025-07-22T02:48:46.561Z</updated>
    
    <content type="html"><![CDATA[<p>本篇文章主要介绍了在C#中json字符串的拼接与解析的实操案例，希望你阅读完后，对你有所帮助。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//组成json字符串  </span></span><br><span class="line">          </span><br><span class="line"><span class="title class_">JObject</span> ret = <span class="keyword">new</span> <span class="title class_">JObject</span>(); </span><br><span class="line">           </span><br><span class="line">ret[<span class="string">&quot;xxx&quot;</span>] = <span class="string">&quot;1&quot;</span>;    </span><br><span class="line">        </span><br><span class="line"><span class="title class_">JArray</span> body = <span class="keyword">new</span> <span class="title class_">JArray</span>();</span><br><span class="line">            </span><br><span class="line"><span class="title class_">JObject</span> obj = <span class="keyword">new</span> <span class="title class_">JObject</span>();</span><br><span class="line">            </span><br><span class="line">obj[<span class="string">&quot;aaa&quot;</span>] = <span class="string">&quot;2&quot;</span>;    </span><br><span class="line">        </span><br><span class="line">obj[<span class="string">&quot;bbb&quot;</span>] = <span class="string">&quot;3&quot;</span>;   </span><br><span class="line">         </span><br><span class="line">body.<span class="title class_">Add</span>(obj);    </span><br><span class="line">        </span><br><span class="line">body.<span class="title class_">Add</span>(obj);   </span><br><span class="line">         </span><br><span class="line"><span class="title class_">JObject</span> sss = <span class="keyword">new</span> <span class="title class_">JObject</span>(); </span><br><span class="line">           </span><br><span class="line">sss[<span class="string">&quot;ret&quot;</span>] = ret;    </span><br><span class="line">        </span><br><span class="line">sss[<span class="string">&quot;body&quot;</span>] = body;   </span><br><span class="line">         </span><br><span class="line">string aaaa = <span class="title class_">JsonConvert</span>.<span class="title class_">SerializeObject</span>(sss); </span><br><span class="line"></span><br><span class="line"><span class="title class_">Information</span>.<span class="title class_">LogError</span>(aaaa);</span><br></pre></td></tr></table></figure><p><img src="https://images.codeobservatory.cn/hexo/202507/22/34b062a7e698e0f303.png" alt="C#解析、拼接json字符串"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//解析json字符串</span></span><br><span class="line">            <span class="title class_">JObject</span> jo = (<span class="title class_">JObject</span>)<span class="title class_">JsonConvert</span>.<span class="title class_">DeserializeObject</span>(aaaa);</span><br><span class="line">            string qaz = jo[<span class="string">&quot;ret&quot;</span>].<span class="title class_">ToString</span>();</span><br><span class="line">            string ws = jo[<span class="string">&quot;body&quot;</span>].<span class="title class_">ToString</span>();</span><br><span class="line">            <span class="title class_">Information</span>.<span class="title class_">LogError</span>(qaz);</span><br><span class="line">            <span class="title class_">Information</span>.<span class="title class_">LogError</span>(ws);</span><br><span class="line">            <span class="title class_">JArray</span> xxs = (<span class="title class_">JArray</span>)<span class="title class_">JsonConvert</span>.<span class="title class_">DeserializeObject</span>(ws);</span><br><span class="line">            <span class="keyword">for</span>(int i =<span class="number">0</span>; i&lt;xxs.<span class="property">Count</span>;i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="title class_">Information</span>.<span class="title class_">LogError</span>(xxs[i][<span class="string">&quot;aaa&quot;</span>].<span class="title class_">ToString</span>());</span><br><span class="line">                <span class="title class_">Information</span>.<span class="title class_">LogError</span>(xxs[i][<span class="string">&quot;bbb&quot;</span>].<span class="title class_">ToString</span>());</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure><p><img src="https://images.codeobservatory.cn/hexo/202507/22/818b84039fa15ee604.png" alt="C#解析、拼接json字符串"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//JavaScript解析josn格式数据</span></span><br><span class="line"></span><br><span class="line">string json=<span class="string">&quot;&#123;&quot;</span>ret<span class="string">&quot;:&#123;&quot;</span>xxx<span class="string">&quot;:&quot;</span><span class="number">1</span><span class="string">&quot;&#125;,&quot;</span>body<span class="string">&quot;:[&#123;&quot;</span>aaa<span class="string">&quot;:&quot;</span><span class="number">2</span><span class="string">&quot;,&quot;</span>bbb<span class="string">&quot;:&quot;</span><span class="number">3</span><span class="string">&quot;&#125;,&#123;&quot;</span>aaa<span class="string">&quot;:&quot;</span><span class="number">2</span><span class="string">&quot;,&quot;</span>bbb<span class="string">&quot;:&quot;</span><span class="number">3</span><span class="string">&quot;&#125;]&#125;&quot;</span>; </span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> dataObj = <span class="built_in">eval</span>(<span class="string">&quot;(&quot;</span> + json + <span class="string">&quot;)&quot;</span>);<span class="comment">//转换为json对象  </span></span><br><span class="line"> </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(dataObj);  </span><br><span class="line"></span><br><span class="line">$.<span class="title function_">each</span>(dataObj.<span class="property">rows</span>, <span class="keyword">function</span> (<span class="params">i, item</span>) </span><br><span class="line">&#123;  </span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(item.<span class="property">ret</span>);</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;本篇文章主要介绍了在C#中json字符串的拼接与解析的实操案例，希望你阅读完后，对你有所帮助。&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;</summary>
      
    
    
    
    <category term="后端开发" scheme="https://www.codeobservatory.cn/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="C#" scheme="https://www.codeobservatory.cn/tags/C/"/>
    
    <category term="json" scheme="https://www.codeobservatory.cn/tags/json/"/>
    
  </entry>
  
  <entry>
    <title>C#使用PrintDocument类打印标签的方法</title>
    <link href="https://www.codeobservatory.cn/archives/72eceb8.html"/>
    <id>https://www.codeobservatory.cn/archives/72eceb8.html</id>
    <published>2025-07-04T09:37:34.000Z</published>
    <updated>2025-07-22T03:50:34.956Z</updated>
    
    <content type="html"><![CDATA[<p>最近做了一个项目，使用热敏打印标签贴在PCB线路板标签上，那么就会出现标签打印的问题，该如何打印呢？后来经过网上冲浪发现，其实打印标签和打印A4纸的方法一样，只不过就是布局、设置纸张大小的问题。</p><pre><code>本文介绍打印机初步配置，以及实现方法。标签主要展示资产基本信息以及二维码。首先设置打印机纸张大小，纸张高宽度以实际标签为准，设置好后可打印测试页测试一下，以ZDesigner GX430t打印机为例。</code></pre><p><img src="https://images.codeobservatory.cn/hexo/202507/22/f0f453f581cf6c8e01.png" alt="C#使用PrintDocument类打印标签的方法"></p><p>创建PrintDocument实例，以及配置打印机名称：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 打印</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">   <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Myprinter</span>()</span> &#123;</span><br><span class="line">   PrintDocument pd = <span class="keyword">new</span> PrintDocument();      </span><br><span class="line">   pd.PrintPage += <span class="keyword">new</span> PrintPageEventHandler(printDocument_PrintA4Page);</span><br><span class="line">   </span><br><span class="line">   pd.DefaultPageSettings.PrinterSettings.PrinterName = <span class="string">&quot;ZDesigner GX430t&quot;</span>;       <span class="comment">//打印机名称</span></span><br><span class="line">   <span class="comment">//pd.DefaultPageSettings.Landscape = true;  //设置横向打印，不设置默认是纵向的</span></span><br><span class="line">   pd.PrintController = <span class="keyword">new</span> System.Drawing.Printing.StandardPrintController();  </span><br><span class="line">   pd.Print();  </span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>设置页面布局，根据实际需求进行排版</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">printDocument_PrintA4Page</span>(<span class="params"><span class="built_in">object</span> sender, PrintPageEventArgs e</span>)</span>&#123;</span><br><span class="line">    Font titleFont = <span class="keyword">new</span> Font(<span class="string">&quot;黑体&quot;</span>, <span class="number">11</span>, System.Drawing.FontStyle.Bold);<span class="comment">//标题字体           </span></span><br><span class="line">    Font fntTxt = <span class="keyword">new</span> Font(<span class="string">&quot;宋体&quot;</span>, <span class="number">10</span>, System.Drawing.FontStyle.Regular);<span class="comment">//正文文字         </span></span><br><span class="line">    Font fntTxt1 = <span class="keyword">new</span> Font(<span class="string">&quot;宋体&quot;</span>, <span class="number">8</span>, System.Drawing.FontStyle.Regular);<span class="comment">//正文文字           </span></span><br><span class="line">    System.Drawing.Brush brush = <span class="keyword">new</span> SolidBrush(System.Drawing.Color.Black);<span class="comment">//画刷           </span></span><br><span class="line">    System.Drawing.Pen pen = <span class="keyword">new</span> System.Drawing.Pen(System.Drawing.Color.Black);           <span class="comment">//线条颜色         </span></span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123; </span><br><span class="line">        e.Graphics.DrawString(<span class="string">&quot;标题name&quot;</span>, titleFont, brush, <span class="keyword">new</span> System.Drawing.Point(<span class="number">20</span>, <span class="number">10</span>));</span><br><span class="line">        Point[] points111 = &#123; <span class="keyword">new</span> Point(<span class="number">20</span>, <span class="number">28</span>), <span class="keyword">new</span> Point(<span class="number">230</span>,<span class="number">28</span>) &#125;;</span><br><span class="line">        e.Graphics.DrawLines(pen, points111); </span><br><span class="line">        e.Graphics.DrawString(<span class="string">&quot;资产编号：&quot;</span>, fntTxt, brush, <span class="keyword">new</span> System.Drawing.Point(<span class="number">20</span>, <span class="number">31</span>));</span><br><span class="line">        e.Graphics.DrawString(<span class="string">&quot;123456789123465&quot;</span>, fntTxt, brush, <span class="keyword">new</span> System.Drawing.Point(<span class="number">80</span>, <span class="number">31</span>));</span><br><span class="line">        e.Graphics.DrawString(<span class="string">&quot;资产序号：&quot;</span>, fntTxt, brush, <span class="keyword">new</span> System.Drawing.Point(<span class="number">20</span>, <span class="number">46</span>));</span><br><span class="line">        e.Graphics.DrawString(<span class="string">&quot;123456789131321&quot;</span>, fntTxt, brush, <span class="keyword">new</span> System.Drawing.Point(<span class="number">80</span>, <span class="number">46</span>));</span><br><span class="line">        e.Graphics.DrawString(<span class="string">&quot;底部name&quot;</span>, fntTxt1, brush, <span class="keyword">new</span> System.Drawing.Point(<span class="number">100</span>, <span class="number">62</span>));</span><br><span class="line">        Bitmap bitmap = CreateQRCode(<span class="string">&quot;此处为二维码数据&quot;</span>);</span><br><span class="line">        e.Graphics.DrawImage(bitmap, <span class="keyword">new</span> System.Drawing.Point(<span class="number">240</span>, <span class="number">10</span>));  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception ee)</span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox.Show(ee.Message);</span><br><span class="line">    &#125;&#125;</span><br></pre></td></tr></table></figure><p>二维码生成方法，我这里使用zxing</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 二维码方法</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;asset&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Bitmap <span class="title">CreateQRCode</span>(<span class="params"><span class="built_in">string</span> asset</span>)</span>&#123;</span><br><span class="line">    EncodingOptions options = <span class="keyword">new</span> QrCodeEncodingOptions</span><br><span class="line">    &#123;</span><br><span class="line">        DisableECI = <span class="literal">true</span>,</span><br><span class="line">        CharacterSet = <span class="string">&quot;UTF-8&quot;</span>, <span class="comment">//编码</span></span><br><span class="line">        Width = <span class="number">80</span>,             <span class="comment">//宽度</span></span><br><span class="line">        Height = <span class="number">80</span>             <span class="comment">//高度</span></span><br><span class="line">    &#125;;</span><br><span class="line">    BarcodeWriter writer = <span class="keyword">new</span> BarcodeWriter();</span><br><span class="line">    writer.Format = BarcodeFormat.QR_CODE;</span><br><span class="line">    writer.Options = options;</span><br><span class="line">    <span class="keyword">return</span> writer.Write(asset);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>效果图：</p><p><img src="https://images.codeobservatory.cn/hexo/202507/22/2b997e4716864e7a02.jpg" alt="C#使用PrintDocument类打印标签的方法"></p><p>最后附上源码，里面有zxing.dll</p><blockquote><p>链接: <a href="https://pan.baidu.com/s/1mWdjSPt282tKVz-B1VJoTA">https://pan.baidu.com/s/1mWdjSPt282tKVz-B1VJoTA</a><br>提取码: 517j</p></blockquote><p>2019.09.05 补充：<br>增加一维码打印</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 创建条码方法</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;asset&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Bitmap <span class="title">CreateCode</span>(<span class="params"><span class="built_in">string</span> asset</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// 1.设置条形码规格</span></span><br><span class="line">    EncodingOptions options = <span class="keyword">new</span> EncodingOptions();</span><br><span class="line">    options.Height = <span class="number">40</span>; <span class="comment">// 必须制定高度、宽度</span></span><br><span class="line">    options.Width = <span class="number">120</span>; </span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2.生成条形码图片并保存</span></span><br><span class="line">    BarcodeWriter writer = <span class="keyword">new</span> BarcodeWriter();</span><br><span class="line">    writer.Options = options; </span><br><span class="line">    writer.Format = BarcodeFormat.CODE_128;     <span class="comment">//二维码编码</span></span><br><span class="line">    <span class="keyword">return</span> writer.Write(asset);     <span class="comment">// 生成图片&#125;</span></span><br></pre></td></tr></table></figure><p>到此这篇关于C# 使用PrintDocument类打印标签的文章就介绍到这了,更多相关C# 打印标签内容请搜索以前的文章或继续浏览下面的相关文章</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;最近做了一个项目，使用热敏打印标签贴在PCB线路板标签上，那么就会出现标签打印的问题，该如何打印呢？后来经过网上冲浪发现，其实打印标签和打印A4纸的方法一样，只不过就是布局、设置纸张大小的问题。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;本文介绍打印机初步配置，以及实现方法。标签主要展</summary>
      
    
    
    
    <category term="后端开发" scheme="https://www.codeobservatory.cn/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="C#" scheme="https://www.codeobservatory.cn/tags/C/"/>
    
    <category term="打印标签" scheme="https://www.codeobservatory.cn/tags/%E6%89%93%E5%8D%B0%E6%A0%87%E7%AD%BE/"/>
    
    <category term="PrintDocument" scheme="https://www.codeobservatory.cn/tags/PrintDocument/"/>
    
  </entry>
  
  <entry>
    <title>layui-icon常用记录大全_layui-icon图标库</title>
    <link href="https://www.codeobservatory.cn/archives/9d0caa39.html"/>
    <id>https://www.codeobservatory.cn/archives/9d0caa39.html</id>
    <published>2025-07-04T09:37:10.000Z</published>
    <updated>2025-07-22T03:40:01.472Z</updated>
    
    <content type="html"><![CDATA[<link href="//unpkg.com/layui@2.11.5/dist/css/layui.css" rel="stylesheet">icon有很多，选择起来纷繁复杂，罗列一点常用的，用于自己以后使用，大家可以收藏起来哦~~<table><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td>滑块 <br>layui-icon-slider <br><i class="layui-icon layui-icon-slider"></i></td><td>打印 <br>layui-icon-print <br><i class="layui-icon layui-icon-print"></i></td><td>导出 <br>layui-icon-export <br><i class="layui-icon layui-icon-export"></i></td><td>列 <br>layui-icon-cols <br><i class="layui-icon layui-icon-cols"></i></td></tr><tr><td>退出全屏 <br>layui-icon-screen-restore <br><i class="layui-icon layui-icon-screen-restore"></i></td><td>全屏 <br>layui-icon-screen-full <br><i class="layui-icon layui-icon-screen-full"></i></td><td>半星 <br>layui-icon-rate-half <br><i class="layui-icon layui-icon-rate-half"></i></td><td>星星-空心 <br>layui-icon-rate<br><i class="layui-icon layui-icon-rate"></i></td></tr><tr><td>星星-实心 <br>layui-icon-rate-solid<br><i class="layui-icon layui-icon-rate-solid"></i></td><td>手机 <br>layui-icon-cellphone<br><i class="layui-icon layui-icon-cellphone"></i></td><td>验证码 <br>layui-icon-vercode<br><i class="layui-icon layui-icon-vercode"></i></td><td>微信 <br>layui-icon-login-wechat <br><i class="layui-icon layui-icon-login-wechat"></i></td></tr><tr><td>QQ <br>layui-icon-login-qq<br><i class="layui-icon layui-icon-login-qq"></i></td><td>微博 <br>layui-icon-login-weibo<br><i class="layui-icon layui-icon-login-weibo"></i></td><td>刷新-粗 <br>layui-icon-refresh-3<br><i class="layui-icon layui-icon-refresh-3"></i></td><td>授权 <br>layui-icon-auz<br><i class="layui-icon layui-icon-auz"></i></td></tr><tr><td>左向右伸缩菜单 <br>layui-icon-spread-left<br><i class="layui-icon layui-icon-spread-left"></i></td><td>右向左伸缩菜单 <br>layui-icon-shrink-right<br><i class="layui-icon layui-icon-shrink-right"></i></td><td>雪花 <br>layui-icon-snowflake<br><i class="layui-icon layui-icon-snowflake"></i></td><td>提示说明 <br>layui-icon-tips<br><i class="layui-icon layui-icon-tips"></i></td></tr><tr><td>便签 <br>layui-icon-note<br><i class="layui-icon layui-icon-note"></i></td><td>主页 <br>layui-icon-home<br><i class="layui-icon layui-icon-home"></i></td><td>高级 <br>layui-icon-senior<br><i class="layui-icon layui-icon-senior"></i></td><td>刷新 <br>layui-icon-refresh<br><i class="layui-icon layui-icon-refresh"></i></td></tr><tr><td>刷新 <br>layui-icon-refresh-1<br><i class="layui-icon layui-icon-refresh-1"></i></td><td>旗帜 <br>layui-icon-flag<br><i class="layui-icon layui-icon-flag"></i></td><td>主题 <br>layui-icon-theme<br><i class="layui-icon layui-icon-theme"></i></td><td>消息-通知 <br>layui-icon-notice<br><i class="layui-icon layui-icon-notice"></i></td></tr><tr><td>网站 <br>layui-icon-website<br><i class="layui-icon layui-icon-website"></i></td><td>控制台 <br>layui-icon-console<br><i class="layui-icon layui-icon-console"></i></td><td>表情-惊讶 <br>layui-icon-face-surprised<br><i class="layui-icon layui-icon-face-surprised"></i></td><td>设置-空心 <br>layui-icon-set<br><i class="layui-icon layui-icon-set"></i></td></tr><tr><td>模板 <br>layui-icon-template-1<br><i class="layui-icon layui-icon-template-1"></i></td><td>应用 <br>layui-icon-app<br><i class="layui-icon layui-icon-app"></i></td><td>模板 <br>layui-icon-template<br><i class="layui-icon layui-icon-template"></i></td><td>赞 <br>layui-icon-praise<br><i class="layui-icon layui-icon-praise"></i></td></tr><tr><td>踩 <br>layui-icon-tread<br><i class="layui-icon layui-icon-tread"></i></td><td>男 <br>layui-icon-male<br><i class="layui-icon layui-icon-male"></i></td><td>女 <br>layui-icon-female<br><i class="layui-icon layui-icon-female"></i></td><td>相机-空心 <br>layui-icon-camera<br><i class="layui-icon layui-icon-camera"></i></td></tr><tr><td>相机-实心 <br>layui-icon-camera-fill<br><i class="layui-icon layui-icon-camera-fill"></i></td><td>菜单-水平  <br>layui-icon-more<br><i class="layui-icon layui-icon-more"></i></td><td>菜单-垂直 <br>layui-icon-more-vertical<br><i class="layui-icon layui-icon-more-vertical"></i></td><td>金额-人民币 <br>layui-icon-rmb<br><i class="layui-icon layui-icon-rmb"></i></td></tr><tr><td>金额-美元 <br>layui-icon-dollar<br><i class="layui-icon layui-icon-dollar"></i></td><td>钻石-等级 <br>layui-icon-diamond<br><i class="layui-icon layui-icon-diamond"></i></td><td>火 <br>layui-icon-fire<br><i class="layui-icon layui-icon-fire"></i></td><td>返回 <br>layui-icon-return<br><i class="layui-icon layui-icon-return"></i></td></tr><tr><td>位置-地图 <br>layui-icon-location<br><i class="layui-icon layui-icon-location"></i></td><td>办公-阅读 <br>layui-icon-read<br><i class="layui-icon layui-icon-read"></i></td><td>调查 <br>layui-icon-survey<br><i class="layui-icon layui-icon-survey"></i></td><td>表情-微笑 <br>layui-icon-face-smile<br><i class="layui-icon layui-icon-face-smile"></i></td></tr><tr><td>表情-哭泣 <br>layui-icon-face-cry<br><i class="layui-icon layui-icon-face-cry"></i></td><td>购物车 <br>layui-icon-cart-simple<br><i class="layui-icon layui-icon-cart-simple"></i></td><td>购物车 <br>layui-icon-cart<br><i class="layui-icon layui-icon-cart"></i></td><td>下一页 <br>layui-icon-next<br><i class="layui-icon layui-icon-next"></i></td></tr><tr><td>上一页 <br>layui-icon-prev<br><i class="layui-icon layui-icon-prev"></i></td><td>上传-空心-拖拽 <br>layui-icon-upload-drag<br><i class="layui-icon layui-icon-upload-drag"></i></td><td>上传-实心 <br>layui-icon-upload<br><i class="layui-icon layui-icon-upload"></i></td><td>下载-圆圈 <br>layui-icon-download-circle<br><i class="layui-icon layui-icon-download-circle"></i></td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;link href=&quot;//unpkg.com/layui@2.11.5/dist/css/layui.css&quot; rel=&quot;stylesheet&quot;&gt;
icon有很多，选择起来纷繁复杂，罗列一点常用的，用于自己以后使用，大家可以收藏起来哦~~

&lt;table&gt;
&lt;thead&gt;
&lt;t</summary>
      
    
    
    
    <category term="前端开发" scheme="https://www.codeobservatory.cn/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="layui" scheme="https://www.codeobservatory.cn/tags/layui/"/>
    
    <category term="icon" scheme="https://www.codeobservatory.cn/tags/icon/"/>
    
    <category term="图标库" scheme="https://www.codeobservatory.cn/tags/%E5%9B%BE%E6%A0%87%E5%BA%93/"/>
    
    <category term="icon大全" scheme="https://www.codeobservatory.cn/tags/icon%E5%A4%A7%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>关闭SQLSERVER阻止保存要求重新创建表的更改</title>
    <link href="https://www.codeobservatory.cn/archives/b3bde0f.html"/>
    <id>https://www.codeobservatory.cn/archives/b3bde0f.html</id>
    <published>2025-07-04T09:36:42.000Z</published>
    <updated>2025-07-22T03:49:55.004Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>怎样关闭SQLSERVER阻止保存要求重新创建表的更改呢？</p></blockquote><p>今天和大家 分享一下关闭<a href="/tags/sql/">SQLSERVER</a>阻止保存要求重新创建表的更改。</p><p><img src="https://images.codeobservatory.cn/hexo/202507/22/3abffd2a9a75bb4e05.png" alt="关闭SQLSERVER阻止保存要求重新创建表的更改"></p><p>1、首先打开SQL SERVER management studio软件，如下图，选择导航栏上面的工具选项 。</p><p><img src="https://images.codeobservatory.cn/hexo/202507/22/37f6763fc6debab06.png" alt="关闭SQLSERVER阻止保存要求重新创建表的更改"></p><p>2、打开如下图界面，选择选项，点击打开</p><p><img src="https://images.codeobservatory.cn/hexo/202507/22/98ec44753145aa07.png" alt="关闭SQLSERVER阻止保存要求重新创建表的更改"></p><p>3、打开如下图界面，选择界面左侧的Designers选项，点击打开</p><p><img src="https://images.codeobservatory.cn/hexo/202507/22/c8e0b37a84d0f61408.png" alt="关闭SQLSERVER阻止保存要求重新创建表的更改"></p><p>4、打开如下图界面，取消勾选界面右侧的阻止保存要求重新创建表的更改选项，然后点击下方的确定按钮，这样就关闭了。</p><p><img src="https://images.codeobservatory.cn/hexo/202507/22/33c10c4cf2a6c7b709.png" alt="关闭SQLSERVER阻止保存要求重新创建表的更改"></p><p>5、到此，关闭SQLSERVER阻止保存要求重新创建表的更改已经完成了。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;怎样关闭SQLSERVER阻止保存要求重新创建表的更改呢？&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;今天和大家 分享一下关闭&lt;a href=&quot;/tags/sql/&quot;&gt;SQLSERVER&lt;/a&gt;阻止保存要求重新创建表的更改。&lt;/p&gt;
&lt;p&gt;&lt;img</summary>
      
    
    
    
    <category term="数据库" scheme="https://www.codeobservatory.cn/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="sql" scheme="https://www.codeobservatory.cn/tags/sql/"/>
    
    <category term="数据库" scheme="https://www.codeobservatory.cn/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>未能写入输出文件 “c:&#92;Windows&#92;Microsoft.NET&#92;Framework&#92;v4.0.30319&#92;Temporary ASP.NET Files&#92;root&#92;6ee8fd15&#92;5fc973dd&#92;App_Web_default.aspx.cdcab7d2.e1voeq0d.dll”--“拒绝访问</title>
    <link href="https://www.codeobservatory.cn/archives/b4d8b88f.html"/>
    <id>https://www.codeobservatory.cn/archives/b4d8b88f.html</id>
    <published>2025-07-04T09:33:44.000Z</published>
    <updated>2025-07-07T03:57:02.742Z</updated>
    
    <content type="html"><![CDATA[<ul><li><p>在本地开发环境没问题,但是发布到服务器出现:未能写入输出文件“c:\Windows\Microsoft.NET\Framework64\v4.0.30319\Temporary ASP.NET Files\root\106f9ae8\cc0e1169\App_global.asax.haz99mum.dll”–“拒绝访问。 ”错误</p></li><li><p>还有就是在迁移服务器时，在原来的服务器上是好好的，迁移到新的服务器上部署好之后，浏览器打开显示乱码，无法访问</p></li></ul><h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法:"></a>解决方法:</h2><ol><li>通常的解决方法：原因是由于系统目录下的Temp目录无相应的权限所致，具体操作如下：C:\Windows\temp–&gt;属性–&gt;安全–&gt;编辑–&gt;添加NETWORK SERVICE用户的读写权限就可以解决.</li><li>打开服务器系统c盘，打开window， 右键temp 属性 安全 编辑 添加IIS_IUSRS 用户控制权限添加修改和写入权限即可。这是Windows Server 2008 R2 标准版 SP1 64位中文版解决办法。(我的是这个问题.这样就解决了,上面的network service不用也行)</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;在本地开发环境没问题,但是发布到服务器出现:未能写入输出文件“c:&#92;Windows&#92;Microsoft.NET&#92;Framework64&#92;v4.0.30319&#92;Temporary ASP.NET Files&#92;root&#92;106f9ae8&#92;cc0e1169&#92;Ap</summary>
      
    
    
    
    <category term="技术分享" scheme="https://www.codeobservatory.cn/categories/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/"/>
    
    
    <category term="服务器错误" scheme="https://www.codeobservatory.cn/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%94%99%E8%AF%AF/"/>
    
  </entry>
  
  <entry>
    <title>【好用推荐】免费在线图片压缩工具</title>
    <link href="https://www.codeobservatory.cn/archives/fb2da740.html"/>
    <id>https://www.codeobservatory.cn/archives/fb2da740.html</id>
    <published>2025-06-21T00:50:21.000Z</published>
    <updated>2025-06-21T01:27:40.442Z</updated>
    
    <content type="html"><![CDATA[<p>大家好，这里是码农观测站，我是码农刚子。前几天填写备案资料时需要上传营业执照，要求2MB以内，老板发给我的文件有十几MB，无法上传，用网上的在线工具，又担心安全性。以前也经常遇到需要图片太大的问题，基本上都是找别人用vip办公软件处理的，每次都要麻烦别人，于是我就想着自己做一个，使用方便还安全。接下来我给大家介绍一下我的图片压缩工具，源码在结尾。</p><h2 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h2><ul><li>上传图片后，通过滑块调整压缩质量（0%-100%）</li><li>点击”上传并压缩图片”按钮进行处理</li><li>压缩完成后，右侧会显示压缩后的图片</li><li>点击”下载压缩图片”按钮保存结果</li></ul><blockquote><p>先体验一下吧！<a href="https://www.codeobservatory.cn/tools/image-compress.html">👉压缩图片</a></p></blockquote><h2 id="支持格式"><a href="#支持格式" class="headerlink" title="支持格式"></a>支持格式</h2><ul><li>JPEG (.jpg, .jpeg)</li><li>PNG (.png)</li><li>GIF (.gif)</li><li>WebP (.webp)</li><li>BMP (.bmp)</li></ul><h2 id="自定义压缩质量"><a href="#自定义压缩质量" class="headerlink" title="自定义压缩质量"></a>自定义压缩质量</h2><ul><li>使用滑块自由调整压缩质量（0%-100%）</li><li>0% - 最高压缩（最小文件尺寸，最低质量）</li><li>100% - 最低压缩（最大文件尺寸，最高质量）</li><li>默认值设置为30% - 良好平衡点</li><li>实时显示压缩质量百分比</li></ul><h2 id="技术实现"><a href="#技术实现" class="headerlink" title="技术实现"></a>技术实现</h2><ul><li>前端使用Fetch API发送multipart&#x2F;form-data请求</li><li>后端使用ASP.NET Core处理文件上传</li><li>使用ImageService进行图片压缩处理</li><li>响应状态码：200（成功）、400（错误请求）</li></ul><h2 id="源码如下"><a href="#源码如下" class="headerlink" title="源码如下"></a>源码如下</h2><p>话不多说，直接开干！</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">header</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fas fa-file-image&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 免费在线图片压缩工具<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>保持画质清晰，快速缩小JPG/PNG/GIF/WebP文件，自定义压缩大小，压缩后可直接下载<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;upload-section&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">&quot;section-title&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fas fa-cloud-upload-alt&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 上传图片<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/&quot;</span> <span class="attr">class</span>=<span class="string">&quot;browse-btn refresh&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span> <span class="attr">title</span>=<span class="string">&quot;码农观测站&quot;</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;browse-btn refresh&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;window.location.reload();&quot;</span>&gt;</span>刷新<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;upload-area&quot;</span> <span class="attr">id</span>=<span class="string">&quot;uploadArea&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fas fa-images&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>拖放图片到此处<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">p</span>&gt;</span>支持 JPG, PNG, GIF, WEBP 格式<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;browse-btn&quot;</span>&gt;</span>选择图片<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;fileInput&quot;</span> <span class="attr">class</span>=<span class="string">&quot;file-input&quot;</span> <span class="attr">accept</span>=<span class="string">&quot;image/*&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;preview-container&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;preview-title&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fas fa-eye&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 图片预览<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;image-preview&quot;</span> <span class="attr">id</span>=<span class="string">&quot;imagePreview&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">&quot;previewImage&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;预览图&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;compression-control&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;quality-label&quot;</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">span</span>&gt;</span>压缩质量:<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;quality-value&quot;</span> <span class="attr">id</span>=<span class="string">&quot;qualityValue&quot;</span>&gt;</span>30%<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;slider-container&quot;</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;range&quot;</span> <span class="attr">min</span>=<span class="string">&quot;0&quot;</span> <span class="attr">max</span>=<span class="string">&quot;100&quot;</span> <span class="attr">value</span>=<span class="string">&quot;30&quot;</span> <span class="attr">class</span>=<span class="string">&quot;quality-slider&quot;</span> <span class="attr">id</span>=<span class="string">&quot;qualitySlider&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;slider-ticks&quot;</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">span</span>&gt;</span>0%<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">span</span>&gt;</span>25%<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">span</span>&gt;</span>50%<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">span</span>&gt;</span>75%<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">span</span>&gt;</span>100%<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;progress-container&quot;</span> <span class="attr">id</span>=<span class="string">&quot;progressContainer&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;progress-bar&quot;</span> <span class="attr">id</span>=<span class="string">&quot;progressBar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;upload-btn&quot;</span> <span class="attr">id</span>=<span class="string">&quot;uploadBtn&quot;</span> <span class="attr">disabled</span>=<span class="string">&quot;&quot;</span>&gt;</span>上传并压缩图片<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;api-info&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;result-section&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">&quot;section-title&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fas fa-download&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 压缩结果<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;result-container&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;result-content&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;result-placeholder&quot;</span> <span class="attr">id</span>=<span class="string">&quot;resultPlaceholder&quot;</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fas fa-cloud-download-alt&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">p</span>&gt;</span>图片压缩后将显示在这里<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">p</span>&gt;</span>您可以直接下载压缩后的图片<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                        <span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">&quot;compressedImage&quot;</span> <span class="attr">class</span>=<span class="string">&quot;compressed-image&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;压缩后的图片&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">&quot;downloadLink&quot;</span> <span class="attr">class</span>=<span class="string">&quot;download-btn&quot;</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fas fa-download&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 下载压缩图片</span><br><span class="line">                        <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;response-area&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">&quot;response-title&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fas fa-comment-alt&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 处理状态<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;response-content&quot;</span> <span class="attr">id</span>=<span class="string">&quot;responseContent&quot;</span>&gt;</span></span><br><span class="line">                            等待上传图片...</span><br><span class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;info-card&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">h4</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fas fa-info-circle&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 使用说明<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span>上传图片后，通过滑块调整压缩质量（0%-100%）<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span>点击&quot;上传并压缩图片&quot;按钮进行处理<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span>压缩完成后，右侧会显示压缩后的图片<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span>点击&quot;下载压缩图片&quot;按钮保存结果<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">footer</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>免费在线图片压缩工具 © 2025 | <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.codeobservatory.cn&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span> <span class="attr">title</span>=<span class="string">&quot;码农观测站&quot;</span>&gt;</span>码农观测站<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br></pre></td><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    <span class="attribute">font-family</span>: <span class="string">&#x27;Segoe UI&#x27;</span>, Tahoma, Geneva, Verdana, sans-serif;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">135deg</span>, <span class="number">#1e3c72</span> <span class="number">0%</span>, <span class="number">#2a5298</span> <span class="number">100%</span>);</span><br><span class="line">    <span class="attribute">min-height</span>: <span class="number">100vh</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">1200px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.97</span>);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">20px</span> <span class="number">50px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.3</span>);</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">header</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to right, <span class="number">#1a2980</span>, <span class="number">#26d0ce</span>);</span><br><span class="line">    <span class="attribute">color</span>: white;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">30px</span> <span class="number">40px</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">header</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">        <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="attribute">position</span>: absolute;</span><br><span class="line">        <span class="attribute">top</span>: -<span class="number">50%</span>;</span><br><span class="line">        <span class="attribute">left</span>: -<span class="number">50%</span>;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">200%</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">200%</span>;</span><br><span class="line">        <span class="attribute">background</span>: <span class="built_in">radial-gradient</span>(circle, <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.15</span>) <span class="number">0%</span>, transparent <span class="number">70%</span>);</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">30deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">header</span> <span class="selector-tag">h1</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">2.5rem</span>;</span><br><span class="line">        <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span><br><span class="line">        <span class="attribute">display</span>: flex;</span><br><span class="line">        <span class="attribute">align-items</span>: center;</span><br><span class="line">        <span class="attribute">justify-content</span>: center;</span><br><span class="line">        <span class="attribute">gap</span>: <span class="number">15px</span>;</span><br><span class="line">        <span class="attribute">position</span>: relative;</span><br><span class="line">        <span class="attribute">text-shadow</span>: <span class="number">0</span> <span class="number">2px</span> <span class="number">4px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">header</span> <span class="selector-tag">p</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">1.2rem</span>;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0.9</span>;</span><br><span class="line">        <span class="attribute">max-width</span>: <span class="number">700px</span>;</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">15px</span> auto <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">position</span>: relative;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.content</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">flex-wrap</span>: wrap;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.upload-section</span> &#123;</span><br><span class="line">    <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">350px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">40px</span>;</span><br><span class="line">    <span class="attribute">border-right</span>: <span class="number">1px</span> solid <span class="number">#eee</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.result-section</span> &#123;</span><br><span class="line">    <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">350px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">40px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#f9f9ff</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.section-title</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1.6rem</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">25px</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">gap</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">padding-bottom</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.section-title</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">        <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="attribute">position</span>: absolute;</span><br><span class="line">        <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">50px</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">3px</span>;</span><br><span class="line">        <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to right, <span class="number">#1a2980</span>, <span class="number">#26d0ce</span>);</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">3px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.section-title</span> <span class="selector-tag">i</span> &#123;</span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#1a2980</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.upload-area</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">3px</span> dashed <span class="number">#1a2980</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">40px</span> <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.3s</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#f0f4ff</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">25px</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.upload-area</span><span class="selector-pseudo">:hover</span>, <span class="selector-class">.upload-area</span><span class="selector-class">.dragover</span> &#123;</span><br><span class="line">        <span class="attribute">background-color</span>: <span class="number">#e6ebff</span>;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">5px</span>);</span><br><span class="line">        <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">10px</span> <span class="number">25px</span> <span class="built_in">rgba</span>(<span class="number">26</span>, <span class="number">41</span>, <span class="number">128</span>, <span class="number">0.2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.upload-area</span> <span class="selector-tag">i</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">4.5rem</span>;</span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#1a2980</span>;</span><br><span class="line">        <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0.8</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.upload-area</span> <span class="selector-tag">h3</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">1.5rem</span>;</span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#444</span>;</span><br><span class="line">        <span class="attribute">margin-bottom</span>: <span class="number">15px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.upload-area</span> <span class="selector-tag">p</span> &#123;</span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#666</span>;</span><br><span class="line">        <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">1.05rem</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.browse-btn</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to right, <span class="number">#1a2980</span> <span class="number">0%</span>, <span class="number">#26d0ce</span> <span class="number">100%</span>);</span><br><span class="line">    <span class="attribute">color</span>: white;</span><br><span class="line">    <span class="attribute">border</span>: none;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">13px</span> <span class="number">35px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1.1rem</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.3s</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">5px</span> <span class="number">15px</span> <span class="built_in">rgba</span>(<span class="number">26</span>, <span class="number">41</span>, <span class="number">128</span>, <span class="number">0.3</span>);</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.browse-btn</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">3px</span>);</span><br><span class="line">        <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">20px</span> <span class="built_in">rgba</span>(<span class="number">26</span>, <span class="number">41</span>, <span class="number">128</span>, <span class="number">0.4</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.browse-btn</span><span class="selector-pseudo">:active</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">1px</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.browse-btn</span><span class="selector-class">.refresh</span> &#123;</span><br><span class="line">        <span class="attribute">position</span>: absolute;</span><br><span class="line">        <span class="attribute">top</span>: <span class="number">40px</span>;</span><br><span class="line">        <span class="attribute">right</span>: <span class="number">40px</span>;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">7px</span> <span class="number">25px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.file-input</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.preview-container</span> &#123;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.preview-title</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1.3rem</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#555</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">gap</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.image-preview</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">max-height</span>: <span class="number">220px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">20px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.12</span>);</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto <span class="number">25px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#eee</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.image-preview</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">        <span class="attribute">object-fit</span>: contain;</span><br><span class="line">        <span class="attribute">background</span>: <span class="number">#f8f8f8</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.compression-control</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: white;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">25px</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">4px</span> <span class="number">15px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.08</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.quality-label</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: space-between;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1.1rem</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#444</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.quality-value</span> &#123;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">700</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#1a2980</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1.2rem</span>;</span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">45px</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: right;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.slider-container</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">40px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.quality-slider</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">10px</span>;</span><br><span class="line">    -webkit-<span class="attribute">appearance</span>: none;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to right, <span class="number">#ff416c</span>, <span class="number">#ff4b2b</span>, <span class="number">#ff9500</span>, <span class="number">#ffcc00</span>, <span class="number">#a8e063</span>, <span class="number">#56ab2f</span>);</span><br><span class="line">    <span class="attribute">outline</span>: none;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.quality-slider</span>::-webkit-slider-thumb &#123;</span><br><span class="line">        -webkit-<span class="attribute">appearance</span>: none;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">25px</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">25px</span>;</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">        <span class="attribute">background</span>: <span class="number">#1a2980</span>;</span><br><span class="line">        <span class="attribute">cursor</span>: pointer;</span><br><span class="line">        <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">2px</span> <span class="number">10px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.2</span>);</span><br><span class="line">        <span class="attribute">border</span>: <span class="number">3px</span> solid white;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.quality-slider</span>::-moz-range-thumb &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">25px</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">25px</span>;</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">        <span class="attribute">background</span>: <span class="number">#1a2980</span>;</span><br><span class="line">        <span class="attribute">cursor</span>: pointer;</span><br><span class="line">        <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">2px</span> <span class="number">10px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.2</span>);</span><br><span class="line">        <span class="attribute">border</span>: <span class="number">3px</span> solid white;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.slider-ticks</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: space-between;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">0.85rem</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#777</span>;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.upload-btn</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to right, <span class="number">#00c853</span> <span class="number">0%</span>, <span class="number">#64dd17</span> <span class="number">100%</span>);</span><br><span class="line">    <span class="attribute">color</span>: white;</span><br><span class="line">    <span class="attribute">border</span>: none;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1.2rem</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.3s</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">6px</span> <span class="number">18px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">200</span>, <span class="number">83</span>, <span class="number">0.3</span>);</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.upload-btn</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">3px</span>);</span><br><span class="line">        <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">9px</span> <span class="number">22px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">200</span>, <span class="number">83</span>, <span class="number">0.4</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.upload-btn</span><span class="selector-pseudo">:disabled</span> &#123;</span><br><span class="line">        <span class="attribute">background</span>: <span class="number">#cccccc</span>;</span><br><span class="line">        <span class="attribute">cursor</span>: not-allowed;</span><br><span class="line">        <span class="attribute">transform</span>: none;</span><br><span class="line">        <span class="attribute">box-shadow</span>: none;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.progress-container</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#e0e0e0</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">20px</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.progress-bar</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to right, <span class="number">#1a2980</span> <span class="number">0%</span>, <span class="number">#26d0ce</span> <span class="number">100%</span>);</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0%</span>;</span><br><span class="line">    <span class="attribute">transition</span>: width <span class="number">0.4s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.comparison-container</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: space-around;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">25px</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">gap</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.comparison-item</span> &#123;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">background</span>: white;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">20px</span> <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">4px</span> <span class="number">12px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.08</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.comparison-item</span> <span class="selector-tag">h4</span> &#123;</span><br><span class="line">        <span class="attribute">margin-bottom</span>: <span class="number">12px</span>;</span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#555</span>;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">1.15rem</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.size-info</span> &#123;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">700</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1.3rem</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#1a2980</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.api-info</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#e3f2fd</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">font-family</span>: monospace;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">0.95rem</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#1a2980</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">footer</span> &#123;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">25px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#666</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#f5f5f5</span>;</span><br><span class="line">    <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#eee</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1.05rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.result-container</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: white;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">25px</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">7px</span> <span class="number">20px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.07</span>);</span><br><span class="line">    <span class="attribute">min-height</span>: <span class="number">180px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#f0f0f0</span>;</span><br><span class="line">    <span class="attribute">flex-grow</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.result-content</span> &#123;</span><br><span class="line">    <span class="attribute">flex-grow</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.compressed-image</span> &#123;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">max-height</span>: <span class="number">250px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">5px</span> <span class="number">15px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.1</span>);</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">25px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#eee</span>;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.download-btn</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to right, <span class="number">#1a2980</span> <span class="number">0%</span>, <span class="number">#26d0ce</span> <span class="number">100%</span>);</span><br><span class="line">    <span class="attribute">color</span>: white;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">14px</span> <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1.1rem</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">text-decoration</span>: none;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.3s</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">5px</span> <span class="number">15px</span> <span class="built_in">rgba</span>(<span class="number">26</span>, <span class="number">41</span>, <span class="number">128</span>, <span class="number">0.3</span>);</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">gap</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.download-btn</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">3px</span>);</span><br><span class="line">        <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">20px</span> <span class="built_in">rgba</span>(<span class="number">26</span>, <span class="number">41</span>, <span class="number">128</span>, <span class="number">0.4</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.info-card</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: white;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">25px</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">7px</span> <span class="number">20px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.07</span>);</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#f0f0f0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.info-card</span> <span class="selector-tag">h4</span> &#123;</span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#1a2980</span>;</span><br><span class="line">        <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">1.3rem</span>;</span><br><span class="line">        <span class="attribute">display</span>: flex;</span><br><span class="line">        <span class="attribute">align-items</span>: center;</span><br><span class="line">        <span class="attribute">gap</span>: <span class="number">12px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.info-card</span> <span class="selector-tag">ul</span> &#123;</span><br><span class="line">        <span class="attribute">list-style-type</span>: none;</span><br><span class="line">        <span class="attribute">padding-left</span>: <span class="number">5px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.info-card</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line">        <span class="attribute">margin-bottom</span>: <span class="number">14px</span>;</span><br><span class="line">        <span class="attribute">padding-left</span>: <span class="number">32px</span>;</span><br><span class="line">        <span class="attribute">position</span>: relative;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">1.05rem</span>;</span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#555</span>;</span><br><span class="line">        <span class="attribute">line-height</span>: <span class="number">1.5</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.info-card</span> <span class="selector-tag">li</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">            <span class="attribute">content</span>: <span class="string">&quot;•&quot;</span>;</span><br><span class="line">            <span class="attribute">color</span>: <span class="number">#1a2980</span>;</span><br><span class="line">            <span class="attribute">font-size</span>: <span class="number">2rem</span>;</span><br><span class="line">            <span class="attribute">position</span>: absolute;</span><br><span class="line">            <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">            <span class="attribute">top</span>: -<span class="number">8px</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.response-area</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: white;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">25px</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">7px</span> <span class="number">20px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.07</span>);</span><br><span class="line">    <span class="attribute">min-height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#f0f0f0</span>;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.response-title</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#1a2980</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1.3rem</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">gap</span>: <span class="number">12px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.response-content</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1.1rem</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">1.6</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#555</span>;</span><br><span class="line">    <span class="attribute">min-height</span>: <span class="number">60px</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>:<span class="number">20px</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">header</span> &#123;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">30px</span> <span class="number">20px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.content</span> &#123;</span><br><span class="line">        <span class="attribute">flex-direction</span>: column;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.upload-section</span> &#123;</span><br><span class="line">        <span class="attribute">border-right</span>: none;</span><br><span class="line">        <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#eee</span>;</span><br><span class="line">        <span class="attribute">padding</span>:<span class="number">20px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.result-section</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>:<span class="number">20px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">header</span> <span class="selector-tag">h1</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">2rem</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">header</span> <span class="selector-tag">p</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">1rem</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.browse-btn</span><span class="selector-class">.refresh</span> &#123;</span><br><span class="line">    <span class="attribute">top</span>:<span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">right</span>:<span class="number">20px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">a</span><span class="selector-class">.browse-btn</span><span class="selector-class">.refresh</span> &#123;</span><br><span class="line">    <span class="attribute">right</span>:<span class="number">130px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.success-message</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#00c853</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.error-message</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#f44336</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.result-placeholder</span> &#123;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#777</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1.1rem</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">40px</span> <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.result-placeholder</span> <span class="selector-tag">i</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">4rem</span>;</span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#e0e0e0</span>;</span><br><span class="line">        <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line">document.addEventListener(&#x27;DOMContentLoaded&#x27;, function () &#123;</span><br><span class="line">    const uploadArea = document.getElementById(&#x27;uploadArea&#x27;);</span><br><span class="line">    const fileInput = document.getElementById(&#x27;fileInput&#x27;);</span><br><span class="line">    const uploadBtn = document.getElementById(&#x27;uploadBtn&#x27;);</span><br><span class="line">    const imagePreview = document.getElementById(&#x27;imagePreview&#x27;);</span><br><span class="line">    const previewImage = document.getElementById(&#x27;previewImage&#x27;);</span><br><span class="line">    const responseContent = document.getElementById(&#x27;responseContent&#x27;);</span><br><span class="line">    const progressContainer = document.getElementById(&#x27;progressContainer&#x27;);</span><br><span class="line">    const progressBar = document.getElementById(&#x27;progressBar&#x27;);</span><br><span class="line">    const originalSize = document.getElementById(&#x27;originalSize&#x27;);</span><br><span class="line">    const compressedSize = document.getElementById(&#x27;compressedSize&#x27;);</span><br><span class="line">    const qualitySlider = document.getElementById(&#x27;qualitySlider&#x27;);</span><br><span class="line">    const qualityValue = document.getElementById(&#x27;qualityValue&#x27;);</span><br><span class="line">    const compressedImage = document.getElementById(&#x27;compressedImage&#x27;);</span><br><span class="line">    const downloadLink = document.getElementById(&#x27;downloadLink&#x27;);</span><br><span class="line">    const resultPlaceholder = document.getElementById(&#x27;resultPlaceholder&#x27;);</span><br><span class="line"></span><br><span class="line">    // 压缩质量滑块事件</span><br><span class="line">    qualitySlider.addEventListener(&#x27;input&#x27;, function () &#123;</span><br><span class="line">        qualityValue.textContent = this.value + &#x27;%&#x27;;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    // 点击上传区域触发文件选择</span><br><span class="line">    uploadArea.addEventListener(&#x27;click&#x27;, () =&gt; &#123;</span><br><span class="line">        fileInput.click();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    // 拖放功能</span><br><span class="line">    [&#x27;dragenter&#x27;, &#x27;dragover&#x27;, &#x27;dragleave&#x27;, &#x27;drop&#x27;].forEach(eventName =&gt; &#123;</span><br><span class="line">        uploadArea.addEventListener(eventName, preventDefaults, false);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    function preventDefaults(e) &#123;</span><br><span class="line">        e.preventDefault();</span><br><span class="line">        e.stopPropagation();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [&#x27;dragenter&#x27;, &#x27;dragover&#x27;].forEach(eventName =&gt; &#123;</span><br><span class="line">        uploadArea.addEventListener(eventName, highlight, false);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    [&#x27;dragleave&#x27;, &#x27;drop&#x27;].forEach(eventName =&gt; &#123;</span><br><span class="line">        uploadArea.addEventListener(eventName, unhighlight, false);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    function highlight() &#123;</span><br><span class="line">        uploadArea.classList.add(&#x27;dragover&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function unhighlight() &#123;</span><br><span class="line">        uploadArea.classList.remove(&#x27;dragover&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 处理文件放置</span><br><span class="line">    uploadArea.addEventListener(&#x27;drop&#x27;, handleDrop, false);</span><br><span class="line"></span><br><span class="line">    function handleDrop(e) &#123;</span><br><span class="line">        const dt = e.dataTransfer;</span><br><span class="line">        const files = dt.files;</span><br><span class="line">        if (files.length) &#123;</span><br><span class="line">            handleFiles(files);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 处理文件选择</span><br><span class="line">    fileInput.addEventListener(&#x27;change&#x27;, function () &#123;</span><br><span class="line">        if (this.files.length) &#123;</span><br><span class="line">            handleFiles(this.files);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    // 处理选中的文件</span><br><span class="line">    function handleFiles(files) &#123;</span><br><span class="line">        const file = files[0];</span><br><span class="line">        if (!file.type.match(&#x27;image.*&#x27;)) &#123;</span><br><span class="line">            responseContent.innerHTML = &#x27;&lt;span class=&quot;error-message&quot;&gt;错误：请选择图片文件（JPG, PNG, GIF, WEBP）&lt;/span&gt;&#x27;;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // 重置结果区域</span><br><span class="line">        compressedImage.style.display = &#x27;none&#x27;;</span><br><span class="line">        downloadLink.style.display = &#x27;none&#x27;;</span><br><span class="line">        resultPlaceholder.style.display = &#x27;block&#x27;;</span><br><span class="line"></span><br><span class="line">        // 显示预览</span><br><span class="line">        const reader = new FileReader();</span><br><span class="line">        reader.onload = function (e) &#123;</span><br><span class="line">            previewImage.src = e.target.result;</span><br><span class="line">            imagePreview.style.display = &#x27;block&#x27;;</span><br><span class="line">            uploadBtn.style.display = &#x27;block&#x27;;</span><br><span class="line">            uploadBtn.disabled = false;</span><br><span class="line">        &#125;;</span><br><span class="line">        reader.readAsDataURL(file);</span><br><span class="line"></span><br><span class="line">        // 更新响应内容</span><br><span class="line">        responseContent.innerHTML = &#x27;&lt;span class=&quot;success-message&quot;&gt;图片已选择，点击&quot;上传并压缩图片&quot;按钮开始处理...&lt;/span&gt;&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 上传按钮点击事件</span><br><span class="line">    uploadBtn.addEventListener(&#x27;click&#x27;, function () &#123;</span><br><span class="line">        if (!fileInput.files.length) return;</span><br><span class="line"></span><br><span class="line">        const file = fileInput.files[0];</span><br><span class="line">        const quality = parseInt(qualitySlider.value);</span><br><span class="line">        const formData = new FormData();</span><br><span class="line">        formData.append(&#x27;imageFile&#x27;, file);</span><br><span class="line">        formData.append(&#x27;compressionQuality&#x27;, quality);</span><br><span class="line"></span><br><span class="line">        // 显示进度条</span><br><span class="line">        progressContainer.style.display = &#x27;block&#x27;;</span><br><span class="line">        progressBar.style.width = &#x27;0%&#x27;;</span><br><span class="line"></span><br><span class="line">        // 禁用上传按钮</span><br><span class="line">        uploadBtn.disabled = true;</span><br><span class="line">        uploadBtn.textContent = &#x27;处理中...&#x27;;</span><br><span class="line">        uploadBtn.style.background = &#x27;linear-gradient(to right, #ff9800 0%, #ff5722 100%)&#x27;;</span><br><span class="line"></span><br><span class="line">        // 更新响应内容</span><br><span class="line">        responseContent.innerHTML = &#x27;&lt;span class=&quot;success-message&quot;&gt;正在上传并压缩图片，请稍候...&lt;/span&gt;&#x27;;</span><br><span class="line"></span><br><span class="line">        // 模拟进度更新</span><br><span class="line">        const progressInterval = setInterval(() =&gt; &#123;</span><br><span class="line">            const currentWidth = parseInt(progressBar.style.width) || 0;</span><br><span class="line">            if (currentWidth &lt; 90) &#123;</span><br><span class="line">                progressBar.style.width = (currentWidth + 10) + &#x27;%&#x27;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, 300);</span><br><span class="line"></span><br><span class="line">        // 发送请求到API</span><br><span class="line">        fetch(&#x27;/api/yourapiname&#x27;, &#123;</span><br><span class="line">            method: &#x27;POST&#x27;,</span><br><span class="line">            body: formData</span><br><span class="line">        &#125;)</span><br><span class="line">            .then(response =&gt; &#123;</span><br><span class="line">                debugger</span><br><span class="line">                clearInterval(progressInterval);</span><br><span class="line">                progressBar.style.width = &#x27;100%&#x27;;</span><br><span class="line"></span><br><span class="line">                if (response.ok) &#123;</span><br><span class="line">                    return response.blob();</span><br><span class="line">                &#125; else if (response.status === 400) &#123;</span><br><span class="line">                    return response.text().then(text =&gt; &#123;</span><br><span class="line">                        throw new Error(text || &#x27;无效请求&#x27;);</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    throw new Error(`请求失败，状态码: $&#123;response.status&#125;`);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            .then(blob =&gt; &#123;</span><br><span class="line">                // 创建压缩图片的URL</span><br><span class="line">                const compressedUrl = URL.createObjectURL(blob);</span><br><span class="line"></span><br><span class="line">                // 显示压缩后的图片</span><br><span class="line">                compressedImage.src = compressedUrl;</span><br><span class="line">                compressedImage.style.display = &#x27;block&#x27;;</span><br><span class="line"></span><br><span class="line">                // 设置下载链接</span><br><span class="line">                downloadLink.href = compressedUrl;</span><br><span class="line">                downloadLink.download = `compressed_$&#123;fileInput.files[0].name&#125;`;</span><br><span class="line">                downloadLink.style.display = &#x27;inline-block&#x27;;</span><br><span class="line"></span><br><span class="line">                // 隐藏占位符</span><br><span class="line">                resultPlaceholder.style.display = &#x27;none&#x27;;</span><br><span class="line"></span><br><span class="line">                // 更新UI</span><br><span class="line">                setTimeout(() =&gt; &#123;</span><br><span class="line">                    responseContent.innerHTML = &#x27;&lt;span class=&quot;success-message&quot;&gt;图片压缩成功！可下载压缩后的图片&lt;/span&gt;&#x27;;</span><br><span class="line">                    uploadBtn.textContent = &#x27;上传成功！&#x27;;</span><br><span class="line">                    uploadBtn.style.background = &#x27;linear-gradient(to right, #00c853 0%, #64dd17 100%)&#x27;;</span><br><span class="line">                &#125;, 500);</span><br><span class="line">            &#125;)</span><br><span class="line">            .catch(error =&gt; &#123;</span><br><span class="line">                clearInterval(progressInterval);</span><br><span class="line">                progressBar.style.backgroundColor = &#x27;#f44336&#x27;;</span><br><span class="line">                responseContent.innerHTML = `&lt;span class=&quot;error-message&quot;&gt;错误: $&#123;error.message&#125;&lt;/span&gt;`;</span><br><span class="line">                uploadBtn.textContent = &#x27;上传失败，重试&#x27;;</span><br><span class="line">                uploadBtn.disabled = false;</span><br><span class="line">                uploadBtn.style.background = &#x27;linear-gradient(to right, #f44336 0%, #e91e63 100%)&#x27;;</span><br><span class="line">            &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;大家好，这里是码农观测站，我是码农刚子。前几天填写备案资料时需要上传营业执照，要求2MB以内，老板发给我的文件有十几MB，无法上传，用网上的在线工具，又担心安全性。以前也经常遇到需要图片太大的问题，基本上都是找别人用vip办公软件处理的，每次都要麻烦别人，于是我就想着自己做</summary>
      
    
    
    
    <category term="技术分享" scheme="https://www.codeobservatory.cn/categories/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/"/>
    
    
    <category term="HTML" scheme="https://www.codeobservatory.cn/tags/HTML/"/>
    
    <category term="JavaScript" scheme="https://www.codeobservatory.cn/tags/JavaScript/"/>
    
    <category term="图片压缩" scheme="https://www.codeobservatory.cn/tags/%E5%9B%BE%E7%89%87%E5%8E%8B%E7%BC%A9/"/>
    
  </entry>
  
  <entry>
    <title>Asp.Net通过dom-to-image.js将HTML中标签div内的内容转化为图片保存到本地</title>
    <link href="https://www.codeobservatory.cn/archives/8b3118e9.html"/>
    <id>https://www.codeobservatory.cn/archives/8b3118e9.html</id>
    <published>2025-06-18T02:17:59.000Z</published>
    <updated>2025-06-18T02:30:52.790Z</updated>
    
    <content type="html"><![CDATA[<p>最近在开发一个手机商城结算系统，需要用到推广分享海报页面，代理生成自己的分享页面保存到本地，也分享给大家：</p><h2 id="1、引入几个JS库"><a href="#1、引入几个JS库" class="headerlink" title="1、引入几个JS库"></a>1、引入几个JS库</h2><ol><li>：<code>jquery</code> 版本还没试过我用的是1.9.1 （不贴链接了，这个要找很容易）</li><li>：<code>dom-to-image.js</code> （点击下载 下载下来解压开在src目录里面）</li><li>：<code>FileSaver.js</code> （点击下载 下载下来解压开在src目录里面）</li></ol><h2 id="2、新建HTML引入第一步中的几个库"><a href="#2、新建HTML引入第一步中的几个库" class="headerlink" title="2、新建HTML引入第一步中的几个库"></a>2、新建HTML引入第一步中的几个库</h2><p><img src="https://images.codeobservatory.cn/hexo/202506/18/3bb79995bc95549c.png" alt="Asp.Net通过dom-to-image.js将HTML中标签div内的内容转化为图片保存到本地"></p><h2 id="3、生成图片"><a href="#3、生成图片" class="headerlink" title="3、生成图片"></a>3、生成图片</h2><h3 id="3-1、生成png图片"><a href="#3-1、生成png图片" class="headerlink" title="3.1、生成png图片"></a>3.1、生成png图片</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">var</span> jd= <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;标签ID&#x27;</span>);</span><br><span class="line">domtoimage.<span class="title function_">toPng</span>(jd)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">url</span>) &#123;&lt;!-- --&gt;</span><br><span class="line">        <span class="keyword">var</span> img = <span class="keyword">new</span> <span class="title class_">Image</span>();</span><br><span class="line">        img.<span class="property">src</span> = url;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(img);</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="keyword">function</span> (<span class="params">e</span>) &#123;&lt;!-- --&gt;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;生成图片出错&#x27;</span>, e);</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="3-2、生成下载图片"><a href="#3-2、生成下载图片" class="headerlink" title="3.2、生成下载图片"></a>3.2、生成下载图片</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//保存图片</span></span><br><span class="line">$(<span class="string">&quot;#btnToImg&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;&lt;!-- --&gt;</span><br><span class="line"> domtoimage.<span class="title function_">toBlob</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;chartdiv&#x27;</span>))</span><br><span class="line"> .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">blob</span>) &#123;&lt;!-- --&gt;</span><br><span class="line"> <span class="variable language_">window</span>.<span class="title function_">saveAs</span>(blob, <span class="string">&#x27;ImgName.jpg&#x27;</span>);</span><br><span class="line"> &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="3-3、生成jpeg图片"><a href="#3-3、生成jpeg图片" class="headerlink" title="3.3、生成jpeg图片"></a>3.3、生成jpeg图片</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">domtoimage.<span class="title function_">toJpeg</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;chartdiv&#x27;</span>), &#123;&lt;!-- --&gt; <span class="attr">quality</span>: <span class="number">0.95</span> &#125;)</span><br><span class="line">     .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">dataUrl</span>) &#123;&lt;!-- --&gt;</span><br><span class="line">     <span class="keyword">var</span> link = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">     link.<span class="property">download</span> = <span class="string">&#x27;Imgname.jpeg&#x27;</span>;</span><br><span class="line">     link.<span class="property">href</span> = dataUrl;</span><br><span class="line">     link.<span class="title function_">click</span>();</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure><p>使用的时候只要调方法就可以了    </p><p><strong>直接贴上Demo源码</strong>:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;js/jquery-1.9.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/dom-to-image.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/FileSaver.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-100&quot;</span> <span class="attr">id</span>=<span class="string">&quot;savePoster&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../images/rec-bg.jpg&quot;</span> <span class="attr">class</span>=<span class="string">&quot;img&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../upload/202212090409407676.png&quot;</span> <span class="attr">class</span>=<span class="string">&quot;usertouxiang&quot;</span> <span class="attr">id</span>=<span class="string">&quot;usertouxiang&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;头像&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;divCode&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ew&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;WeixinPay/MakeQRCode.aspx?data=473_375_473&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;regist.html?id=473<span class="symbol">&amp;amp;</span>marketId=375<span class="symbol">&amp;amp;</span>organizeId=473&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;name&quot;</span>&gt;</span>vinnie（1XXXXXXX554）<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">onclick</span>=<span class="string">&quot;savePic(this)&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color: #fff;background: red;margin: 0.5rem 3rem;padding: 5px 0px;border-radius: 5px;&quot;</span>&gt;</span>保存该二维码<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">//获取当前时间格式化</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">formatDate</span>(<span class="params">date</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> year = date.<span class="title function_">getFullYear</span>()</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> month = <span class="variable language_">this</span>.<span class="title function_">format</span>(date.<span class="title function_">getMonth</span>() + <span class="number">1</span>)</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> da = <span class="variable language_">this</span>.<span class="title function_">format</span>(date.<span class="title function_">getDate</span>())</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> h = <span class="variable language_">this</span>.<span class="title function_">format</span>(date.<span class="title function_">getHours</span>())</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> m = <span class="variable language_">this</span>.<span class="title function_">format</span>(date.<span class="title function_">getMinutes</span>())</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> s = <span class="variable language_">this</span>.<span class="title function_">format</span>(date.<span class="title function_">getSeconds</span>())</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> year + month + da + h + m + s;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//return year + &#x27;-&#x27; + month + &#x27;-&#x27; + da</span></span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">format</span>(<span class="params">val</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> <span class="title class_">Number</span>(val) &lt; <span class="number">10</span> ? <span class="string">&#x27;0&#x27;</span> + val : <span class="string">&#x27;&#x27;</span> + val</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"><span class="comment">//保存到相册</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">savePic</span>(<span class="params">obj</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  $(obj).<span class="title function_">remove</span>();</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 下载png图片</span></span></span><br><span class="line"><span class="language-javascript">  domtoimage.<span class="title function_">toBlob</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;savePoster&#x27;</span>))</span></span><br><span class="line"><span class="language-javascript">  .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">blob</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">window</span>.<span class="title function_">saveAs</span>(blob, <span class="string">&#x27;share&#x27;</span> + <span class="title function_">formatDate</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()) + <span class="string">&#x27;.png&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">window</span>.<span class="property">location</span>.<span class="title function_">reload</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="4、效果图："><a href="#4、效果图：" class="headerlink" title="4、效果图："></a>4、效果图：</h2><p><img src="https://images.codeobservatory.cn/hexo/202506/18/8c182049a60f850.png" alt="Asp.Net通过dom-to-image.js将HTML中标签div内的内容转化为图片保存到本地"></p><h2 id="5、domtoimage—-将指定页面生成图片"><a href="#5、domtoimage—-将指定页面生成图片" class="headerlink" title="5、domtoimage—-将指定页面生成图片"></a>5、domtoimage—-将指定页面生成图片</h2><h3 id="5-1、下载jquery-min-js、dom-to-image-js、FileSaver-js"><a href="#5-1、下载jquery-min-js、dom-to-image-js、FileSaver-js" class="headerlink" title="5.1、下载jquery.min.js、dom-to-image.js、FileSaver.js"></a>5.1、下载<code>jquery.min.js</code>、<code>dom-to-image.js</code>、<code>FileSaver.js</code></h3><blockquote><p>FileSaver.js文件百度网盘地址：<br>    链接：<a href="https://pan.baidu.com/s/1W_g2azndSt7yNqQbJGpnbQ">https://pan.baidu.com/s/1W_g2azndSt7yNqQbJGpnbQ</a><br>    提取码：iklw<br>dom-to-image.js文件百度网盘地址：<br>        链接：<a href="https://pan.baidu.com/s/1sCwDb065585DfF9GmF6zEA">https://pan.baidu.com/s/1sCwDb065585DfF9GmF6zEA</a><br>        提取码：2up2</p></blockquote><h2 id="6、跨域问题"><a href="#6、跨域问题" class="headerlink" title="6、跨域问题"></a>6、跨域问题</h2><p>如果页面中有图片引入，那么就需要考虑跨域问题，我使用的是iis，只需要在根目录添加web.config文件即可</p><ol><li><p>新建一个txt</p></li><li><p>把下面代码写入到文件里</p></li><li><p>文件和后缀名改成 web.config</p></li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">system.webServer</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">httpProtocol</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">customHeaders</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">&quot;Access-Control-Allow-Origin&quot;</span> <span class="attr">value</span>=<span class="string">&quot;*&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">&quot;Access-Control-Allow-Methods&quot;</span> <span class="attr">value</span>=<span class="string">&quot;GET, POST, PUT, DELETE, OPTIONS&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">&quot;Access-Control-Allow-Headers&quot;</span> <span class="attr">value</span>=<span class="string">&quot;AuthToken, Content-Type, Accept, X-Requested-With&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">customHeaders</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">httpProtocol</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">system.webServer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>传送门：<a href="/archives/1e7ac72f.html">解决nginx跨域问题</a></p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;最近在开发一个手机商城结算系统，需要用到推广分享海报页面，代理生成自己的分享页面保存到本地，也分享给大家：&lt;/p&gt;
&lt;h2 id=&quot;1、引入几个JS库&quot;&gt;&lt;a href=&quot;#1、引入几个JS库&quot; class=&quot;headerlink&quot; title=&quot;1、引入几个JS库&quot;&gt;&lt;/</summary>
      
    
    
    
    <category term="前端开发" scheme="https://www.codeobservatory.cn/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="HTML" scheme="https://www.codeobservatory.cn/tags/HTML/"/>
    
  </entry>
  
  <entry>
    <title>解决nginx跨域问题</title>
    <link href="https://www.codeobservatory.cn/archives/1e7ac72f.html"/>
    <id>https://www.codeobservatory.cn/archives/1e7ac72f.html</id>
    <published>2025-06-18T02:12:42.000Z</published>
    <updated>2025-06-18T02:15:51.415Z</updated>
    
    <content type="html"><![CDATA[<ol><li><p>编辑nginx.conf文件 </p></li><li><p>修改如下代码：</p></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;&lt;!-- --&gt;</span><br><span class="line">            root   html;</span><br><span class="line">            index  index.html index.htm index.php;</span><br><span class="line">            add_header <span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span> *;</span><br><span class="line">            add_header <span class="string">&#x27;Access-Control-Allow-Credentials&#x27;</span> <span class="string">&#x27;true&#x27;</span>;</span><br><span class="line">            add_header <span class="string">&#x27;Access-Control-Allow-Methods&#x27;</span> <span class="string">&#x27;GET, POST, OPTIONS&#x27;</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>重启nginx：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -s reload</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;编辑nginx.conf文件 &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;修改如下代码：&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span</summary>
      
    
    
    
    <category term="技术分享" scheme="https://www.codeobservatory.cn/categories/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/"/>
    
    
    <category term="跨域" scheme="https://www.codeobservatory.cn/tags/%E8%B7%A8%E5%9F%9F/"/>
    
    <category term="nginx" scheme="https://www.codeobservatory.cn/tags/nginx/"/>
    
  </entry>
  
  <entry>
    <title>解决iis跨域问题</title>
    <link href="https://www.codeobservatory.cn/archives/b9f87be3.html"/>
    <id>https://www.codeobservatory.cn/archives/b9f87be3.html</id>
    <published>2025-06-18T02:09:42.000Z</published>
    <updated>2025-06-18T02:11:39.036Z</updated>
    
    <content type="html"><![CDATA[<h2 id="站点根目录的配置文件设置"><a href="#站点根目录的配置文件设置" class="headerlink" title="站点根目录的配置文件设置"></a>站点根目录的配置文件设置</h2><ol><li><p>新建一个txt</p></li><li><p>把下面代码写入到文件里</p></li><li><p>文件和后缀名改成 web.config</p></li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">system.webServer</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">httpProtocol</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">customHeaders</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">&quot;Access-Control-Allow-Origin&quot;</span> <span class="attr">value</span>=<span class="string">&quot;*&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">&quot;Access-Control-Allow-Methods&quot;</span> <span class="attr">value</span>=<span class="string">&quot;GET, POST, PUT, DELETE, OPTIONS&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">&quot;Access-Control-Allow-Headers&quot;</span> <span class="attr">value</span>=<span class="string">&quot;AuthToken, Content-Type, Accept, X-Requested-With&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">customHeaders</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">httpProtocol</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">system.webServer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;站点根目录的配置文件设置&quot;&gt;&lt;a href=&quot;#站点根目录的配置文件设置&quot; class=&quot;headerlink&quot; title=&quot;站点根目录的配置文件设置&quot;&gt;&lt;/a&gt;站点根目录的配置文件设置&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;新建一个txt&lt;/p&gt;
&lt;/li&gt;
&lt;li</summary>
      
    
    
    
    <category term="技术分享" scheme="https://www.codeobservatory.cn/categories/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/"/>
    
    
    <category term="IIS" scheme="https://www.codeobservatory.cn/tags/IIS/"/>
    
    <category term="跨域" scheme="https://www.codeobservatory.cn/tags/%E8%B7%A8%E5%9F%9F/"/>
    
  </entry>
  
  <entry>
    <title>HTML5实现签到功能，项目实战之基于JavaScript实现每日签到打卡送积分功能</title>
    <link href="https://www.codeobservatory.cn/archives/7f915cdc.html"/>
    <id>https://www.codeobservatory.cn/archives/7f915cdc.html</id>
    <published>2025-06-18T02:00:11.000Z</published>
    <updated>2025-06-18T02:06:18.582Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、核心代码：calendar-js"><a href="#一、核心代码：calendar-js" class="headerlink" title="一、核心代码：calendar.js"></a>一、核心代码：calendar.js</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> calUtil = &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//当前日历显示的年份</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">showYear</span>: <span class="number">2018</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//当前日历显示的月份</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">showMonth</span>: <span class="number">1</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//当前日历显示的天数</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">showDays</span>: <span class="number">1</span>,</span><br><span class="line"></span><br><span class="line">    <span class="attr">eventName</span>: <span class="string">&quot;load&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//初始化日历</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">init</span>: <span class="keyword">function</span>(<span class="params">signList</span>) &#123;</span><br><span class="line"></span><br><span class="line">        calUtil.<span class="title function_">setMonthAndDay</span>();</span><br><span class="line"></span><br><span class="line">        calUtil.<span class="title function_">draw</span>(signList);</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">draw</span>: <span class="keyword">function</span>(<span class="params">signList</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//绑定日历</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> str = calUtil.<span class="title function_">drawCal</span>(calUtil.<span class="property">showYear</span>, calUtil.<span class="property">showMonth</span>, signList);</span><br><span class="line"></span><br><span class="line">        $(<span class="string">&quot;#calendar&quot;</span>).<span class="title function_">html</span>(str);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//绑定日历表头</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> calendarName = calUtil.<span class="property">showYear</span> + <span class="string">&quot;年&quot;</span> + calUtil.<span class="property">showMonth</span> + <span class="string">&quot;月&quot;</span>;</span><br><span class="line"></span><br><span class="line">        $(<span class="string">&quot;.calendar_month_span&quot;</span>).<span class="title function_">html</span>(calendarName);</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取当前选择的年月</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">setMonthAndDay</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (calUtil.<span class="property">eventName</span>) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;load&quot;</span>:</span><br><span class="line"></span><br><span class="line">                <span class="keyword">var</span> current = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"></span><br><span class="line">                calUtil.<span class="property">showYear</span> = current.<span class="title function_">getFullYear</span>();</span><br><span class="line"></span><br><span class="line">                calUtil.<span class="property">showMonth</span> = current.<span class="title function_">getMonth</span>() + <span class="number">1</span>;</span><br><span class="line">                calUtil.<span class="property">showDays</span> = current.<span class="title function_">getDate</span>();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;prev&quot;</span>:</span><br><span class="line"></span><br><span class="line">                <span class="keyword">var</span> nowMonth = $(<span class="string">&quot;.calendar_month_span&quot;</span>).<span class="title function_">html</span>().<span class="title function_">split</span>(<span class="string">&quot;年&quot;</span>)[<span class="number">1</span>].<span class="title function_">split</span>(<span class="string">&quot;月&quot;</span>)[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">                calUtil.<span class="property">showMonth</span> = <span class="built_in">parseInt</span>(nowMonth) - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (calUtil.<span class="property">showMonth</span> == <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">                    calUtil.<span class="property">showMonth</span> = <span class="number">12</span>;</span><br><span class="line"></span><br><span class="line">                    calUtil.<span class="property">showYear</span> -= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;next&quot;</span>:</span><br><span class="line"></span><br><span class="line">                <span class="keyword">var</span> nowMonth = $(<span class="string">&quot;.calendar_month_span&quot;</span>).<span class="title function_">html</span>().<span class="title function_">split</span>(<span class="string">&quot;年&quot;</span>)[<span class="number">1</span>].<span class="title function_">split</span>(<span class="string">&quot;月&quot;</span>)[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">                calUtil.<span class="property">showMonth</span> = <span class="built_in">parseInt</span>(nowMonth) + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (calUtil.<span class="property">showMonth</span> == <span class="number">13</span>) &#123;</span><br><span class="line"></span><br><span class="line">                    calUtil.<span class="property">showMonth</span> = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">                    calUtil.<span class="property">showYear</span> += <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">getDaysInmonth</span>: <span class="keyword">function</span>(<span class="params">iMonth, iYear</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> dPrevDate = <span class="keyword">new</span> <span class="title class_">Date</span>(iYear, iMonth, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> dPrevDate.<span class="title function_">getDate</span>();</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">bulidCal</span>: <span class="keyword">function</span>(<span class="params">iYear, iMonth</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> aMonth = <span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line"></span><br><span class="line">        aMonth[<span class="number">0</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">7</span>);</span><br><span class="line"></span><br><span class="line">        aMonth[<span class="number">1</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">7</span>);</span><br><span class="line"></span><br><span class="line">        aMonth[<span class="number">2</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">7</span>);</span><br><span class="line"></span><br><span class="line">        aMonth[<span class="number">3</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">7</span>);</span><br><span class="line"></span><br><span class="line">        aMonth[<span class="number">4</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">7</span>);</span><br><span class="line"></span><br><span class="line">        aMonth[<span class="number">5</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">7</span>);</span><br><span class="line"></span><br><span class="line">        aMonth[<span class="number">6</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">7</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> dCalDate = <span class="keyword">new</span> <span class="title class_">Date</span>(iYear, iMonth - <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> iDayOfFirst = dCalDate.<span class="title function_">getDay</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> iDaysInMonth = calUtil.<span class="title function_">getDaysInmonth</span>(iMonth, iYear);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> iVarDate = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> d, w;</span><br><span class="line"></span><br><span class="line">        aMonth[<span class="number">0</span>][<span class="number">0</span>] = <span class="string">&quot;日&quot;</span>;</span><br><span class="line"></span><br><span class="line">        aMonth[<span class="number">0</span>][<span class="number">1</span>] = <span class="string">&quot;一&quot;</span>;</span><br><span class="line"></span><br><span class="line">        aMonth[<span class="number">0</span>][<span class="number">2</span>] = <span class="string">&quot;二&quot;</span>;</span><br><span class="line"></span><br><span class="line">        aMonth[<span class="number">0</span>][<span class="number">3</span>] = <span class="string">&quot;三&quot;</span>;</span><br><span class="line"></span><br><span class="line">        aMonth[<span class="number">0</span>][<span class="number">4</span>] = <span class="string">&quot;四&quot;</span>;</span><br><span class="line"></span><br><span class="line">        aMonth[<span class="number">0</span>][<span class="number">5</span>] = <span class="string">&quot;五&quot;</span>;</span><br><span class="line"></span><br><span class="line">        aMonth[<span class="number">0</span>][<span class="number">6</span>] = <span class="string">&quot;六&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (d = iDayOfFirst; d &lt; <span class="number">7</span>; d++) &#123;</span><br><span class="line"></span><br><span class="line">            aMonth[<span class="number">1</span>][d] = iVarDate;</span><br><span class="line"></span><br><span class="line">            iVarDate++;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (w = <span class="number">2</span>; w &lt; <span class="number">7</span>; w++) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (d = <span class="number">0</span>; d &lt; <span class="number">7</span>; d++) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (iVarDate &lt;= iDaysInMonth) &#123;</span><br><span class="line"></span><br><span class="line">                    aMonth[w][d] = iVarDate;</span><br><span class="line"></span><br><span class="line">                    iVarDate++;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> aMonth;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">ifHasSigned</span>: <span class="keyword">function</span>(<span class="params">signList, day</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> signed = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        $.<span class="title function_">each</span>(signList, <span class="keyword">function</span>(<span class="params">index, item</span>) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (item.<span class="property">signDay</span> == day) &#123;</span><br><span class="line"></span><br><span class="line">                signed = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> signed;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">ifDateNow</span>: <span class="keyword">function</span> (<span class="params">day</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (calUtil.<span class="property">showDays</span> == day) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">drawCal</span>: <span class="keyword">function</span>(<span class="params">iYear, iMonth, signList</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> myMonth = calUtil.<span class="title function_">bulidCal</span>(iYear, iMonth);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> htmls = <span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line"></span><br><span class="line">        htmls.<span class="title function_">push</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        htmls.<span class="title function_">push</span>(<span class="string">&quot;&lt;ul&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        htmls.<span class="title function_">push</span>(<span class="string">&quot;&lt;li&gt;&quot;</span>);</span><br><span class="line">        htmls.<span class="title function_">push</span>(<span class="string">&quot;&lt;font&gt;日&lt;/font&gt;&quot;</span>);</span><br><span class="line">        htmls.<span class="title function_">push</span>(<span class="string">&quot;&lt;font&gt;一&lt;/font&gt;&quot;</span>);</span><br><span class="line">        htmls.<span class="title function_">push</span>(<span class="string">&quot;&lt;font&gt;二&lt;/font&gt;&quot;</span>);</span><br><span class="line">        htmls.<span class="title function_">push</span>(<span class="string">&quot;&lt;font&gt;三&lt;/font&gt;&quot;</span>);</span><br><span class="line">        htmls.<span class="title function_">push</span>(<span class="string">&quot;&lt;font&gt;四&lt;/font&gt;&quot;</span>);</span><br><span class="line">        htmls.<span class="title function_">push</span>(<span class="string">&quot;&lt;font&gt;五&lt;/font&gt;&quot;</span>);</span><br><span class="line">        htmls.<span class="title function_">push</span>(<span class="string">&quot;&lt;font&gt;六&lt;/font&gt;&quot;</span>);</span><br><span class="line">        htmls.<span class="title function_">push</span>(<span class="string">&quot;&lt;/li&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> d, w;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (w = <span class="number">1</span>; w &lt; <span class="number">7</span>; w++) &#123;</span><br><span class="line"></span><br><span class="line">            htmls.<span class="title function_">push</span>(<span class="string">&quot;&lt;li&gt;&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (d = <span class="number">0</span>; d &lt; <span class="number">7</span>; d++) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">var</span> ifHasSigned = calUtil.<span class="title function_">ifHasSigned</span>(signList, myMonth[w][d]);</span><br><span class="line"></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(ifHasSigned);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (ifHasSigned) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (calUtil.<span class="title function_">ifDateNow</span>(myMonth[w][d])) &#123;</span><br><span class="line">                        htmls.<span class="title function_">push</span>(<span class="string">&quot;&lt;p class=&#x27;on isborder&#x27;&gt;&quot;</span> + (!<span class="built_in">isNaN</span>(myMonth[w][d]) ? myMonth[w][d] : <span class="string">&quot; &quot;</span>) + <span class="string">&quot;&lt;/p&gt;&quot;</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">                        htmls.<span class="title function_">push</span>(<span class="string">&quot;&lt;p class=&#x27;on&#x27;&gt;&quot;</span> + (!<span class="built_in">isNaN</span>(myMonth[w][d]) ? myMonth[w][d] : <span class="string">&quot; &quot;</span>) + <span class="string">&quot;&lt;/p&gt;&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (calUtil.<span class="title function_">ifDateNow</span>(myMonth[w][d])) &#123;</span><br><span class="line">                        htmls.<span class="title function_">push</span>(<span class="string">&quot;&lt;p class=&#x27;isborder&#x27;&gt;&quot;</span> + (!<span class="built_in">isNaN</span>(myMonth[w][d]) ? myMonth[w][d] : <span class="string">&quot; &quot;</span>) + <span class="string">&quot;&lt;/p&gt;&quot;</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        htmls.<span class="title function_">push</span>(<span class="string">&quot;&lt;p&gt;&quot;</span> + (!<span class="built_in">isNaN</span>(myMonth[w][d]) ? myMonth[w][d] : <span class="string">&quot; &quot;</span>) + <span class="string">&quot;&lt;/p&gt;&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            htmls.<span class="title function_">push</span>(<span class="string">&quot;&lt;/li&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        htmls.<span class="title function_">push</span>(<span class="string">&quot;&lt;/ul&gt;&quot;</span>);</span><br><span class="line">        htmls.<span class="title function_">push</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        htmls.<span class="title function_">push</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> htmls.<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="二、效果图，如下："><a href="#二、效果图，如下：" class="headerlink" title="二、效果图，如下："></a>二、效果图，如下：</h2><p><img src="https://images.codeobservatory.cn/hexo/202506/18/a26e5a78688404a0.png" alt="HTML5实现签到功能，项目实战之基于JavaScript实现每日签到打卡送积分功能"></p>]]></content>
    
    
    <summary type="html">这篇文章介绍了如何使用HTML5和JavaScript实现一个每日签到打卡送积分的功能，详细讲解了核心代码calendar.js的实现过程，包括日历的初始化、绘制、月份切换、判断是否已签到等功能，通过JavaScript动态生成日历界面，并根据签到记录标记已签到的日期，同时提供了获取当月天数、构建日历数组等辅助方法，最终实现了用户每日签到并累计积分的功能，代码结构清晰，功能完整，适合用于网站或APP的签到系统开发。</summary>
    
    
    
    <category term="前端开发" scheme="https://www.codeobservatory.cn/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="HTML5" scheme="https://www.codeobservatory.cn/tags/HTML5/"/>
    
    <category term="JavaScript" scheme="https://www.codeobservatory.cn/tags/JavaScript/"/>
    
    <category term="签到" scheme="https://www.codeobservatory.cn/tags/%E7%AD%BE%E5%88%B0/"/>
    
  </entry>
  
  <entry>
    <title>SQL Server数据库备份及导出表数据和结构</title>
    <link href="https://www.codeobservatory.cn/archives/56e6e176.html"/>
    <id>https://www.codeobservatory.cn/archives/56e6e176.html</id>
    <published>2025-06-18T01:37:06.000Z</published>
    <updated>2025-06-18T02:08:09.649Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、备份表数据及结构"><a href="#一、备份表数据及结构" class="headerlink" title="一、备份表数据及结构"></a>一、备份表数据及结构</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">into</span> new_table_name <span class="keyword">from</span> old_tablename;</span><br></pre></td></tr></table></figure><h2 id="二、导出表数据及结构"><a href="#二、导出表数据及结构" class="headerlink" title="二、导出表数据及结构"></a>二、导出表数据及结构</h2><ol><li>选中要导出的数据库–&gt;任务–&gt;生成脚本（或者在任务里面有生成脚本这个选项，好好找找能找到的！）<br><img src="https://images.codeobservatory.cn/hexo/202506/18/2025-06-18%2009451901.png" alt="SQL Server数据库备份及导出表数据和结构"></li><li>出现“生成和发布脚本”窗口，点击下一步<br><img src="https://images.codeobservatory.cn/hexo/202506/18/2025-06-18%2009465102.png" alt="SQL Server数据库备份及导出表数据和结构"></li><li>选择要编写脚本的数据库对象，全部导出选第一个，如果你想导出部分数据勾选    第二个就好了<br><img src="https://images.codeobservatory.cn/hexo/202506/18/2025-06-18%2009481203.png" alt="SQL Server数据库备份及导出表数据和结构"></li><li>出现这个画面后点击”高级”按钮（重点）<br><img src="https://images.codeobservatory.cn/hexo/202506/18/2025-06-18%2009484204.png" alt="SQL Server数据库备份及导出表数据和结构"></li><li>”要编写脚本的数据的类型”对应：”架构和数据”<br><img src="https://images.codeobservatory.cn/hexo/202506/18/2025-06-18%2009491705.png" alt="SQL Server数据库备份及导出表数据和结构"></li><li>确定、下一步、下一步、导出成功！</li></ol><h2 id="三、恢复数据库表结构及数据"><a href="#三、恢复数据库表结构及数据" class="headerlink" title="三、恢复数据库表结构及数据"></a>三、恢复数据库表结构及数据</h2><p>电脑打开CMD，输入以下命令：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlcmd -S SERVERNAME -U NAME -P PWD -i D:\sql.sql</span><br></pre></td></tr></table></figure><p>回车执行即可。</p><p><strong>注释</strong>：</p><blockquote><p><code>SERVERNAME</code>:目标数据库IP<br><code>NAME</code>:目标数据库登录名<br><code>PWD</code>:目标数据库登录密码<br><code>D:\sql.sql</code>:数据备份文件的路径</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;一、备份表数据及结构&quot;&gt;&lt;a href=&quot;#一、备份表数据及结构&quot; class=&quot;headerlink&quot; title=&quot;一、备份表数据及结构&quot;&gt;&lt;/a&gt;一、备份表数据及结构&lt;/h2&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;</summary>
      
    
    
    
    <category term="数据库" scheme="https://www.codeobservatory.cn/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="sql" scheme="https://www.codeobservatory.cn/tags/sql/"/>
    
    <category term="数据库" scheme="https://www.codeobservatory.cn/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    <category term="数据备份" scheme="https://www.codeobservatory.cn/tags/%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD/"/>
    
  </entry>
  
  <entry>
    <title>C# WinForms 实现打印监听组件</title>
    <link href="https://www.codeobservatory.cn/archives/bdd5c491.html"/>
    <id>https://www.codeobservatory.cn/archives/bdd5c491.html</id>
    <published>2025-06-14T07:44:45.000Z</published>
    <updated>2025-06-14T08:36:20.373Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、组件简介"><a href="#一、组件简介" class="headerlink" title="一、组件简介"></a>一、组件简介</h2><p>打印监听组件是一款集成于 Windows 桌面环境的打印任务管理与监控工具，适用于企业级应用场景。它不仅支持多打印机任务的实时监控，还能通过 WebSocket 与外部系统集成，实现自动化打印、任务状态反馈、远程控制等功能。</p><h2 id="二、界面功能介绍"><a href="#二、界面功能介绍" class="headerlink" title="二、界面功能介绍"></a>二、界面功能介绍</h2><h3 id="1-主界面与托盘集成"><a href="#1-主界面与托盘集成" class="headerlink" title="1. 主界面与托盘集成"></a>1. 主界面与托盘集成</h3><ul><li>主窗体：采用 WinForms 界面，包含多标签页（TabControl），每个标签页对应一台本地打印机，便于分组管理。<br><img src="https://images.codeobservatory.cn/hexo/202506/14/2025061415494301.png" alt="C# WinForms 实现打印监听组件"></li><li>托盘图标：程序最小化后驻留于系统托盘，双击可快速还原主界面，支持右键菜单操作（如退出、重启、服务设置等）。<br><img src="https://images.codeobservatory.cn/hexo/202506/14/2025061415541902.png" alt="C# WinForms 实现打印监听组件"></li></ul><h3 id="2-打印机管理"><a href="#2-打印机管理" class="headerlink" title="2. 打印机管理"></a>2. 打印机管理</h3><ul><li>打印机列表：自动检测本地所有已安装打印机，支持设置默认打印机、查看打印机属性。</li></ul><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 绑定本地打印机列表到菜单</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">internal</span> <span class="keyword">void</span> <span class="title">BindPrintersToMenu</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    默认打印机ToolStripMenuItem.DropDownItems.Clear();</span><br><span class="line">    <span class="comment">// 获取当前系统默认打印机</span></span><br><span class="line">    <span class="built_in">string</span> defaultPrinter = <span class="keyword">new</span> System.Drawing.Printing.PrinterSettings().PrinterName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 先添加默认打印机（始终第一行）</span></span><br><span class="line">    <span class="keyword">var</span> defaultItem = <span class="keyword">new</span> ToolStripMenuItem(defaultPrinter)</span><br><span class="line">    &#123;</span><br><span class="line">        Checked = <span class="literal">true</span></span><br><span class="line">    &#125;;</span><br><span class="line">    defaultItem.Click += (s, e) =&gt; SetDefaultPrinterUI(defaultPrinter);</span><br><span class="line">    <span class="comment">// 添加“首选项”子菜单</span></span><br><span class="line">    <span class="keyword">var</span> prefItem = <span class="keyword">new</span> ToolStripMenuItem(<span class="string">&quot;首选项&quot;</span>);</span><br><span class="line">    prefItem.Click += (s, e) =&gt; ShowPrinterProperties(defaultPrinter);</span><br><span class="line">    defaultItem.DropDownItems.Add(prefItem);</span><br><span class="line">    默认打印机ToolStripMenuItem.DropDownItems.Add(defaultItem);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 再添加其他打印机（排除默认打印机）</span></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="built_in">string</span> printer <span class="keyword">in</span> System.Drawing.Printing.PrinterSettings.InstalledPrinters)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (printer == defaultPrinter)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> item = <span class="keyword">new</span> ToolStripMenuItem(printer)</span><br><span class="line">        &#123;</span><br><span class="line">            Checked = <span class="literal">false</span></span><br><span class="line">        &#125;;</span><br><span class="line">        item.Click += (s, e) =&gt; SetDefaultPrinterUI(printer);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> prefItem2 = <span class="keyword">new</span> ToolStripMenuItem(<span class="string">&quot;首选项&quot;</span>);</span><br><span class="line">        prefItem2.Click += (s, e) =&gt; ShowPrinterProperties(printer);</span><br><span class="line">        item.DropDownItems.Add(prefItem2);</span><br><span class="line"></span><br><span class="line">        默认打印机ToolStripMenuItem.DropDownItems.Add(item);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"> <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>  </span></span><br><span class="line"> <span class="comment"><span class="doctag">///</span> UI和系统都设置默认打印机 </span></span><br><span class="line"> <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span>  </span></span><br><span class="line"> <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;printerName&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span>  </span></span><br><span class="line"> <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">SetDefaultPrinterUI</span>(<span class="params"><span class="built_in">string</span> printerName</span>)</span></span><br><span class="line"> &#123;</span><br><span class="line">     <span class="keyword">foreach</span> (ToolStripMenuItem item <span class="keyword">in</span> 默认打印机ToolStripMenuItem.DropDownItems)</span><br><span class="line">         item.Checked = item.Text == printerName;</span><br><span class="line"></span><br><span class="line">     <span class="comment">// 如需设置为系统默认打印机，可调用 Win32 API（可选）  </span></span><br><span class="line">     SetSystemDefaultPrinter(printerName);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 显示打印机首选项对话框</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;printerName&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ShowPrinterProperties</span>(<span class="params"><span class="built_in">string</span> printerName</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 使用rundll32调用打印机属性对话框</span></span><br><span class="line">    <span class="comment">//string args = $&quot;printui.dll,PrintUIEntry /p /n \&quot;&#123;printerName&#125;\&quot;&quot;;</span></span><br><span class="line">    <span class="comment">//•/e 参数表示直接打开“首选项”对话框</span></span><br><span class="line">    <span class="built_in">string</span> <span class="keyword">args</span> = <span class="string">$&quot;printui.dll,PrintUIEntry /e /n \&quot;<span class="subst">&#123;printerName&#125;</span>\&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> psi = <span class="keyword">new</span> System.Diagnostics.ProcessStartInfo</span><br><span class="line">    &#123;</span><br><span class="line">        FileName = <span class="string">&quot;rundll32.exe&quot;</span>,</span><br><span class="line">        Arguments = <span class="keyword">args</span>,</span><br><span class="line">        UseShellExecute = <span class="literal">false</span>,</span><br><span class="line">        CreateNoWindow = <span class="literal">true</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.Diagnostics.Process.Start(psi);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox.Show(<span class="string">&quot;无法打开打印机首选项窗口：&quot;</span> + ex.Message, <span class="string">&quot;错误&quot;</span>, MessageBoxButtons.OK, MessageBoxIcon.Error);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>TabControl：每台打印机一个标签页，便于查看和管理各自的打印任务。</li></ul><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 绑定本地打印机列表到TabControl</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">BindPrintersToTabControl</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    tabControl1.TabPages.Clear();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">string</span> defaultPrinter = <span class="keyword">new</span> System.Drawing.Printing.PrinterSettings().PrinterName;</span><br><span class="line">    List&lt;<span class="built_in">string</span>&gt; printers = <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 先将默认打印机添加到列表首位</span></span><br><span class="line">    printers.Add(defaultPrinter);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 再添加其他打印机（排除默认打印机）</span></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="built_in">string</span> printer <span class="keyword">in</span> System.Drawing.Printing.PrinterSettings.InstalledPrinters)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (printer != defaultPrinter)</span><br><span class="line">            printers.Add(printer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="built_in">string</span> printer <span class="keyword">in</span> printers)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> tabPage = <span class="keyword">new</span> TabPage(printer);</span><br><span class="line">        <span class="comment">// 创建DataGridView</span></span><br><span class="line">        <span class="keyword">var</span> dgv = <span class="keyword">new</span> DataGridView</span><br><span class="line">        &#123;</span><br><span class="line">            Dock = DockStyle.Fill,</span><br><span class="line">            ReadOnly = <span class="literal">true</span>,</span><br><span class="line">            AllowUserToAddRows = <span class="literal">false</span>,</span><br><span class="line">            AllowUserToDeleteRows = <span class="literal">false</span>,</span><br><span class="line">            RowHeadersVisible = <span class="literal">false</span>,</span><br><span class="line">            AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.Fill</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 添加列</span></span><br><span class="line">        dgv.Columns.Add(<span class="string">&quot;clientIp&quot;</span>, <span class="string">&quot;来源&quot;</span>);</span><br><span class="line">        dgv.Columns.Add(<span class="string">&quot;taskId&quot;</span>, <span class="string">&quot;任务ID&quot;</span>);</span><br><span class="line">        dgv.Columns.Add(<span class="string">&quot;taskName&quot;</span>, <span class="string">&quot;任务名称&quot;</span>);</span><br><span class="line">        dgv.Columns.Add(<span class="string">&quot;realName&quot;</span>, <span class="string">&quot;模板&quot;</span>);</span><br><span class="line">        dgv.Columns.Add(<span class="string">&quot;requestTime&quot;</span>, <span class="string">&quot;开始时间&quot;</span>);</span><br><span class="line">        dgv.Columns.Add(<span class="string">&quot;status&quot;</span>, <span class="string">&quot;任务状态&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//绑定菜单</span></span><br><span class="line">        dgv.ContextMenuStrip = dgvContextMenu;</span><br><span class="line">        dgv.MouseDown += Dgv_MouseDown;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建TextBox</span></span><br><span class="line">        <span class="keyword">var</span> txtSearch = <span class="keyword">new</span> TextBox</span><br><span class="line">        &#123;</span><br><span class="line">            PlaceholderText = <span class="string">&quot;任务ID&quot;</span>,</span><br><span class="line">            Width = <span class="number">120</span>,</span><br><span class="line">            Anchor = AnchorStyles.Left | AnchorStyles.Bottom</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建Button</span></span><br><span class="line">        <span class="keyword">var</span> btnSearch = <span class="keyword">new</span> Button</span><br><span class="line">        &#123;</span><br><span class="line">            Text = <span class="string">&quot;查找&quot;</span>,</span><br><span class="line">            Width = <span class="number">60</span>,</span><br><span class="line">            Anchor = AnchorStyles.Left | AnchorStyles.Bottom</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 查找事件</span></span><br><span class="line">        btnSearch.Click += (s, e) =&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> searchId = txtSearch.Text.Trim();</span><br><span class="line">            <span class="built_in">bool</span> found = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">foreach</span> (DataGridViewRow row <span class="keyword">in</span> dgv.Rows)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (row.IsNewRow) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span> (row.Cells[<span class="string">&quot;taskId&quot;</span>].Value?.ToString() == searchId)</span><br><span class="line">                &#123;</span><br><span class="line">                    row.Selected = <span class="literal">true</span>;</span><br><span class="line">                    dgv.CurrentCell = row.Cells[<span class="string">&quot;taskId&quot;</span>];</span><br><span class="line">                    found = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    row.Selected = <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!found)</span><br><span class="line">            &#123;</span><br><span class="line">                MessageBox.Show(<span class="string">&quot;未找到对应任务ID！&quot;</span>, <span class="string">&quot;提示&quot;</span>, MessageBoxButtons.OK, MessageBoxIcon.Information);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 使用Panel布局</span></span><br><span class="line">        <span class="keyword">var</span> panel = <span class="keyword">new</span> Panel</span><br><span class="line">        &#123;</span><br><span class="line">            Dock = DockStyle.Bottom,</span><br><span class="line">            Height = <span class="number">40</span></span><br><span class="line">        &#125;;</span><br><span class="line">        txtSearch.Location = <span class="keyword">new</span> Point(<span class="number">10</span>, <span class="number">8</span>);</span><br><span class="line">        btnSearch.Location = <span class="keyword">new</span> Point(<span class="number">140</span>, <span class="number">6</span>);</span><br><span class="line">        panel.Controls.Add(txtSearch);</span><br><span class="line">        panel.Controls.Add(btnSearch);</span><br><span class="line"></span><br><span class="line">        tabPage.Controls.Add(panel);</span><br><span class="line">        tabPage.Controls.Add(dgv);</span><br><span class="line">        tabControl1.TabPages.Add(tabPage);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-打印任务监控"><a href="#3-打印任务监控" class="headerlink" title="3. 打印任务监控"></a>3. 打印任务监控</h3><ul><li>任务列表：每个打印机标签页下方为 DataGridView，实时显示当前打印任务，包括来源、任务ID、任务名称、模板、开始时间、任务状态等信息。<br><img src="https://images.codeobservatory.cn/hexo/202506/14/2025061415494301.png" alt="C# WinForms 实现打印监听组件"></li><li>右键菜单：支持对单个任务进行“取消打印”、“重新打印”、“删除记录”等操作。<br><img src="https://images.codeobservatory.cn/hexo/202506/14/2025061416011103.png" alt="C# WinForms 实现打印监听组件"></li><li>任务搜索：支持按任务ID快速定位任务。</li></ul><h3 id="4-其他功能"><a href="#4-其他功能" class="headerlink" title="4. 其他功能"></a>4. 其他功能</h3><ul><li>服务控制：可一键启动&#x2F;停止 WebSocket 服务，支持与外部系统通信。</li><li>模板设计与预览：集成 FastReport 设计器和预览器，方便模板维护。<blockquote><p>因为FastReport.Net 是需要购买授权的，所以我使用的是FastReport.OpenSource(开源版)，开源版功能太少，不能直接从程序内部调用FastReport设计器和预览器，只能通过启动本地安装的.exe来实现。</p></blockquote></li></ul><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 设计菜单项点击事件，启动 FastReport 设计器</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> 设计ToolStripMenuItem_Click(<span class="built_in">object</span> sender, EventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> designerPath = GetConfigValue(<span class="string">&quot;designer_path&quot;</span>);</span><br><span class="line">    <span class="built_in">string</span> templatePath = GetTemplatePathFromConfig();</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(designerPath) || !System.IO.File.Exists(designerPath))</span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox.Show(<span class="string">&quot;未找到 FastReport 设计器，请检查 config.ini 配置！&quot;</span>, <span class="string">&quot;错误&quot;</span>, MessageBoxButtons.OK, MessageBoxIcon.Error);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!System.IO.File.Exists(templatePath))</span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox.Show(<span class="string">&quot;未找到模板文件，请检查路径！&quot;</span>, <span class="string">&quot;错误&quot;</span>, MessageBoxButtons.OK, MessageBoxIcon.Error);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.Diagnostics.Process.Start(designerPath, <span class="string">$&quot;\&quot;<span class="subst">&#123;templatePath&#125;</span>\&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox.Show(<span class="string">&quot;启动 FastReport 设计器失败：&quot;</span> + ex.Message, <span class="string">&quot;错误&quot;</span>, MessageBoxButtons.OK, MessageBoxIcon.Error);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> 预览ToolStripMenuItem_Click(<span class="built_in">object</span> sender, EventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> viewerPath = GetConfigValue(<span class="string">&quot;viewer_path&quot;</span>);</span><br><span class="line">    <span class="built_in">string</span> templatePath = GetTemplatePathFromConfig();</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(viewerPath) || !System.IO.File.Exists(viewerPath))</span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox.Show(<span class="string">&quot;未找到 FastReport 预览器，请检查 config.ini 配置！&quot;</span>, <span class="string">&quot;错误&quot;</span>, MessageBoxButtons.OK, MessageBoxIcon.Error);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!System.IO.File.Exists(templatePath))</span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox.Show(<span class="string">&quot;未找到模板文件，请检查路径！&quot;</span>, <span class="string">&quot;错误&quot;</span>, MessageBoxButtons.OK, MessageBoxIcon.Error);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.Diagnostics.Process.Start(viewerPath, <span class="string">$&quot;\&quot;<span class="subst">&#123;templatePath&#125;</span>\&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox.Show(<span class="string">&quot;启动 FastReport 预览器失败：&quot;</span> + ex.Message, <span class="string">&quot;错误&quot;</span>, MessageBoxButtons.OK, MessageBoxIcon.Error);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>自动更新：支持在线检查和自动更新程序版本。<blockquote><p>这里使用的是：<code>Autoupdater.NET</code></p></blockquote></li><li>帮助与支持：内置开发者联系方式，便于用户反馈和技术支持。<br><img src="https://images.codeobservatory.cn/hexo/202506/14/2025061416103304.png" alt="开发者联系方式：wxscc@foxmail.com"></li></ul><h2 id="三、技术要点"><a href="#三、技术要点" class="headerlink" title="三、技术要点"></a>三、技术要点</h2><h3 id="1-打印任务监听与管理"><a href="#1-打印任务监听与管理" class="headerlink" title="1. 打印任务监听与管理"></a>1. 打印任务监听与管理</h3><ul><li>WMI 打印作业监控<br>通过 <code>System.Management</code> 命名空间，使用 <code>WMI</code> 查询 <code>Win32_PrintJob</code>，实现对打印队列的实时监控。可根据任务ID或文档名唯一标识，精确定位和管理打印作业。</li></ul><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Management;</span><br><span class="line"></span><br><span class="line"> <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"> <span class="comment"><span class="doctag">///</span> 打印机监听方法实现</span></span><br><span class="line"> <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"> <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;printerName&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"> <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;taskId&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"> <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">StartMonitorPrintJob</span>(<span class="params"><span class="built_in">string</span> printerName, <span class="built_in">int</span> taskId, <span class="built_in">string</span> taskName</span>)</span></span><br><span class="line"> &#123;</span><br><span class="line">     Task.Run(() =&gt;</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="keyword">try</span></span><br><span class="line">         &#123;</span><br><span class="line">             <span class="built_in">string</span> query = <span class="string">$&quot;SELECT * FROM Win32_PrintJob WHERE Name LIKE &#x27;%<span class="subst">&#123;printerName&#125;</span>%&#x27;&quot;</span>;</span><br><span class="line">             <span class="keyword">using</span> (<span class="keyword">var</span> searcher = <span class="keyword">new</span> ManagementObjectSearcher(query))</span><br><span class="line">             &#123;</span><br><span class="line">                 <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">var</span> jobs = searcher.Get();</span><br><span class="line">                     <span class="built_in">bool</span> found = <span class="literal">false</span>;</span><br><span class="line">                     <span class="keyword">foreach</span> (ManagementObject job <span class="keyword">in</span> jobs)</span><br><span class="line">                     &#123;</span><br><span class="line">                         found = <span class="literal">true</span>;</span><br><span class="line">                         <span class="built_in">int</span> JobId = Convert.ToInt32(job[<span class="string">&quot;JobId&quot;</span>]);</span><br><span class="line">                         <span class="keyword">if</span> (JobId == taskId)</span><br><span class="line">                         &#123;</span><br><span class="line">                             <span class="comment">// 匹配到本任务，更新状态</span></span><br><span class="line">                             <span class="built_in">string</span> jobStatus = job[<span class="string">&quot;JobStatus&quot;</span>]?.ToString() ?? <span class="string">&quot;&quot;</span>;</span><br><span class="line">                             <span class="built_in">string</span> status = job[<span class="string">&quot;Status&quot;</span>]?.ToString() ?? <span class="string">&quot;&quot;</span>;</span><br><span class="line">                             <span class="built_in">string</span> displayStatus = <span class="built_in">string</span>.IsNullOrEmpty(jobStatus) ? status : jobStatus;</span><br><span class="line">                             UpdateTaskStatusOnUI(printerName, taskName, displayStatus);</span><br><span class="line">                             <span class="keyword">if</span> (displayStatus.Contains(<span class="string">&quot;Printed&quot;</span>) || displayStatus.Contains(<span class="string">&quot;Completed&quot;</span>) || displayStatus.Contains(<span class="string">&quot;Deleted&quot;</span>))</span><br><span class="line">                                 <span class="keyword">return</span>;</span><br><span class="line">                         &#125;</span><br><span class="line">                     &#125;</span><br><span class="line">                     <span class="keyword">if</span> (!found)</span><br><span class="line">                     &#123;</span><br><span class="line">                         <span class="comment">// 作业已消失，认为已完成</span></span><br><span class="line">                         UpdateTaskStatusOnUI(printerName, taskName, <span class="string">&quot;已完成&quot;</span>);</span><br><span class="line">                         <span class="keyword">return</span>;</span><br><span class="line">                     &#125;</span><br><span class="line">                     Thread.Sleep(<span class="number">1000</span>); <span class="comment">// 1秒轮询</span></span><br><span class="line">                 &#125;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">         &#123;</span><br><span class="line">             UpdateTaskStatusOnUI(printerName, taskName, <span class="string">&quot;状态监听失败&quot;</span>);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><ul><li>任务状态同步<br>通过轮询方式定时查询打印队列，自动更新任务状态（如“正在打印”、“已完成”、“已取消”等），并在 UI 上实时反馈。</li></ul><h3 id="2-打印任务操作"><a href="#2-打印任务操作" class="headerlink" title="2. 打印任务操作"></a>2. 打印任务操作</h3><ul><li>取消打印<br>通过 WMI 删除指定打印作业，确保任务被及时从队列中移除，并同步更新界面状态。</li></ul><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 取消打印</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">CancelPrint_Click</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> dgv = GetCurrentDgv();</span><br><span class="line">    <span class="keyword">if</span> (dgv == <span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">var</span> row = dgv.SelectedRows.Count &gt; <span class="number">0</span> ? dgv.SelectedRows[<span class="number">0</span>] : <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (row == <span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">int</span> taskId = Convert.ToInt32(row.Cells[<span class="string">&quot;taskId&quot;</span>].Value);</span><br><span class="line">    <span class="built_in">string</span> printerName = tabControl1.SelectedTab.Text;</span><br><span class="line">    <span class="comment">// 查询打印队列，找到文档名包含 taskId 的作业</span></span><br><span class="line">    <span class="built_in">string</span> query = <span class="string">$&quot;SELECT * FROM Win32_PrintJob WHERE Name LIKE &#x27;%<span class="subst">&#123;printerName&#125;</span>%&#x27;&quot;</span>;</span><br><span class="line">    <span class="keyword">using</span> (<span class="keyword">var</span> searcher = <span class="keyword">new</span> System.Management.ManagementObjectSearcher(query))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">foreach</span> (System.Management.ManagementObject job <span class="keyword">in</span> searcher.Get())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">int</span> JobId = Convert.ToInt32(job[<span class="string">&quot;JobId&quot;</span>]);</span><br><span class="line">            <span class="keyword">if</span> (JobId == taskId)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">try</span></span><br><span class="line">                &#123;</span><br><span class="line">                    job.Delete(); <span class="comment">// 删除打印任务</span></span><br><span class="line">                    row.Cells[<span class="string">&quot;status&quot;</span>].Value = <span class="string">&quot;已取消&quot;</span>;</span><br><span class="line">                    MessageBox.Show(<span class="string">$&quot;已取消打印任务：<span class="subst">&#123;taskId&#125;</span>&quot;</span>, <span class="string">&quot;提示&quot;</span>, MessageBoxButtons.OK, MessageBoxIcon.Information);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">                &#123;</span><br><span class="line">                    MessageBox.Show(<span class="string">&quot;取消打印失败：&quot;</span> + ex.Message, <span class="string">&quot;错误&quot;</span>, MessageBoxButtons.OK, MessageBoxIcon.Error);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    MessageBox.Show(<span class="string">&quot;未找到对应的打印任务，可能已完成或被清除。&quot;</span>, <span class="string">&quot;提示&quot;</span>, MessageBoxButtons.OK, MessageBoxIcon.Information);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>重新打印<br>首次打印时将所有参数（文件路径、数据、模板名等）保存在 DataGridView 行的 Tag 属性，重新打印时直接复用原始参数，保证打印一致性。</li></ul><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 重新打印</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Reprint_Click</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> dgv = GetCurrentDgv();</span><br><span class="line">    <span class="keyword">if</span> (dgv == <span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">var</span> row = dgv.SelectedRows.Count &gt; <span class="number">0</span> ? dgv.SelectedRows[<span class="number">0</span>] : <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (row == <span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (row.Tag <span class="keyword">is</span> PrintTaskInfo info)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 复用原 taskName，或可选生成新 taskName</span></span><br><span class="line">        <span class="built_in">string</span> taskName = row.Cells[<span class="string">&quot;taskName&quot;</span>].Value.ToString();</span><br><span class="line">        <span class="built_in">string</span> status = row.Cells[<span class="string">&quot;status&quot;</span>].Value.ToString();</span><br><span class="line">        <span class="keyword">if</span> (status == <span class="string">&quot;已完成&quot;</span>)</span><br><span class="line">            PrintFile(info.FilePath, info.Data, taskName);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox.Show(<span class="string">&quot;未找到原始打印信息，无法重新打印。&quot;</span>, <span class="string">&quot;错误&quot;</span>, MessageBoxButtons.OK, MessageBoxIcon.Error);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>删除记录<br>支持在任务未完成时先删除打印队列中的作业，再移除界面记录，防止“假删除”导致队列堆积。</li></ul><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 删除打印记录</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DeleteRecord_Click</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> dgv = GetCurrentDgv();</span><br><span class="line">    <span class="keyword">if</span> (dgv == <span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">var</span> row = dgv.SelectedRows.Count &gt; <span class="number">0</span> ? dgv.SelectedRows[<span class="number">0</span>] : <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (row == <span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">int</span> taskId = Convert.ToInt32(row.Cells[<span class="string">&quot;taskId&quot;</span>].Value);</span><br><span class="line">    <span class="built_in">string</span> status = row.Cells[<span class="string">&quot;status&quot;</span>].Value?.ToString();</span><br><span class="line">    <span class="built_in">string</span> printerName = tabControl1.SelectedTab.Text;</span><br><span class="line">    <span class="comment">// 如果未完成，先删除打印队列中的任务</span></span><br><span class="line">    <span class="keyword">if</span> (status != <span class="string">&quot;已完成&quot;</span> &amp;&amp; status != <span class="string">&quot;已取消&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> query = <span class="string">$&quot;SELECT * FROM Win32_PrintJob WHERE Name LIKE &#x27;%<span class="subst">&#123;printerName&#125;</span>%&#x27;&quot;</span>;</span><br><span class="line">        <span class="keyword">using</span> (<span class="keyword">var</span> searcher = <span class="keyword">new</span> System.Management.ManagementObjectSearcher(query))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">foreach</span> (System.Management.ManagementObject job <span class="keyword">in</span> searcher.Get())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">int</span> JobId = Convert.ToInt32(job[<span class="string">&quot;JobId&quot;</span>]);</span><br><span class="line">                <span class="keyword">if</span> (JobId == taskId)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">try</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        job.Delete(); <span class="comment">// 删除打印任务</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">                    &#123;</span><br><span class="line">                        MessageBox.Show(<span class="string">&quot;删除打印任务失败：&quot;</span> + ex.Message, <span class="string">&quot;错误&quot;</span>, MessageBoxButtons.OK, MessageBoxIcon.Error);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    dgv.Rows.Remove(row);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-WebSocket-通信"><a href="#3-WebSocket-通信" class="headerlink" title="3. WebSocket 通信"></a>3. WebSocket 通信</h3><ul><li>Fleck 组件集成<br>使用 <code>Fleck</code> 实现 WebSocket 服务端，支持外部系统通过网络下发打印任务、查询状态、远程控制等。</li><li>消息协议设计<br>采用 JSON 协议，支持多种命令（如 <code>print</code>、<code>show</code>、<code>ping</code> 等），并能将打印结果、错误信息实时反馈给客户端。</li></ul><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">socket.OnMessage = message =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> msg = message?.Trim().ToLowerInvariant();</span><br><span class="line">    <span class="comment">// 处理不同的消息</span></span><br><span class="line">    <span class="keyword">if</span> (msg == <span class="string">&quot;ping&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 回复 pong</span></span><br><span class="line">        socket.Send(<span class="string">&quot;pong&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (msg == <span class="string">&quot;show&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 显示主窗体</span></span><br><span class="line">        <span class="keyword">this</span>.Invoke(() =&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.Show();</span><br><span class="line">            <span class="keyword">this</span>.WindowState = FormWindowState.Normal;</span><br><span class="line">            <span class="keyword">this</span>.ShowInTaskbar = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">this</span>.Activate();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (msg != <span class="literal">null</span> &amp;&amp; msg.TrimStart().StartsWith(<span class="string">&quot;&#123;&quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 反序列化为 JsonNode 便于动态访问</span></span><br><span class="line">        <span class="keyword">var</span> json = JsonNode.Parse(msg);</span><br><span class="line">        <span class="keyword">var</span> cmd = json?[<span class="string">&quot;cmd&quot;</span>]?.ToString();</span><br><span class="line">        <span class="built_in">string</span> requestId = json?[<span class="string">&quot;requestid&quot;</span>]?.ToString();</span><br><span class="line">        <span class="comment">//处理打印任务</span></span><br><span class="line">        <span class="keyword">if</span> (cmd == <span class="string">&quot;print&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 取出 printIniInfo 和 data</span></span><br><span class="line">            <span class="keyword">var</span> printIniInfo = json[<span class="string">&quot;data&quot;</span>]?[<span class="string">&quot;printiniinfo&quot;</span>];</span><br><span class="line">            <span class="keyword">var</span> data = json[<span class="string">&quot;data&quot;</span>]?[<span class="string">&quot;data&quot;</span>];</span><br><span class="line">            <span class="built_in">string</span> filePath = printIniInfo?[<span class="string">&quot;filepath&quot;</span>]?.ToString();</span><br><span class="line">            <span class="built_in">string</span> realName = printIniInfo?[<span class="string">&quot;realname&quot;</span>]?.ToString();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 获取来源IP和端口</span></span><br><span class="line">            <span class="built_in">string</span> clientIp = socket.ConnectionInfo.ClientIpAddress;</span><br><span class="line">            <span class="built_in">int</span> clientPort = socket.ConnectionInfo.ClientPort;</span><br><span class="line">            <span class="built_in">string</span> requestTime = DateTime.Now.ToString(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);</span><br><span class="line">            <span class="built_in">string</span> status = <span class="string">&quot;作业正在后台处理&quot;</span>;</span><br><span class="line">            <span class="comment">// 获取当前系统默认打印机</span></span><br><span class="line">            <span class="built_in">string</span> printerName = <span class="keyword">new</span> System.Drawing.Printing.PrinterSettings().PrinterName;</span><br><span class="line">            <span class="built_in">int</span> taskId = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">// 任务名称为当前时间</span></span><br><span class="line">            <span class="built_in">string</span> taskName = DateTime.Now.ToString(<span class="string">&quot;yyyyMMddHHmmssfff&quot;</span>);</span><br><span class="line">            <span class="comment">// 查找对应TabPage和DataGridView</span></span><br><span class="line">            <span class="keyword">this</span>.Invoke(() =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">foreach</span> (TabPage tab <span class="keyword">in</span> tabControl1.TabPages)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// 支持“(默认)”后缀</span></span><br><span class="line">                    <span class="keyword">if</span> (tab.Text.StartsWith(printerName))</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">var</span> dgv = tab.Controls.OfType&lt;DataGridView&gt;().FirstOrDefault();</span><br><span class="line">                        <span class="keyword">if</span> (dgv != <span class="literal">null</span>)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="built_in">int</span> rowIndex = dgv.Rows.Add(</span><br><span class="line">                                 <span class="string">$&quot;<span class="subst">&#123;clientIp&#125;</span>:<span class="subst">&#123;clientPort&#125;</span>&quot;</span>, <span class="comment">// 来源</span></span><br><span class="line">                                 taskId,                     <span class="comment">// 任务ID</span></span><br><span class="line">                                 taskName,                   <span class="comment">// 任务名称</span></span><br><span class="line">                                 realName,                   <span class="comment">// 模板</span></span><br><span class="line">                                 requestTime,                <span class="comment">// 开始时间</span></span><br><span class="line">                                 status                      <span class="comment">// 任务状态</span></span><br><span class="line">                             );</span><br><span class="line">                            <span class="keyword">var</span> row = dgv.Rows[rowIndex];</span><br><span class="line">                            row.Tag = <span class="keyword">new</span> PrintTaskInfo</span><br><span class="line">                            &#123;</span><br><span class="line">                                FilePath = filePath,</span><br><span class="line">                                Data = data</span><br><span class="line">                            &#125;;</span><br><span class="line">                            <span class="comment">// 添加后排序</span></span><br><span class="line">                            dgv.Sort(dgv.Columns[<span class="string">&quot;requestTime&quot;</span>], ListSortDirection.Descending);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">// 调用实际打印方法</span></span><br><span class="line">            <span class="keyword">this</span>.Invoke(() =&gt; PrintFile(filePath, data, taskName, socket, requestId));</span><br><span class="line"></span><br><span class="line">            <span class="comment">//监听打印机状态</span></span><br><span class="line">            StartMonitorPrintJob(printerName, taskId, taskName);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 处理其他cmd</span></span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;收到未知cmd: <span class="subst">&#123;cmd&#125;</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;收到未知消息: <span class="subst">&#123;message&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>异常处理与反馈<br>打印过程中如遇异常（如文件不存在、数据格式错误等），会捕获异常并通过 WebSocket 回复详细错误信息，便于外部系统及时处理。</li></ul><h3 id="4-打印文件类型支持"><a href="#4-打印文件类型支持" class="headerlink" title="4. 打印文件类型支持"></a>4. 打印文件类型支持</h3><ul><li>多格式兼容<br>支持 TXT、图片（JPG&#x2F;PNG&#x2F;BMP&#x2F;GIF）、PDF、FastReport 模板（FRX）等多种文件类型的打印。<br><img src="https://images.codeobservatory.cn/hexo/202506/14/2025061416305105.png" alt="C# WinForms 实现打印监听组件"><br><img src="https://images.codeobservatory.cn/hexo/202506/14/2025061416290206.png" alt="C# WinForms 实现打印监听组件"></li><li>模板数据绑定<br>对于报表类打印，支持将 JSON、DataTable、DataSet 等多种数据源动态绑定到模板，实现灵活的数据驱动打印。</li></ul><h3 id="5-用户体验优化"><a href="#5-用户体验优化" class="headerlink" title="5. 用户体验优化"></a>5. 用户体验优化</h3><ul><li>界面交互友好<br>采用右键菜单、弹窗提示、托盘集成等方式，提升用户操作便捷性。</li><li>错误提示与日志<br>所有关键操作均有明确的错误提示，便于用户定位问题；可扩展日志记录功能，方便后期维护。</li></ul><h2 id="四、总结"><a href="#四、总结" class="headerlink" title="四、总结"></a>四、总结</h2><p>打印监听组件通过对打印队列的实时监控、任务的精细化管理、与外部系统的高效集成，极大提升了企业打印自动化和可控性。其灵活的界面、丰富的功能和健壮的技术架构，适用于多种业务场景，值得在企业信息化建设中推广应用。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;一、组件简介&quot;&gt;&lt;a href=&quot;#一、组件简介&quot; class=&quot;headerlink&quot; title=&quot;一、组件简介&quot;&gt;&lt;/a&gt;一、组件简介&lt;/h2&gt;&lt;p&gt;打印监听组件是一款集成于 Windows 桌面环境的打印任务管理与监控工具，适用于企业级应用场景。它不仅支持</summary>
      
    
    
    
    <category term="后端开发" scheme="https://www.codeobservatory.cn/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="C#" scheme="https://www.codeobservatory.cn/tags/C/"/>
    
    <category term="WinForm" scheme="https://www.codeobservatory.cn/tags/WinForm/"/>
    
  </entry>
  
  <entry>
    <title>C#英文字母大小写转换方法</title>
    <link href="https://www.codeobservatory.cn/archives/bd7cb84f.html"/>
    <id>https://www.codeobservatory.cn/archives/bd7cb84f.html</id>
    <published>2025-06-13T02:33:07.000Z</published>
    <updated>2025-06-13T02:35:52.762Z</updated>
    
    <content type="html"><![CDATA[<p>在C#的编程开发过程中，有时候判断字符串是否相等时，并不关注字母的大小写，此时在C#中可以使用ToUpper方法将字符串中所有的字母转换为大写，使用ToLower方法可以将字符串中所有字母转换为小写。</p><p>例如有个字符串<code>string   testStr=“AbcDefg”</code>;</p><ol><li>转换为大写：<code>string UpTestStr=testStr.ToUpper();</code></li></ol><p>转换后UpTestStr结果为:<code>ABCDEFG</code></p><ol start="2"><li>转换为小写：<code>string LowTestStr=testStr.ToLower();</code></li></ol><p>转换后LowTestStr结果为：<code>abcdefg</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;在C#的编程开发过程中，有时候判断字符串是否相等时，并不关注字母的大小写，此时在C#中可以使用ToUpper方法将字符串中所有的字母转换为大写，使用ToLower方法可以将字符串中所有字母转换为小写。&lt;/p&gt;
&lt;p&gt;例如有个字符串&lt;code&gt;string   testStr</summary>
      
    
    
    
    <category term="后端开发" scheme="https://www.codeobservatory.cn/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="C#" scheme="https://www.codeobservatory.cn/tags/C/"/>
    
    <category term="大小写转换" scheme="https://www.codeobservatory.cn/tags/%E5%A4%A7%E5%B0%8F%E5%86%99%E8%BD%AC%E6%8D%A2/"/>
    
  </entry>
  
  <entry>
    <title>熬夜爆肝整理万字C#基础入门大总结【建议收藏】</title>
    <link href="https://www.codeobservatory.cn/archives/f71906c0.html"/>
    <id>https://www.codeobservatory.cn/archives/f71906c0.html</id>
    <published>2025-06-13T01:53:59.000Z</published>
    <updated>2025-06-13T02:20:58.349Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、C-介绍"><a href="#一、C-介绍" class="headerlink" title="一、C#介绍"></a>一、C#介绍</h2><p>源于c语言，简单易学，入门超快，减少了烦人的指针，有统一的操作符&#x2F;修饰符&#x2F;运算符，使用起来简洁称心。不仅如此：</p><ol><li>它是结构化语言，能产生高效率的程序</li><li>面向组件，开发快速</li><li>在多种计算机平台上编译，良好兼容性</li><li>优秀的版本管理控制，安装卸载和其他程序不影响</li><li>.Net框架一部分</li></ol><p>都是她被广泛应用的原因。</p><p>它不仅是按照面向对象设计的语言，而且还类型安全，还有更多让人舒心的功能：</p><ol><li>自动垃圾回收</li><li>属性、事件、委托等</li><li>标准库</li><li>简单多线程</li><li>Lambad表达式</li></ol><h2 id="二、-NET简介"><a href="#二、-NET简介" class="headerlink" title="二、.NET简介"></a>二、.NET简介</h2><p>.NET框架是一个集成、一个环境、一个非常强大的平台，是微软推出的核心技术。开发式的体系结构，覆盖的内容非常广：</p><p><img src="https://images.codeobservatory.cn/hexo/202506/13/f6f80e2f8650f8e2.png" alt="熬夜爆肝整理万字C#基础入门大总结【建议收藏】"></p><p>由上图看出.NET Framework是.NET最重要的核心技术。Framework提供了多语言开发，而C#是其中核心语言。</p><p><img src="https://images.codeobservatory.cn/hexo/202506/13/89893b5c0744d40.png" alt="熬夜爆肝整理万字C#基础入门大总结【建议收藏】"></p><h2 id="三、VS快捷键"><a href="#三、VS快捷键" class="headerlink" title="三、VS快捷键"></a>三、VS快捷键</h2><p>先来普及回顾下VS中的常用快捷键</p><p><code>Ctrl+K+D</code>:快速对齐代码</p><p><code>Ctrl+Z</code>:撤销</p><p><code>Ctrl+S</code>:保存(一定要经常保存！)</p><p><code>Ctrl+J</code>:快速弹出智能提示</p><p><code>Shift+End</code> 、<code>Shift+Home</code></p><p><code>Ctrl+K+C</code>:注释所选代码</p><p><code>Ctrl+K+U</code>:取消对所选代码的注释</p><p><code>F1</code>：转到帮助文档</p><p>折叠冗余代码：#Region 和#EndRegion（Android Studio也可以自定义折叠代码 &#x2F;&#x2F;region &#x2F;&#x2F;endregion 快捷键 Ctrl+Alt+T）</p><p>单行注释：&#x2F;&#x2F;</p><p>多行注释：&#x2F;要注释的内容&#x2F;</p><p>文档注释：&#x2F;&#x2F;&#x2F; 多用来解释类或者方法</p><p>四、数据类型</p><p>编程基础就不强调了，主要看看拼写和其他语言有什么不同就行了</p><p><img src="https://images.codeobservatory.cn/hexo/202506/13/24441e1ba047989c.png" alt="熬夜爆肝整理万字C#基础入门大总结【建议收藏】"></p><p>除了这些值类型还有引用类型，包含对象类型，动态类型，字符串类型</p><p>字符串类型：string或者String，注意s大小写，平时都能用，但也有小区别。</p><p>字符串有个@符号可以将转移字符当成普通字符，且@符会保留字符串里面的换行符空格符等</p><p>例：string str&#x3D;”D:\alibaba”; 等价于string str&#x3D;@”D:\alibaba”;</p><p>动态类型：dynami，他会根据内容自动存储对应类型</p><p>例：dynamic str&#x3D;”这是字符”; dynamic number&#x3D;10; 就像前端的var类型</p><p>对象类型：ogject，所有类型的最低基类，能分配任何类型的值，麻烦就是用的时候可能经常得进行类型转换。</p><p>五、转义字符</p><p><img src="https://images.codeobservatory.cn/hexo/202506/13/30e7809e9d4f3aee.png" alt="熬夜爆肝整理万字C#基础入门大总结【建议收藏】"></p><h2 id="六、运算符"><a href="#六、运算符" class="headerlink" title="六、运算符"></a>六、运算符</h2><p>仍然是直接上表格图，编程基础。</p><p><img src="https://images.codeobservatory.cn/hexo/202506/13/13150c9da862dd13.png" alt="熬夜爆肝整理万字C#基础入门大总结【建议收藏】"><br><img src="https://images.codeobservatory.cn/hexo/202506/13/bab1bb498a3574f1.png" alt="熬夜爆肝整理万字C#基础入门大总结【建议收藏】"><br><img src="https://images.codeobservatory.cn/hexo/202506/13/e66f7ceff8b79d5b.png" alt="熬夜爆肝整理万字C#基础入门大总结【建议收藏】"><br><img src="https://images.codeobservatory.cn/hexo/202506/13/8fcd6bdd282b13b0.png" alt="熬夜爆肝整理万字C#基础入门大总结【建议收藏】"></p><h2 id="七、判断-循环"><a href="#七、判断-循环" class="headerlink" title="七、判断&#x2F;循环"></a>七、判断&#x2F;循环</h2><p>逻辑判断仍然是编程老鸟的基基础，只是简单概括一下</p><ul><li>判断语句：<code>if else switch</code></li><li>循环语句：<code>while for foreach do…while break continue</code></li></ul><h2 id="八、访问修饰符"><a href="#八、访问修饰符" class="headerlink" title="八、访问修饰符"></a>八、访问修饰符</h2><p>C#可以设置使用者的访问权限，这样开发者可以指定该模块或逻辑是公开，封闭，还是指定访问者。不知道其他语言什么样，跟Java是一样样的。</p><ol><li>public：所有对象都可以访问；</li><li>private：对象本身在对象内部可以访问；</li><li>protected：只有该类对象及其子类对象可以访问</li><li>internal：同一个程序集的对象可以访问；</li><li>protected internal：访问限于当前程序集或派生自包含类的类型。</li></ol><h2 id="九、可变类型-合并运算符"><a href="#九、可变类型-合并运算符" class="headerlink" title="九、可变类型&#x2F;合并运算符"></a>九、可变类型&#x2F;合并运算符</h2><ul><li>可空类型（Nullable）：表示其基础类型除了默认的值外，再添加一个null值。例如：<code>int? num = 1; double? num= new double?();</code></li><li>Null合并运算符（？？）：如果第一个操作数为null，则返回第二个操作数，否则返回第一个，就像Java的？：运算。</li></ul><p>例如 A&#x3D;B??C 如果B为空则将C赋值给A，如果B 不为空则将B赋值给A。</p><h2 id="十、数组"><a href="#十、数组" class="headerlink" title="十、数组"></a>十、数组</h2><p>数组类型是若干个数据类型相同的数据元素组成的数据结构。C#也是分为一维数组和多维数组，多维数组又包括矩形数组和交错数据。<br>还有一个参数数组，可以传递未知数量参数给函数。这个就像Java中的(int… num)。</p><p>例:</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ParamArray app = <span class="keyword">new</span> ParamArray();</span><br><span class="line"><span class="built_in">int</span> sum = app.AddElements(<span class="number">512</span>, <span class="number">720</span>, <span class="number">250</span>, <span class="number">567</span>, <span class="number">889</span>);</span><br></pre></td></tr></table></figure><p>数组类型基本是System.Array类的派生类，快捷键Ctrl+左键进入源码，快速学习都有什么功能实现。</p><h2 id="十一、结构体"><a href="#十一、结构体" class="headerlink" title="十一、结构体"></a>十一、结构体</h2><p>它能用单一变量存储多个数据类型，举例：一个书变量，可以存作者，标题，出版社，价钱等基础变量。超好理解，和Java的实体一样，就是需要<code>struct</code>关键字来修饰创建结构体。特点：</p><ol><li>结构可带有方法、字段、索引、属性、运算符方法和事件。</li><li>结构可定义构造函数，但不能定义析构函数。但是，您不能为结构定义无参构造函数。无参构造函数 (默认)是自动定义的，且不能被改变。</li><li>与类不同，结构不能继承其他的结构或类。</li><li>结构不能作为其他结构或类的基础结构。</li><li>结构可实现一个或多个接口。</li><li>结构成员不能指定为 abstract、virtual 或 protected。</li><li>当您使用 New 操作符创建一个结构对象时，会调用适当的构造函数来创建结构。与类不同，结构可以不使用 New 操作符即可被实例化。</li><li>如果不使用 New 操作符，只有在所有的字段都被初始化之后，字段才被赋值，对象才被使用。</li><li>结构体的字段可以加前缀”_”来和变量区分</li><li>结构体快捷键：首选选中你要自动完成的变量，先按ctrl+R,再按ctrl+E这两个组合键，可以自动生成属性中的get和set方法</li></ol><h2 id="十二、枚举"><a href="#十二、枚举" class="headerlink" title="十二、枚举"></a>十二、枚举</h2><p>就是命名一组整型常量，不能继承或传递继承，只能当常量使用。举例：<code>enum Number&#123;one,two,three&#125;</code>; 则Number.one等于0 Number.two等于1，以此类推枚举可以和结构体结合：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> Person&#123;        </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">string</span> _name;<span class="comment">//字段        </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">int</span> _age;        </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> Gender _gender;    </span><br><span class="line"></span><br><span class="line">&#125;    </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">enum</span> Gender   &#123;         男,        女&#125;</span><br><span class="line"></span><br><span class="line">Person zsPerson;</span><br><span class="line"></span><br><span class="line">zsPerson._name = <span class="string">&quot;张三&quot;</span>;</span><br><span class="line"></span><br><span class="line">zsPerson._age = <span class="number">21</span>;</span><br><span class="line"></span><br><span class="line">zsPerson._gender = Gender.男;</span><br></pre></td></tr></table></figure><h2 id="十三、类-函数"><a href="#十三、类-函数" class="headerlink" title="十三、类&#x2F;函数"></a>十三、类&#x2F;函数</h2><p>类仍然是<code>class</code>修饰，在class前面可以指定对类及成员的访问规则，若没写则类默认是<code>internal</code>，成员访问是<code>private</code>。</p><p>例：<code>public class ClassName &#123; &#125;</code></p><p>函数和Java同样含有构造函数和带参函数，在这多了一个析构函数，是一个特殊的成员函数。是一个新知识需要记一下。</p><p>析构函数以~作为前缀，不需要任何修饰符，不返回值，也不带参数，不能继承或重载。官方文档大致意思就是用来释放资源的，只不过并非是在不使用的时候立即释放，它是懒惰的，垃圾回收机制会在适当的时候回收，比如内存紧张，关闭程序等时候。这和Android里面的onDestory有异曲同工之妙，同样的，也有GC方法来强制回收。</p><h2 id="十四、继承-多重继承"><a href="#十四、继承-多重继承" class="headerlink" title="十四、继承&#x2F;多重继承"></a>十四、继承&#x2F;多重继承</h2><p>继承是面向对象设计的最重要概念之一，一个类继承自另一个类，举例：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">A</span>&#123; &#125; </span><br><span class="line"><span class="keyword">class</span> <span class="title">B</span>:<span class="title">A</span>&#123; &#125; </span><br></pre></td></tr></table></figure><p>B继承自A，B可以称为派生类也可以称为子类，A可以称为基类也可以称为父类。（派生类和基类，子类和父类） 。B拥有访问A的能力，形象点说就是子类可以拿到父类的财产，父类拿不到子类的财产。</p><p>C#不支持多重继承，我咨询过C++同事，C++支持多重继承。</p><h2 id="十五、多态"><a href="#十五、多态" class="headerlink" title="十五、多态"></a>十五、多态</h2><p>面向对象程序的核心功能之一，是同一个行为具有多个不同表现的能力。C#和Java都是面向对象的，它们的多态思想基本是一致的。优点多多：</p><ol><li>消除类型间耦合关系</li><li>具有可扩充性，增强灵活性</li><li>接口性，实现简单</li></ol><p>C#包含静态多态和动态多态，静态多态又包含：函数重载和运算符重载。</p><p>函数重载：就是相同的函数名有多个定义。函数的参数类型或个数不同来实现。例如：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="built_in">int</span> <span class="title">test</span>(<span class="params"><span class="built_in">int</span> num1</span>)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="built_in">int</span> <span class="title">test</span>(<span class="params"><span class="built_in">int</span> num1,<span class="built_in">int</span> num2</span>)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="built_in">int</span> <span class="title">test</span>(<span class="params"><span class="built_in">int</span> num1,<span class="built_in">string</span> str1</span>)</span>&#123;&#125;</span><br></pre></td></tr></table></figure><p>运算符重载看示例更形象，但是示例代码多，就不在这记了，感兴趣的可以自己去搜索学习</p><p>动态重载使用的是用<code>abstract</code>创建的抽象类，另一个是借助关键字<code>virtual</code>修饰的虚方法类似实现。示例：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Test</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title">Shape</span></span><br><span class="line">   &#123;</span><br><span class="line">       <span class="function"><span class="keyword">abstract</span> <span class="keyword">public</span> <span class="built_in">int</span> <span class="title">area</span>()</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">class</span> <span class="title">Rectangle</span>:  <span class="title">Shape</span></span><br><span class="line">   &#123;</span><br><span class="line">      <span class="keyword">private</span> <span class="built_in">int</span> length;</span><br><span class="line">      <span class="keyword">private</span> <span class="built_in">int</span> width;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="title">Rectangle</span>(<span class="params"> <span class="built_in">int</span> a=<span class="number">0</span>, <span class="built_in">int</span> b=<span class="number">0</span></span>)</span></span><br><span class="line">      &#123;</span><br><span class="line">         length = a;</span><br><span class="line">         width = b;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="comment">//注意着的override</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">int</span> <span class="title">area</span> ()</span></span><br><span class="line">      &#123;</span><br><span class="line">         Console.WriteLine(<span class="string">&quot;Rectangle 类的面积：&quot;</span>);</span><br><span class="line">         <span class="keyword">return</span> (width * length);</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">class</span> <span class="title">RectangleTester</span></span><br><span class="line">   &#123;</span><br><span class="line">      <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>)</span></span><br><span class="line">      &#123;</span><br><span class="line">         Rectangle r = <span class="keyword">new</span> Rectangle(<span class="number">10</span>, <span class="number">7</span>);</span><br><span class="line">         <span class="built_in">double</span> a = r.area();</span><br><span class="line">         Console.WriteLine(<span class="string">&quot;面积：&#123;0&#125;&quot;</span>,a);</span><br><span class="line">         Console.ReadKey();</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//虚方法示例</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Test</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">class</span> <span class="title">Shape</span></span><br><span class="line">   &#123;</span><br><span class="line">      <span class="keyword">protected</span> <span class="built_in">int</span> width, height;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="title">Shape</span>(<span class="params"> <span class="built_in">int</span> a=<span class="number">0</span>, <span class="built_in">int</span> b=<span class="number">0</span></span>)</span></span><br><span class="line">      &#123;</span><br><span class="line">         width = a;</span><br><span class="line">         height = b;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 关键字virtual</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="built_in">int</span> <span class="title">area</span>()</span></span><br><span class="line">      &#123;</span><br><span class="line">         Console.WriteLine(<span class="string">&quot;父类的面积：&quot;</span>);</span><br><span class="line">         <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">class</span> <span class="title">Rectangle</span>: <span class="title">Shape</span></span><br><span class="line">   &#123;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="title">Rectangle</span>(<span class="params"> <span class="built_in">int</span> a=<span class="number">0</span>, <span class="built_in">int</span> b=<span class="number">0</span></span>): <span class="title">base</span>(<span class="params">a, b</span>)</span></span><br><span class="line">      &#123;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">int</span> <span class="title">area</span> ()</span></span><br><span class="line">      &#123;</span><br><span class="line">         Console.WriteLine(<span class="string">&quot;Rectangle 类的面积：&quot;</span>);</span><br><span class="line">         <span class="keyword">return</span> (width * height);</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">class</span> <span class="title">Triangle</span>: <span class="title">Shape</span></span><br><span class="line">   &#123;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="title">Triangle</span>(<span class="params"><span class="built_in">int</span> a = <span class="number">0</span>, <span class="built_in">int</span> b = <span class="number">0</span></span>): <span class="title">base</span>(<span class="params">a, b</span>)</span></span><br><span class="line">      &#123;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">int</span> <span class="title">area</span>()</span></span><br><span class="line">      &#123;</span><br><span class="line">         Console.WriteLine(<span class="string">&quot;Triangle 类的面积：&quot;</span>);</span><br><span class="line">         <span class="keyword">return</span> (width * height / <span class="number">2</span>);</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="keyword">class</span> <span class="title">Tester</span></span><br><span class="line">   &#123;</span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>)</span></span><br><span class="line">      &#123;</span><br><span class="line">         Rectangle r = <span class="keyword">new</span> Rectangle(<span class="number">10</span>, <span class="number">7</span>);</span><br><span class="line">         Triangle t = <span class="keyword">new</span> Triangle(<span class="number">10</span>, <span class="number">5</span>);</span><br><span class="line">         c. area ();</span><br><span class="line">         c. area ();</span><br><span class="line">         Console.ReadKey();</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="十六、接口"><a href="#十六、接口" class="headerlink" title="十六、接口"></a>十六、接口</h2><p>接口使用<code>interface</code>关键字声明，和类class的声明差不多，默认是public类型的。但是当有多个类，多个类有多个相同的方法，使用接口来实现方便管理，且不会丢失。和Java使用基本是一致的。示例：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title">ITestInterface</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">TestInterfaceMethod</span>()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Test</span> : <span class="title">ITestInterface</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">TestInterfaceMethod</span>()</span>    </span><br><span class="line">    &#123;  </span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="十七、命名空间"><a href="#十七、命名空间" class="headerlink" title="十七、命名空间"></a>十七、命名空间</h2><p><code>Namespace</code>这玩意就是用来方便管理的，而且在计算机中相同的设计思想到处可见，比如同一个文件夹下不能有同名的文件，你放在不同文件夹下可以有同名文件。<br>其他编程语言比如Java有包路径，不同路径名字可以有同名的类。这种思想方便管理文件&#x2F;代码。</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">first_space</span>&#123;  </span><br><span class="line"></span><br><span class="line"> <span class="keyword">class</span> <span class="title">namespace_cl</span>   &#123;   &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//比如这样，程序是会报错的  </span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">class</span> <span class="title">namespace_cl</span>   &#123;   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//但是你是下面的状态就不会报错</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">first_space</span>&#123;  </span><br><span class="line"></span><br><span class="line"> <span class="keyword">class</span> <span class="title">namespace_cl</span>   &#123;   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">second_space</span>&#123; </span><br><span class="line"></span><br><span class="line">  <span class="keyword">class</span> <span class="title">namespace_cl</span>   &#123; &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>到这有的人就开始有疑问了：如果是不同的文件或者想访问其他的空间怎么办呢？</p><p>细心的已经发现了，就和Java的导包一样，C#使用using导入空间，在每个编程文件的最上面几行都是这样的引入，想要哪些空间的功能导入哪个。</p><p>这时候又有人有疑问了，能不能修仙小说那样天外有天，天上还有天。能不能命名空间套命名空间，套套套，此处禁止套娃。</p><p>答案是可以的，引入的时候：<code>using namespaceone.namespacetwo</code> 用英文符号<code>.</code>即可，跟Java包路径同理。</p><h2 id="十八、预处理器"><a href="#十八、预处理器" class="headerlink" title="十八、预处理器"></a>十八、预处理器</h2><p>从字面理解就是提前对信息进行处理。她确实也是这样的，她会根据你指定的条件，只编译满足条件的代码，不满足条件的代码不编译。既区分了软件版本，代码还在一块，管理方便。预处理指令是#开始的，且只能作为开头，一般指令单独占一行。都有哪些指令在这就不单独写了。在Unity中指令挺有用的，因为PC是键盘，Android事件是手势，用预处理提前写好不同端的不同实现代码（当然它们功能可能是一致的），打包发布的时候利人利己。</p><h2 id="十九、异常"><a href="#十九、异常" class="headerlink" title="十九、异常"></a>十九、异常</h2><ul><li><code>try</code>：一个 try 块标识了一个将被激活的特定的异常的代码块。后跟一个或多个 catch 块。</li><li><code>catch</code>：程序通过异常处理程序捕获异常。catch 关键字表示异常的捕获。</li><li><code>finally</code>：finally 块用于执行给定的语句，不管异常是否被抛出都会执行。例如，如果您打开一个文件，不管是否出现异常文件都要被关闭。</li><li><code>throw</code>：当问题出现时，程序抛出一个异常。使用 throw 关键字来完成。</li></ul><h2 id="二十、反射"><a href="#二十、反射" class="headerlink" title="二十、反射"></a>二十、反射</h2><p>通俗的讲就是可以访问一个类的所有属性和方法，且能够调用。有人提问了：随便写的public类不都是能任意访问调用的吗，这有什么区别？</p><p>区别在于一个是正常写代码，你知道代码逻辑和内容，且都在你的掌控之内，当然能访问；而反射不同它能够访问你不清楚的类，比如三方框架你遇到这个框架里某个类某个方法没有对外开放，而你又需要使用，就可以用反射把它抛出来。</p><p><strong>优点</strong>：</p><ol><li>反射提高了程序的灵活性和扩展性。</li><li>降低耦合性，提高自适应能力。</li><li>它允许程序创建和控制任何类的对象，无需提前编码目标类。</li></ol><p><strong>缺点</strong>：</p><ol><li>性能问题：使用反射基本上是一种解释操作，用于字段和方法接入时要远慢于直接代码。因此反射机制主要应用在对灵活性和拓展性要求很高的系统框架上，普通程序不建议使用。</li><li>使用反射会模糊程序内部逻辑；程序员希望在源代码中看到程序的逻辑，反射却绕过了源代码的技术，因而会带来维护的问题，反射代码比相应的直接代码更复杂。</li></ol><h2 id="二十一、属性"><a href="#二十一、属性" class="headerlink" title="二十一、属性"></a>二十一、属性</h2><p>get&#x2F;set方法,没什么可讲的。</p><h2 id="二十二、委托"><a href="#二十二、委托" class="headerlink" title="二十二、委托"></a>二十二、委托</h2><p>使用关键字<code>delegate</code>来修饰，必须用new关键字来创建，且与某个特定方法关联。</p><p>比较官方的说法：表示对具有特定参数列表和返回类型的方法的引用。通过委托，可以将方法视为可分配给变量并可作为参数传递的实体。委托还类似于其他一些语言中存在的“函数指针”概念。与函数指针不同，委托是面向对象且类型安全的。</p><p>按照自己的理解：委托就是包一个外壳，操作外壳就是调用壳内的内容。就好像老板让你板砖，你委托给另一个人让她板砖。这就是委托。</p><p>委托中还能通过加减号来实现多个，称之为多播。只有相同类型的委托可以合并。</p><p>使用场景：因刚需C#没什么实际经验，大家知道有什么好的实际应用环境吗?</p><p>委托示例：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//这个是声明个委托</span></span><br><span class="line">    <span class="function"><span class="built_in">delegate</span> <span class="built_in">int</span> <span class="title">NumberChanger</span>(<span class="params"><span class="built_in">int</span> n</span>)</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">int</span> num = <span class="number">10</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">AddNum</span>(<span class="params"><span class="built_in">int</span> p</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        num += p;</span><br><span class="line">        <span class="keyword">return</span> num;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">MultNum</span>(<span class="params"><span class="built_in">int</span> q</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        num *= q;</span><br><span class="line">        <span class="keyword">return</span> num;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 创建委托实例</span></span><br><span class="line">        NumberChanger nc;</span><br><span class="line">        NumberChanger nc1 = <span class="keyword">new</span> NumberChanger(AddNum);</span><br><span class="line">        NumberChanger nc2 = <span class="keyword">new</span> NumberChanger(MultNum);</span><br><span class="line">        <span class="comment">// 使用委托对象调用方法</span></span><br><span class="line">        nc1(<span class="number">25</span>);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Value of Num: &#123;0&#125;&quot;</span>, num);</span><br><span class="line">        nc2(<span class="number">5</span>);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Value of Num: &#123;0&#125;&quot;</span>, num);</span><br><span class="line">        <span class="comment">//下面是组播 使用  +或- 符号操作</span></span><br><span class="line">        nc = nc1;</span><br><span class="line">        nc += nc2;</span><br><span class="line">        <span class="comment">// 调用多播</span></span><br><span class="line">        nc(<span class="number">5</span>);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Value of Num: &#123;0&#125;&quot;</span>, num);</span><br><span class="line">        Console.ReadKey();</span><br><span class="line">       <span class="comment">//输出结果为：</span></span><br><span class="line">            <span class="comment">//Value of Num: 35</span></span><br><span class="line">            <span class="comment">//Value of Num: 175</span></span><br><span class="line">            <span class="comment">//Value of Num: 75</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">这篇文章详细介绍了C#基础入门知识 ，涵盖了C#语言的特点、.NET框架简介、Visual Studio快捷键、数据类型、转义字符、运算符、判断与循环语句、访问修饰符、可空类型与合并运算符、数组、结构体、枚举、类与函数、继承与多重继承、多态性以及接口等内容，文章不仅讲解了C#语言的基础语法和特性，还通过实例展示了如何在实际编程中应用这些 知识，帮助读者快速掌握C#编程的核心要点，适合初学者和希望巩固基础的开发者阅读。</summary>
    
    
    
    <category term="后端开发" scheme="https://www.codeobservatory.cn/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="C#" scheme="https://www.codeobservatory.cn/tags/C/"/>
    
    <category term="入门" scheme="https://www.codeobservatory.cn/tags/%E5%85%A5%E9%97%A8/"/>
    
    <category term="总结" scheme="https://www.codeobservatory.cn/tags/%E6%80%BB%E7%BB%93/"/>
    
  </entry>
  
  <entry>
    <title>C#读取Excel文件的几种方法【总结整理】</title>
    <link href="https://www.codeobservatory.cn/archives/6673646b.html"/>
    <id>https://www.codeobservatory.cn/archives/6673646b.html</id>
    <published>2025-06-13T01:46:16.000Z</published>
    <updated>2025-06-13T01:52:10.447Z</updated>
    
    <content type="html"><![CDATA[<h2 id="方法一：采用OleDB读取EXCEL文件"><a href="#方法一：采用OleDB读取EXCEL文件" class="headerlink" title="方法一：采用OleDB读取EXCEL文件"></a>方法一：采用OleDB读取EXCEL文件</h2><p>把EXCEL文件当做一个数据源来进行数据的读取操作，实例如下：    </p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> DataSet <span class="title">ExcelToDS</span>(<span class="params"><span class="built_in">string</span> Path</span>)</span> &#123; </span><br><span class="line">    <span class="built_in">string</span> strConn = <span class="string">&quot;Provider=Microsoft.Jet.OLEDB.4.0;&quot;</span> +<span class="string">&quot;Data Source=&quot;</span>+ Path +<span class="string">&quot;;&quot;</span>+<span class="string">&quot;Extended Properties=Excel 8.0;&quot;</span>; </span><br><span class="line">    OleDbConnection conn = <span class="keyword">new</span> OleDbConnection(strConn); </span><br><span class="line">    conn.Open();   </span><br><span class="line">    <span class="built_in">string</span> strExcel = <span class="string">&quot;&quot;</span>;    </span><br><span class="line">    OleDbDataAdapter myCommand = <span class="literal">null</span>; </span><br><span class="line">    DataSet ds = <span class="literal">null</span>; </span><br><span class="line">    strExcel=<span class="string">&quot;select * from [sheet1$]&quot;</span>; </span><br><span class="line">    myCommand = <span class="keyword">new</span> OleDbDataAdapter(strExcel, strConn); </span><br><span class="line">    ds = <span class="keyword">new</span> DataSet(); </span><br><span class="line">    myCommand.Fill(ds,<span class="string">&quot;table1&quot;</span>);    </span><br><span class="line">    <span class="keyword">return</span> ds; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对于EXCEL中的表即sheet([sheet1$])如果不是固定的可以使用下面的方法得到    </p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> strConn = <span class="string">&quot;Provider=Microsoft.Jet.OLEDB.4.0;&quot;</span> +<span class="string">&quot;Data Source=&quot;</span>+ Path +<span class="string">&quot;;&quot;</span>+<span class="string">&quot;Extended Properties=Excel 8.0;&quot;</span>; </span><br><span class="line">OleDbConnection conn = <span class="keyword">new</span> OleDbConnection(strConn); </span><br><span class="line">DataTable schemaTable = objConn.GetOleDbSchemaTable(System.Data.OleDb.OleDbSchemaGuid.Tables,<span class="literal">null</span>); </span><br><span class="line"><span class="built_in">string</span> tableName=schemaTable.Rows[<span class="number">0</span>][<span class="number">2</span>].ToString().Trim();</span><br></pre></td></tr></table></figure><p>另外：也可进行写入EXCEL文件，实例如下：  </p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DSToExcel</span>(<span class="params"><span class="built_in">string</span> Path,DataSet oldds</span>)</span> &#123; </span><br><span class="line">    <span class="comment">//先得到汇总EXCEL的DataSet 主要目的是获得EXCEL在DataSet中的结构     string strCon = &quot; Provider = Microsoft.Jet.OLEDB.4.0 ;</span></span><br><span class="line">    Data Source =<span class="string">&quot;+path1+&quot;</span>;Extended Properties=Excel <span class="number">8.0</span><span class="string">&quot;; </span></span><br><span class="line"><span class="string">    OleDbConnection myConn = new OleDbConnection(strCon);</span></span><br><span class="line"><span class="string">    string strCom=&quot;</span><span class="keyword">select</span> * <span class="keyword">from</span> [Sheet1$]<span class="string">&quot;; </span></span><br><span class="line"><span class="string">    myConn.Open();</span></span><br><span class="line"><span class="string">    OleDbDataAdapter myCommand = new OleDbDataAdapter ( strCom, myConn ); </span></span><br><span class="line"><span class="string">    ystem.Data.OleDb.OleDbCommandBuilder builder=new OleDbCommandBuilder(myCommand); </span></span><br><span class="line"><span class="string">    //QuotePrefix和QuoteSuffix主要是对builder生成InsertComment命令时使用。     builder.QuotePrefix=&quot;</span>[<span class="string">&quot;;     //获取insert语句中保留字符（起始位置）     builder.QuoteSuffix=&quot;</span>]<span class="string">&quot;; //获取insert语句中保留字符（结束位置）     DataSet newds=new DataSet(); </span></span><br><span class="line"><span class="string">    myCommand.Fill(newds ,&quot;</span>Table1<span class="string">&quot;) ; </span></span><br><span class="line"><span class="string">    for(int i=0;i&lt;oldds.Tables[0].Rows.Count;i++) &#123; </span></span><br><span class="line"><span class="string">        //在这里不能使用ImportRow方法将一行导入到news中，因为ImportRow将保留原来DataRow的所有设置(DataRowState状态不变)。</span></span><br><span class="line"><span class="string">        // 在使用ImportRow后newds内有值，但不能更新到Excel中因为所有导入行的DataRowState!=Added         DataRow nrow=aDataSet.Tables[&quot;</span>Table1<span class="string">&quot;].NewRow(); </span></span><br><span class="line"><span class="string">        for(int j=0;j&lt;newds.Tables[0].Columns.Count;j++)&#123; </span></span><br><span class="line"><span class="string">            nrow[j]=oldds.Tables[0].Rows[i][j];</span></span><br><span class="line"><span class="string">        &#125; </span></span><br><span class="line"><span class="string">        newds.Tables[&quot;</span>Table1<span class="string">&quot;].Rows.Add(nrow); </span></span><br><span class="line"><span class="string">    &#125; </span></span><br><span class="line"><span class="string">    myCommand.Update(newds,&quot;</span>Table1<span class="string">&quot;); </span></span><br><span class="line"><span class="string">    myConn.Close(); </span></span><br><span class="line"><span class="string">&#125; </span></span><br></pre></td></tr></table></figure><h2 id="方法二：引用的com组件：Microsoft-Office-Interop-Excel-dll读取EXCEL文件"><a href="#方法二：引用的com组件：Microsoft-Office-Interop-Excel-dll读取EXCEL文件" class="headerlink" title="方法二：引用的com组件：Microsoft.Office.Interop.Excel.dll读取EXCEL文件"></a>方法二：引用的com组件：Microsoft.Office.Interop.Excel.dll读取EXCEL文件</h2><p>首先是Excel.dll的获取,将Office安装目录下的Excel.exe文件Copy到DotNet的bin目录下,cmd到该目录下,运行 TlbImp EXCEL.EXE Excel.dll 得到Dll文件。 再在项目中添加引用该dll文件.</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//读取EXCEL的方法   (用范围区域读取数据)private void OpenExcel(string strFileName)&#123;    object missing = System.Reflection.Missing.Value;</span></span><br><span class="line">    Application excel = <span class="keyword">new</span> Application();<span class="comment">//lauch excel application</span></span><br><span class="line">    <span class="keyword">if</span> (excel == <span class="literal">null</span>)&#123;</span><br><span class="line">        Response.Write(<span class="string">&quot;&lt;script&gt;alert(&#x27;Can&#x27;t access excel&#x27;)&lt;/script&gt;&quot;</span>);</span><br><span class="line">    &#125;    <span class="keyword">else</span>&#123;</span><br><span class="line">        excel.Visible = <span class="literal">false</span>; excel.UserControl = <span class="literal">true</span>;        <span class="comment">// 以只读的形式打开EXCEL文件</span></span><br><span class="line">        Workbook wb = excel.Application.Workbooks.Open(strFileName, missing, <span class="literal">true</span>, missing, missing, missing,</span><br><span class="line">         missing, missing, missing, <span class="literal">true</span>, missing, missing, missing, missing, missing);        <span class="comment">//取得第一个工作薄</span></span><br><span class="line">        Worksheet ws = (Worksheet)wb.Worksheets.get_Item(<span class="number">1</span>); </span><br><span class="line">        <span class="comment">//取得总记录行数   (包括标题列)</span></span><br><span class="line">        <span class="built_in">int</span> rowsint = ws.UsedRange.Cells.Rows.Count; <span class="comment">//得到行数</span></span><br><span class="line">        <span class="comment">//int columnsint = mySheet.UsedRange.Cells.Columns.Count;//得到列数</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">        <span class="comment">//取得数据范围区域 (不包括标题列) </span></span><br><span class="line">        Range rng1 = ws.Cells.get_Range(<span class="string">&quot;B2&quot;</span>, <span class="string">&quot;B&quot;</span> + rowsint);   <span class="comment">//item</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">        Range rng2 = ws.Cells.get_Range(<span class="string">&quot;K2&quot;</span>, <span class="string">&quot;K&quot;</span> + rowsint); <span class="comment">//Customer</span></span><br><span class="line">        <span class="built_in">object</span>[,] arryItem= (<span class="built_in">object</span>[,])rng1.Value2;   <span class="comment">//get range&#x27;s value</span></span><br><span class="line">        <span class="built_in">object</span>[,] arryCus = (<span class="built_in">object</span>[,])rng2.Value2;   </span><br><span class="line">        <span class="comment">//将新值赋给一个数组</span></span><br><span class="line">        <span class="built_in">string</span>[,] arry = <span class="keyword">new</span> <span class="built_in">string</span>[rowsint<span class="number">-1</span>, <span class="number">2</span>];        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">1</span>; i &lt;= rowsint<span class="number">-1</span>; i++)&#123;            <span class="comment">//Item_Code列</span></span><br><span class="line">            arry[i - <span class="number">1</span>, <span class="number">0</span>] =arryItem[i, <span class="number">1</span>].ToString();            <span class="comment">//Customer_Name列</span></span><br><span class="line">            arry[i - <span class="number">1</span>, <span class="number">1</span>] = arryCus[i, <span class="number">1</span>].ToString();</span><br><span class="line">        &#125;</span><br><span class="line">        Response.Write(arry[<span class="number">0</span>, <span class="number">0</span>] + <span class="string">&quot; / &quot;</span> + arry[<span class="number">0</span>, <span class="number">1</span>] + <span class="string">&quot;#&quot;</span> + arry[rowsint - <span class="number">2</span>, <span class="number">0</span>] + <span class="string">&quot; / &quot;</span> + arry[rowsint - <span class="number">2</span>, <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">     excel.Quit(); excel = <span class="literal">null</span>;</span><br><span class="line">    Process[] procs = Process.GetProcessesByName(<span class="string">&quot;excel&quot;</span>); </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">foreach</span> (Process pro <span class="keyword">in</span> procs)&#123;</span><br><span class="line">        pro.Kill();<span class="comment">//没有更好的方法,只有杀掉进程</span></span><br><span class="line">    &#125;</span><br><span class="line">    GC.Collect();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="方法三：将EXCEL文件转化成CSV（逗号分隔）的文件，用文件流读取-等价就是读取一个txt文本文件-。"><a href="#方法三：将EXCEL文件转化成CSV（逗号分隔）的文件，用文件流读取-等价就是读取一个txt文本文件-。" class="headerlink" title="方法三：将EXCEL文件转化成CSV（逗号分隔）的文件，用文件流读取(等价就是读取一个txt文本文件)。"></a>方法三：将EXCEL文件转化成CSV（逗号分隔）的文件，用文件流读取(等价就是读取一个txt文本文件)。</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">先引用命名空间:<span class="keyword">using</span> System.Text;和<span class="keyword">using</span> System.IO;</span><br><span class="line">FileStream fs = <span class="keyword">new</span> FileStream(<span class="string">&quot;d:\\Customer.csv&quot;</span>, FileMode.Open, FileAccess.Read, FileShare.None);</span><br><span class="line">StreamReader sr = <span class="keyword">new</span> StreamReader(fs, System.Text.Encoding.GetEncoding(<span class="number">936</span>)); </span><br><span class="line"><span class="built_in">string</span> str = <span class="string">&quot;&quot;</span>;<span class="built_in">string</span> s = Console.ReadLine();<span class="keyword">while</span> (str != <span class="literal">null</span>)&#123;</span><br><span class="line">    str = sr.ReadLine();    <span class="built_in">string</span>[] xu = <span class="keyword">new</span> String[<span class="number">2</span>];</span><br><span class="line">    xu = str.Split(<span class="string">&#x27;,&#x27;</span>);    <span class="built_in">string</span> ser = xu[<span class="number">0</span>]; </span><br><span class="line">    <span class="built_in">string</span> dse = xu[<span class="number">1</span>];    <span class="keyword">if</span> (ser == s)&#123;</span><br><span class="line">        Console.WriteLine(dse);<span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">sr.Close();</span><br></pre></td></tr></table></figure><p>另外也可以将数据库数据导入到一个txt文件，实例如下：  </p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//txt文件名string fn = DateTime.Now.ToString(&quot;yyyyMMddHHmmss&quot;) + &quot;-&quot; + &quot;PO014&quot; + &quot;.txt&quot;;</span></span><br><span class="line"> </span><br><span class="line">OleDbConnection con = <span class="keyword">new</span> OleDbConnection(conStr); </span><br><span class="line">con.Open();<span class="built_in">string</span> sql = <span class="string">&quot;select ITEM,REQD_DATE,QTY,PUR_FLG,PO_NUM from TSD_PO014&quot;</span>;        <span class="comment">//OleDbCommand mycom = new OleDbCommand(&quot;select * from TSD_PO014&quot;, mycon);//OleDbDataReader myreader = mycom.ExecuteReader(); //也可以用Reader读取数据DataSet ds = new DataSet();</span></span><br><span class="line">OleDbDataAdapter oda = <span class="keyword">new</span> OleDbDataAdapter(sql, con);</span><br><span class="line">oda.Fill(ds, <span class="string">&quot;PO014&quot;</span>);</span><br><span class="line">DataTable dt = ds.Tables[<span class="number">0</span>];</span><br><span class="line"> </span><br><span class="line">FileStream fs = <span class="keyword">new</span> FileStream(Server.MapPath(<span class="string">&quot;download/&quot;</span> + fn), FileMode.Create, FileAccess.ReadWrite);</span><br><span class="line">StreamWriter strmWriter = <span class="keyword">new</span> StreamWriter(fs);    <span class="comment">//存入到文本文件中 </span></span><br><span class="line"> <span class="comment">//把标题写入.txt文件中 //for (int i = 0; i &lt;dt.Columns.Count;i++)//&#123;//    strmWriter.Write(dt.Columns[i].ColumnName + &quot; &quot;);//&#125;</span></span><br><span class="line"> <span class="keyword">foreach</span> (DataRow dr <span class="keyword">in</span> dt.Rows)&#123;    <span class="built_in">string</span> str0, str1, str2, str3;    <span class="built_in">string</span> str = <span class="string">&quot;|&quot;</span>; <span class="comment">//数据用&quot;|&quot;分隔开</span></span><br><span class="line">    str0 = dr[<span class="number">0</span>].ToString();</span><br><span class="line">    str1 = dr[<span class="number">1</span>].ToString();</span><br><span class="line">    str2 = dr[<span class="number">2</span>].ToString();</span><br><span class="line">    str3 = dr[<span class="number">3</span>].ToString();</span><br><span class="line">    str4 = dr[<span class="number">4</span>].ToString().Trim();</span><br><span class="line">    strmWriter.Write(str0);</span><br><span class="line">    strmWriter.Write(str);</span><br><span class="line">    strmWriter.Write(str1);</span><br><span class="line">    strmWriter.Write(str);</span><br><span class="line">    strmWriter.Write(str2);</span><br><span class="line">    strmWriter.Write(str);</span><br><span class="line">    strmWriter.Write(str3);</span><br><span class="line">    strmWriter.WriteLine(); <span class="comment">//换行&#125;</span></span><br><span class="line">strmWriter.Flush(); </span><br><span class="line">strmWriter.Close();<span class="keyword">if</span> (con.State == ConnectionState.Open)&#123;</span><br><span class="line">    con.Close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以上就是C#读取Excel文件的三种方法，希望对大家有所帮助。</p>]]></content>
    
    
    <summary type="html">这篇文章总结了C#读取Excel文件的几种方法 ，包括使用OleDB将Excel文件作为数据源进行读取和写入操作，通过连接字符串和OleDbDataAdapter实现数据交互，还可以动态获取Excel中的表名，同时提供了写入Excel文件的实例代码；第二种方法是引用Microsoft.Office.Interop.Excel.dll组件，通过Excel应用程序接口以只读方式打开Excel文件，获取工作簿和工作表，读取指定区域的数据并存储到数组中，最后释放资源并关闭Excel进程；第三种方法是将Excel文件转换为CSV格式，使用文件流和流读取器逐行读取数据，通过分割符解析内容，同时也提到将数据库数据导出为txt文件的方法。</summary>
    
    
    
    <category term="后端开发" scheme="https://www.codeobservatory.cn/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="C#" scheme="https://www.codeobservatory.cn/tags/C/"/>
    
    <category term="Excel读取" scheme="https://www.codeobservatory.cn/tags/Excel%E8%AF%BB%E5%8F%96/"/>
    
    <category term="OleDB" scheme="https://www.codeobservatory.cn/tags/OleDB/"/>
    
  </entry>
  
</feed>
